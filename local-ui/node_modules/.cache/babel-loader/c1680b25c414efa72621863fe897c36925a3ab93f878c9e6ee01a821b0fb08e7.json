{"ast":null,"code":"import React,{useEffect,useState,useRef}from\"react\";import{useSearchParams}from\"react-router-dom\";import API from\"../api\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const styles=\"\\n* { box-sizing: border-box; margin: 0; padding: 0; }\\nbody { background: #cfd2d6; }\\n\\n.playback-page {\\n  height: 100vh;\\n  display: flex;\\n  flex-direction: column;\\n  background: #cfd2d6;\\n  font-family: Arial, sans-serif;\\n}\\n\\n.playback-header {\\n  height: 40px;\\n  background: #d9d9d9;\\n  display: flex;\\n  align-items: center;\\n  padding: 0 10px;\\n  gap: 8px;\\n  border-bottom: 1px solid #999;\\n}\\n\\n.video-viewport {\\n  height: calc(100vh - 140px);\\n  background: #000;\\n  overflow: hidden;\\n  position: relative;\\n}\\n\\nvideo, iframe {\\n  width: 100%;\\n  height: 100%;\\n  object-fit: contain;\\n}\\n\\n.info-overlay {\\n  position: absolute;\\n  top: 10px;\\n  left: 10px;\\n  background: rgba(0,0,0,0.8);\\n  color: #0f0;\\n  padding: 8px 12px;\\n  border-radius: 4px;\\n  font-size: 12px;\\n}\\n\\n.controls {\\n  height: 60px;\\n  background: #d9d9d9;\\n  display: flex;\\n  align-items: center;\\n  gap: 6px;\\n  padding: 0 8px;\\n  border-bottom: 1px solid #999;\\n}\\n\\n.timeline-area {\\n  height: 80px;\\n  background: #e6e6e6;\\n  border-top: 1px solid #999;\\n  position: relative;\\n}\\n\\n.segments-track {\\n  position: absolute;\\n  top: 34px;\\n  height: 12px;\\n  left: 0;\\n  right: 0;\\n}\\n\\n.segment {\\n  position: absolute;\\n  height: 100%;\\n  background: #2ecc71;\\n}\\n\\nbutton {\\n  padding: 4px 10px;\\n  border: 1px solid #555;\\n  background: #f0f0f0;\\n  cursor: pointer;\\n  font-size: 13px;\\n}\\n\\nbutton:hover { background: #fff; }\\nbutton:active { background: #ddd; }\\n\\n.time-display {\\n  margin-left: auto;\\n  font-weight: bold;\\n  font-size: 14px;\\n}\\n\";export default function Playback(){const[params]=useSearchParams();const camId=params.get(\"camId\");const[segments,setSegments]=useState([]);const[showLive,setShowLive]=useState(true);useEffect(()=>{if(!camId)return;const now=Date.now();const from=now-24*60*60*1000;API.get(\"/playback/timeline/\".concat(camId,\"?from=\").concat(from,\"&to=\").concat(now)).then(res=>{const segs=res.data.segments||[];// Filter valid timestamps only\nconst valid=segs.filter(s=>s.start_ts>0&&s.start_ts<now*2);setSegments(valid);}).catch(e=>console.error(\"Timeline error:\",e));},[camId]);return/*#__PURE__*/_jsxs(\"div\",{className:\"playback-page\",children:[/*#__PURE__*/_jsx(\"style\",{children:styles}),/*#__PURE__*/_jsxs(\"div\",{className:\"playback-header\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.location.href='/',children:\"\\u2190 \\xCEnapoi\"}),/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:600},children:camId}),/*#__PURE__*/_jsxs(\"span\",{style:{fontSize:11,color:'#555'},children:[\"Segmente: \",segments.length]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"video-viewport\",children:[showLive&&/*#__PURE__*/_jsx(\"iframe\",{src:\"http://192.168.120.208:1984/webrtc/embed.html?src=\".concat(camId),allow:\"camera;microphone;fullscreen\",title:\"Camera Live\"}),/*#__PURE__*/_jsx(\"div\",{className:\"info-overlay\",children:\"LIVE STREAM (Playback \\xEEn dezvoltare)\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"controls\",children:[/*#__PURE__*/_jsx(\"button\",{children:\"\\u25B6\"}),/*#__PURE__*/_jsx(\"button\",{children:\"\\u23F8\"}),/*#__PURE__*/_jsx(\"button\",{children:\"\\u25A0\"}),/*#__PURE__*/_jsx(\"button\",{children:\"0.5\\xD7\"}),/*#__PURE__*/_jsx(\"button\",{children:\"1\\xD7\"}),/*#__PURE__*/_jsx(\"button\",{children:\"2\\xD7\"}),/*#__PURE__*/_jsx(\"button\",{children:\"4\\xD7\"}),/*#__PURE__*/_jsx(\"div\",{className:\"time-display\",children:\"00:00:00\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"timeline-area\",children:/*#__PURE__*/_jsx(\"div\",{className:\"segments-track\",children:segments.map((seg,i)=>/*#__PURE__*/_jsx(\"div\",{className:\"segment\",style:{left:\"\".concat(seg.s*100,\"%\"),width:\"\".concat(Math.max((seg.e-seg.s)*100,0.5),\"%\")}},i))})})]});}","map":{"version":3,"names":["React","useEffect","useState","useRef","useSearchParams","API","jsx","_jsx","jsxs","_jsxs","styles","Playback","params","camId","get","segments","setSegments","showLive","setShowLive","now","Date","from","concat","then","res","segs","data","valid","filter","s","start_ts","catch","e","console","error","className","children","onClick","window","location","href","style","fontWeight","fontSize","color","length","src","allow","title","map","seg","i","left","width","Math","max"],"sources":["I:/dispecerat/github_release/dss-edge/local-ui/src/pages/Playback.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\r\nimport { useSearchParams } from \"react-router-dom\";\r\nimport API from \"../api\";\r\n\r\nconst styles = `\r\n* { box-sizing: border-box; margin: 0; padding: 0; }\r\nbody { background: #cfd2d6; }\r\n\r\n.playback-page {\r\n  height: 100vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  background: #cfd2d6;\r\n  font-family: Arial, sans-serif;\r\n}\r\n\r\n.playback-header {\r\n  height: 40px;\r\n  background: #d9d9d9;\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 0 10px;\r\n  gap: 8px;\r\n  border-bottom: 1px solid #999;\r\n}\r\n\r\n.video-viewport {\r\n  height: calc(100vh - 140px);\r\n  background: #000;\r\n  overflow: hidden;\r\n  position: relative;\r\n}\r\n\r\nvideo, iframe {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: contain;\r\n}\r\n\r\n.info-overlay {\r\n  position: absolute;\r\n  top: 10px;\r\n  left: 10px;\r\n  background: rgba(0,0,0,0.8);\r\n  color: #0f0;\r\n  padding: 8px 12px;\r\n  border-radius: 4px;\r\n  font-size: 12px;\r\n}\r\n\r\n.controls {\r\n  height: 60px;\r\n  background: #d9d9d9;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 6px;\r\n  padding: 0 8px;\r\n  border-bottom: 1px solid #999;\r\n}\r\n\r\n.timeline-area {\r\n  height: 80px;\r\n  background: #e6e6e6;\r\n  border-top: 1px solid #999;\r\n  position: relative;\r\n}\r\n\r\n.segments-track {\r\n  position: absolute;\r\n  top: 34px;\r\n  height: 12px;\r\n  left: 0;\r\n  right: 0;\r\n}\r\n\r\n.segment {\r\n  position: absolute;\r\n  height: 100%;\r\n  background: #2ecc71;\r\n}\r\n\r\nbutton {\r\n  padding: 4px 10px;\r\n  border: 1px solid #555;\r\n  background: #f0f0f0;\r\n  cursor: pointer;\r\n  font-size: 13px;\r\n}\r\n\r\nbutton:hover { background: #fff; }\r\nbutton:active { background: #ddd; }\r\n\r\n.time-display {\r\n  margin-left: auto;\r\n  font-weight: bold;\r\n  font-size: 14px;\r\n}\r\n`;\r\n\r\nexport default function Playback() {\r\n    const [params] = useSearchParams();\r\n    const camId = params.get(\"camId\");\r\n\r\n    const [segments, setSegments] = useState([]);\r\n    const [showLive, setShowLive] = useState(true);\r\n\r\n    useEffect(() => {\r\n        if (!camId) return;\r\n\r\n        const now = Date.now();\r\n        const from = now - 24 * 60 * 60 * 1000;\r\n\r\n        API.get(`/playback/timeline/${camId}?from=${from}&to=${now}`)\r\n            .then(res => {\r\n                const segs = res.data.segments || [];\r\n                // Filter valid timestamps only\r\n                const valid = segs.filter(s => s.start_ts > 0 && s.start_ts < now * 2);\r\n                setSegments(valid);\r\n            })\r\n            .catch(e => console.error(\"Timeline error:\", e));\r\n    }, [camId]);\r\n\r\n    return (\r\n        <div className=\"playback-page\">\r\n            <style>{styles}</style>\r\n\r\n            <div className=\"playback-header\">\r\n                <button onClick={() => window.location.href = '/'}>← Înapoi</button>\r\n                <span style={{ fontWeight: 600 }}>{camId}</span>\r\n                <span style={{ fontSize: 11, color: '#555' }}>Segmente: {segments.length}</span>\r\n            </div>\r\n\r\n            <div className=\"video-viewport\">\r\n                {showLive && (\r\n                    <iframe\r\n                        src={`http://192.168.120.208:1984/webrtc/embed.html?src=${camId}`}\r\n                        allow=\"camera;microphone;fullscreen\"\r\n                        title=\"Camera Live\"\r\n                    />\r\n                )}\r\n                <div className=\"info-overlay\">\r\n                    LIVE STREAM (Playback în dezvoltare)\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"controls\">\r\n                <button>▶</button>\r\n                <button>⏸</button>\r\n                <button>■</button>\r\n                <button>0.5×</button>\r\n                <button>1×</button>\r\n                <button>2×</button>\r\n                <button>4×</button>\r\n                <div className=\"time-display\">00:00:00</div>\r\n            </div>\r\n\r\n            <div className=\"timeline-area\">\r\n                <div className=\"segments-track\">\r\n                    {segments.map((seg, i) => (\r\n                        <div\r\n                            key={i}\r\n                            className=\"segment\"\r\n                            style={{\r\n                                left: `${seg.s * 100}%`,\r\n                                width: `${Math.max((seg.e - seg.s) * 100, 0.5)}%`\r\n                            }}\r\n                        />\r\n                    ))}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}