{"ast":null,"code":"var _jsxFileName = \"I:\\\\dispecerat\\\\github_release\\\\dss-edge\\\\local-ui\\\\src\\\\components\\\\RecorderPlayer.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function RecorderPlayer({\n  camId,\n  hlsUrl: propHlsUrl,\n  style\n}) {\n  _s();\n  const videoRef = useRef(null);\n  const hlsRef = useRef(null);\n  useEffect(() => {\n    const video = videoRef.current;\n    if (!video) return;\n    const hlsUrl = propHlsUrl || `/api/playback/live/${camId}.m3u8`;\n    const initHls = () => {\n      if (window.Hls && window.Hls.isSupported()) {\n        if (hlsRef.current) hlsRef.current.destroy();\n        const hls = new window.Hls({\n          debug: false,\n          enableWorker: true,\n          manifestLoadingTimeOut: 10000\n        });\n        hls.loadSource(hlsUrl);\n        hls.attachMedia(video);\n        hls.on(window.Hls.Events.MANIFEST_PARSED, () => {\n          console.log('[RecorderPlayer] Manifest parsed');\n          video.play().catch(e => console.warn(\"Autoplay blocked\", e));\n        });\n        hls.on(window.Hls.Events.MANIFEST_LOADED, (event, data) => {\n          console.log('[RecorderPlayer] Manifest loaded, live:', data.details.live);\n        });\n        hls.on(window.Hls.Events.ERROR, (event, data) => {\n          if (data.fatal) {\n            console.error('[RecorderPlayer] Fatal error:', data.type, data.details);\n            switch (data.type) {\n              case window.Hls.ErrorTypes.NETWORK_ERROR:\n                console.log('[RecorderPlayer] Recovering from network error...');\n                setTimeout(() => hls.startLoad(), 1000);\n                break;\n              case window.Hls.ErrorTypes.MEDIA_ERROR:\n                console.log('[RecorderPlayer] Recovering from media error...');\n                hls.recoverMediaError();\n                break;\n              default:\n                console.error('[RecorderPlayer] Unrecoverable error');\n                hls.destroy();\n                break;\n            }\n          }\n        });\n        hlsRef.current = hls;\n      } else if (video.canPlayType('application/vnd.apple.mpegurl')) {\n        video.src = hlsUrl;\n        video.addEventListener('loadedmetadata', () => video.play());\n      }\n    };\n    if (!window.Hls && typeof Hls === 'undefined') {\n      const script = document.createElement('script');\n      script.src = \"https://cdn.jsdelivr.net/npm/hls.js@1.4.0/dist/hls.min.js\";\n      script.onload = initHls;\n      document.head.appendChild(script);\n    } else {\n      initHls();\n    }\n    return () => {\n      if (hlsRef.current) hlsRef.current.destroy();\n    };\n  }, [camId]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      ...style,\n      position: 'relative',\n      background: '#000',\n      overflow: 'hidden'\n    },\n    children: /*#__PURE__*/_jsxDEV(\"video\", {\n      ref: videoRef,\n      style: {\n        width: '100%',\n        height: '100%',\n        objectFit: 'contain',\n        display: 'block'\n      },\n      autoPlay: true,\n      muted: true,\n      playsInline: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 77,\n    columnNumber: 9\n  }, this);\n}\n_s(RecorderPlayer, \"DM0gxtooMqf1QtpZzwgsXxPt5sU=\");\n_c = RecorderPlayer;\nvar _c;\n$RefreshReg$(_c, \"RecorderPlayer\");","map":{"version":3,"names":["React","useEffect","useRef","jsxDEV","_jsxDEV","RecorderPlayer","camId","hlsUrl","propHlsUrl","style","_s","videoRef","hlsRef","video","current","initHls","window","Hls","isSupported","destroy","hls","debug","enableWorker","manifestLoadingTimeOut","loadSource","attachMedia","on","Events","MANIFEST_PARSED","console","log","play","catch","e","warn","MANIFEST_LOADED","event","data","details","live","ERROR","fatal","error","type","ErrorTypes","NETWORK_ERROR","setTimeout","startLoad","MEDIA_ERROR","recoverMediaError","canPlayType","src","addEventListener","script","document","createElement","onload","head","appendChild","position","background","overflow","children","ref","width","height","objectFit","display","autoPlay","muted","playsInline","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["I:/dispecerat/github_release/dss-edge/local-ui/src/components/RecorderPlayer.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\r\n\r\nexport default function RecorderPlayer({ camId, hlsUrl: propHlsUrl, style }) {\r\n    const videoRef = useRef(null);\r\n    const hlsRef = useRef(null);\r\n\r\n    useEffect(() => {\r\n        const video = videoRef.current;\r\n        if (!video) return;\r\n\r\n        const hlsUrl = propHlsUrl || `/api/playback/live/${camId}.m3u8`;\r\n\r\n        const initHls = () => {\r\n            if (window.Hls && window.Hls.isSupported()) {\r\n                if (hlsRef.current) hlsRef.current.destroy();\r\n\r\n                const hls = new window.Hls({\r\n                    debug: false,\r\n                    enableWorker: true,\r\n                    manifestLoadingTimeOut: 10000,\r\n                });\r\n\r\n                hls.loadSource(hlsUrl);\r\n                hls.attachMedia(video);\r\n\r\n                hls.on(window.Hls.Events.MANIFEST_PARSED, () => {\r\n                    console.log('[RecorderPlayer] Manifest parsed');\r\n                    video.play().catch(e => console.warn(\"Autoplay blocked\", e));\r\n                });\r\n\r\n                hls.on(window.Hls.Events.MANIFEST_LOADED, (event, data) => {\r\n                    console.log('[RecorderPlayer] Manifest loaded, live:', data.details.live);\r\n                });\r\n\r\n                hls.on(window.Hls.Events.ERROR, (event, data) => {\r\n                    if (data.fatal) {\r\n                        console.error('[RecorderPlayer] Fatal error:', data.type, data.details);\r\n                        switch (data.type) {\r\n                            case window.Hls.ErrorTypes.NETWORK_ERROR:\r\n                                console.log('[RecorderPlayer] Recovering from network error...');\r\n                                setTimeout(() => hls.startLoad(), 1000);\r\n                                break;\r\n                            case window.Hls.ErrorTypes.MEDIA_ERROR:\r\n                                console.log('[RecorderPlayer] Recovering from media error...');\r\n                                hls.recoverMediaError();\r\n                                break;\r\n                            default:\r\n                                console.error('[RecorderPlayer] Unrecoverable error');\r\n                                hls.destroy();\r\n                                break;\r\n                        }\r\n                    }\r\n                });\r\n\r\n                hlsRef.current = hls;\r\n            } else if (video.canPlayType('application/vnd.apple.mpegurl')) {\r\n                video.src = hlsUrl;\r\n                video.addEventListener('loadedmetadata', () => video.play());\r\n            }\r\n        };\r\n\r\n        if (!window.Hls && typeof Hls === 'undefined') {\r\n            const script = document.createElement('script');\r\n            script.src = \"https://cdn.jsdelivr.net/npm/hls.js@1.4.0/dist/hls.min.js\";\r\n            script.onload = initHls;\r\n            document.head.appendChild(script);\r\n        } else {\r\n            initHls();\r\n        }\r\n\r\n        return () => {\r\n            if (hlsRef.current) hlsRef.current.destroy();\r\n        };\r\n    }, [camId]);\r\n\r\n    return (\r\n        <div style={{ ...style, position: 'relative', background: '#000', overflow: 'hidden' }}>\r\n            <video\r\n                ref={videoRef}\r\n                style={{\r\n                    width: '100%',\r\n                    height: '100%',\r\n                    objectFit: 'contain',\r\n                    display: 'block'\r\n                }}\r\n                autoPlay\r\n                muted\r\n                playsInline\r\n            />\r\n        </div>\r\n    );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}