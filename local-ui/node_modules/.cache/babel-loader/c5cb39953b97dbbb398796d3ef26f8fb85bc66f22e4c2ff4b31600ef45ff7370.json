{"ast":null,"code":"var _jsxFileName = \"I:\\\\dispecerat\\\\github_release\\\\dss-edge\\\\local-ui\\\\src\\\\pages\\\\PlaybackModern.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef, useMemo } from \"react\";\nimport { useSearchParams, useNavigate } from \"react-router-dom\";\nimport API from \"../api\";\nimport PlaybackCoreV2 from \"../services/PlaybackCoreV2\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function PlaybackModern() {\n  _s();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n  const camId = searchParams.get(\"camId\");\n\n  // --- STATE ---\n  const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0]);\n  const [segments, setSegments] = useState([]);\n\n  // 1. Where are we in the video? (The Red Line)\n  const [currentTimeMs, setCurrentTimeMs] = useState(Date.now());\n\n  // 2. What part of the day are we looking at? (The Left Edge of the Timeline)\n  const [viewStartMs, setViewStartMs] = useState(new Date().setHours(0, 0, 0, 0));\n\n  // 3. How zoomed in are we? (Pixels per Second)\n  const [zoomPxPerSec, setZoomPxPerSec] = useState(0.015); // Start zoomed out (approx full day)\n\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [containerWidth, setContainerWidth] = useState(1000);\n  const videoRef = useRef(null);\n  const coreRef = useRef(null);\n  const timelineContainerRef = useRef(null);\n  const dragRef = useRef({\n    isDragging: false,\n    startX: 0,\n    startViewTime: 0\n  });\n  const dayStartMs = new Date(selectedDate).setHours(0, 0, 0, 0);\n  const dayEndMs = dayStartMs + 86400000;\n\n  // --- 1. LOAD DATA ---\n  useEffect(() => {\n    if (!camId || !selectedDate) return;\n    const load = async () => {\n      setIsLoading(true);\n      try {\n        const res = await API.get(`/api/playback/timeline-day/${camId}/${selectedDate}`);\n        const data = res.data;\n        const segs = (data.segments || []).map(s => ({\n          ...s,\n          startTs: Number(s.start_ts),\n          endTs: Number(s.end_ts)\n        }));\n        setSegments(segs);\n\n        // Auto-fit to Day initially\n        if (containerWidth > 0) {\n          const ds = new Date(selectedDate).setHours(0, 0, 0, 0);\n          setViewStartMs(ds);\n          setZoomPxPerSec(containerWidth / 86400);\n        }\n      } catch (e) {\n        console.error(e);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    load();\n  }, [camId, selectedDate, containerWidth]);\n\n  // --- 2. PLAYER CORE ---\n  useEffect(() => {\n    if (videoRef.current && camId) {\n      coreRef.current = new PlaybackCoreV2(videoRef.current, camId);\n    }\n    return () => {\n      var _coreRef$current;\n      return (_coreRef$current = coreRef.current) === null || _coreRef$current === void 0 ? void 0 : _coreRef$current.destroy();\n    };\n  }, [camId]);\n  useEffect(() => {\n    if (coreRef.current && segments.length > 0) {\n      coreRef.current.setSegments(segments.map(s => ({\n        startTs: s.start_ts,\n        endTs: s.end_ts,\n        file: s.file\n      })));\n    }\n  }, [segments]);\n  useEffect(() => {\n    const interval = setInterval(() => {\n      if (isPlaying && coreRef.current) {\n        const epoch = coreRef.current.getCurrentEpochMs();\n        if (epoch && Math.abs(epoch - currentTimeMs) > 200) {\n          setCurrentTimeMs(epoch);\n        }\n      }\n    }, 50);\n    return () => clearInterval(interval);\n  }, [isPlaying, currentTimeMs]);\n  const performSeek = epoch => {\n    setCurrentTimeMs(epoch);\n    if (coreRef.current) {\n      coreRef.current.seekTo(epoch);\n      if (!isPlaying) {\n        videoRef.current.play().catch(() => {});\n        setIsPlaying(true);\n      }\n    }\n  };\n\n  // --- 3. INTERACTION ---\n\n  useEffect(() => {\n    const handleResize = () => {\n      if (timelineContainerRef.current) {\n        const w = timelineContainerRef.current.clientWidth;\n        setContainerWidth(w);\n        if (zoomPxPerSec < 0.1) setZoomPxPerSec(w / 86400);\n      }\n    };\n    window.addEventListener('resize', handleResize);\n    handleResize();\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n  const handleWheel = e => {\n    e.preventDefault();\n\n    // 1. Get Mouse Position rel to Timeline\n    const rect = timelineContainerRef.current.getBoundingClientRect();\n    const mouseX = e.clientX - rect.left;\n\n    // 2. Calculate Time at Mouse Cursor (Pre-Zoom)\n    const mouseTime = viewStartMs + mouseX / zoomPxPerSec * 1000;\n\n    // 3. Apply Zoom\n    const delta = e.deltaY > 0 ? 0.9 : 1.1; // Out : In\n    const newZoom = Math.max(containerWidth / 86400, Math.min(200, zoomPxPerSec * delta));\n    setZoomPxPerSec(newZoom);\n\n    // 4. Adjust ViewStart so MouseTime stays at MouseX\n    const newViewStart = mouseTime - mouseX / newZoom * 1000;\n    setViewStartMs(newViewStart);\n  };\n  const handleMouseDown = e => {\n    dragRef.current = {\n      isDragging: true,\n      startX: e.clientX,\n      startViewTime: viewStartMs\n    };\n    document.body.style.cursor = 'grabbing';\n  };\n  const handleMouseMove = e => {\n    if (!dragRef.current.isDragging) return;\n    const diffPx = dragRef.current.startX - e.clientX;\n    const dtMs = diffPx / zoomPxPerSec * 1000;\n    setViewStartMs(dragRef.current.startViewTime + dtMs);\n  };\n  const handleMouseUp = e => {\n    if (dragRef.current.isDragging) {\n      dragRef.current.isDragging = false;\n      document.body.style.cursor = 'default';\n      const dist = Math.abs(e.clientX - dragRef.current.startX);\n      if (dist < 5) {\n        const rect = timelineContainerRef.current.getBoundingClientRect();\n        const clickX = e.clientX - rect.left;\n        const clickTime = viewStartMs + clickX / zoomPxPerSec * 1000;\n        performSeek(clickTime);\n      }\n    }\n  };\n\n  // --- 4. RENDER V3 (TRASSIR STYLE) ---\n  // Colors\n  // BG: #222\n  // Track: #1a1a1a\n  // Grid: #444\n  // Segments: #2ea043\n  // Playhead: #ff3333\n\n  const timeToPx = ts => (ts - viewStartMs) / 1000 * zoomPxPerSec;\n  const renderGrid = () => {\n    const ticks = [];\n    const startMs = viewStartMs;\n    const endMs = viewStartMs + containerWidth / zoomPxPerSec * 1000;\n\n    // Determine Scale and Steps\n    // Strategy: We want ticks every ~100px\n    const targetTickPx = 100;\n    const secondsPer100Px = targetTickPx / zoomPxPerSec;\n\n    // Available steps (seconds)\n    const steps = [1, 5, 10, 30, 60, 300, 600, 1800, 3600, 7200, 14400];\n    let stepSec = 3600;\n\n    // Find best fit step (smallest step > target)\n    for (let s of steps) {\n      if (s >= secondsPer100Px) {\n        stepSec = s;\n        break;\n      }\n    }\n    const stepMs = stepSec * 1000;\n    const firstTick = Math.floor(startMs / stepMs) * stepMs;\n    for (let t = firstTick; t < endMs; t += stepMs) {\n      const x = timeToPx(t);\n      const d = new Date(t);\n\n      // Format Label based on granularity\n      let label = \"\";\n      let isMajor = false;\n      if (stepSec >= 3600) {\n        // Hour View (00:00)\n        label = d.toLocaleTimeString([], {\n          hour: '2-digit',\n          minute: '2-digit'\n        });\n        isMajor = true;\n      } else if (stepSec >= 60) {\n        // Minute View (00:30)\n        label = d.toLocaleTimeString([], {\n          hour: '2-digit',\n          minute: '2-digit'\n        });\n        if (d.getMinutes() === 0) isMajor = true;\n      } else {\n        // Second View (00:00:15)\n        label = d.toLocaleTimeString([], {\n          hour: '2-digit',\n          minute: '2-digit',\n          second: '2-digit'\n        });\n        if (d.getSeconds() === 0) isMajor = true;\n      }\n\n      // Render Tick Line\n      ticks.push(/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'absolute',\n          left: x,\n          top: 0,\n          bottom: 0,\n          borderLeft: isMajor ? '1px solid #666' : '1px solid #333',\n          pointerEvents: 'none'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: 'absolute',\n            bottom: 2,\n            left: 4,\n            fontSize: 10,\n            fontFamily: 'monospace',\n            color: isMajor ? '#fff' : '#888'\n          },\n          children: label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 21\n        }, this)\n      }, `tick-${t}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 17\n      }, this));\n    }\n    return ticks;\n  };\n  const renderSegments = () => {\n    const endVis = viewStartMs + containerWidth / zoomPxPerSec * 1000;\n    return segments.map((s, i) => {\n      if (s.endTs < viewStartMs || s.startTs > endVis) return null;\n      const x1 = timeToPx(s.startTs);\n      const durationSec = (s.endTs - s.startTs) / 1000;\n      const w = Math.max(1, durationSec * zoomPxPerSec);\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'absolute',\n          left: x1,\n          top: 10,\n          // Slightly padded from top\n          bottom: 20,\n          // Leave room for time text\n          width: w,\n          background: 'linear-gradient(180deg, #2ecc71 0%, #27ae60 100%)',\n          // Gradient Green\n          opacity: 0.9,\n          border: '1px solid #1e8449',\n          borderRadius: 1,\n          pointerEvents: 'none'\n        }\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 17\n      }, this);\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: \"flex\",\n      flexDirection: \"column\",\n      height: \"100vh\",\n      background: \"var(--bg-dark)\",\n      color: \"var(--text-primary)\",\n      userSelect: \"none\",\n      fontFamily: '\"Segoe UI\", Roboto, \"Helvetica Neue\", sans-serif'\n    },\n    onMouseUp: handleMouseUp,\n    onMouseLeave: handleMouseUp,\n    onMouseMove: handleMouseMove,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        height: 48,\n        background: \"#1f1f1f\",\n        borderBottom: \"1px solid #333\",\n        display: \"flex\",\n        alignItems: \"center\",\n        padding: \"0 16px\",\n        gap: 16,\n        boxShadow: \"0 2px 4px rgba(0,0,0,0.2)\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate(\"/\"),\n        style: {\n          background: \"#333\",\n          border: \"1px solid #444\",\n          borderRadius: 4,\n          color: \"#fff\",\n          height: 32,\n          padding: \"0 12px\",\n          cursor: \"pointer\",\n          fontWeight: 600\n        },\n        children: \"\\u2190 LIVE\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontWeight: 600,\n          fontSize: 14,\n          color: '#fff'\n        },\n        children: \"PLAYBACK ARCHIVE\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 312,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flex: 1\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: 10,\n            color: '#888'\n          },\n          children: \"CURRENT TIME\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: 14,\n            fontWeight: 'bold',\n            color: '#2ecc71',\n            fontFamily: 'monospace'\n          },\n          children: new Date(currentTimeMs).toLocaleTimeString()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 318,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"date\",\n        value: selectedDate,\n        onChange: e => setSelectedDate(e.target.value),\n        style: {\n          background: '#111',\n          color: '#fff',\n          border: '1px solid #444',\n          padding: '4px 8px',\n          borderRadius: 4,\n          fontFamily: 'inherit'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: 1,\n        background: \"#000\",\n        position: 'relative'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"video\", {\n        ref: videoRef,\n        style: {\n          width: '100%',\n          height: '100%'\n        },\n        onClick: () => {\n          if (isPlaying) {\n            videoRef.current.pause();\n            setIsPlaying(false);\n          } else {\n            videoRef.current.play();\n            setIsPlaying(true);\n          }\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 336,\n        columnNumber: 17\n      }, this), !isPlaying && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'absolute',\n          top: '50%',\n          left: '50%',\n          transform: 'translate(-50%, -50%)',\n          background: 'rgba(0,0,0,0.5)',\n          borderRadius: '50%',\n          width: 64,\n          height: 64,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          pointerEvents: 'none'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: 0,\n            height: 0,\n            borderTop: '15px solid transparent',\n            borderBottom: '15px solid transparent',\n            borderLeft: '25px solid white',\n            marginLeft: 4\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 335,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: timelineContainerRef,\n      style: {\n        height: 90,\n        background: \"#1a1a1a\",\n        borderTop: \"1px solid #333\",\n        position: \"relative\",\n        overflow: \"hidden\",\n        cursor: dragRef.current.isDragging ? \"grabbing\" : \"default\"\n      },\n      onWheel: handleWheel,\n      onMouseDown: handleMouseDown,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'absolute',\n          top: 10,\n          bottom: 20,\n          left: 0,\n          right: 0,\n          background: '#111',\n          borderTop: '1px solid #333',\n          borderBottom: '1px solid #333'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 374,\n        columnNumber: 17\n      }, this), renderGrid(), renderSegments(), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: \"absolute\",\n          left: timeToPx(currentTimeMs),\n          top: 0,\n          bottom: 0,\n          width: 2,\n          background: \"#ff3333\",\n          // Bright Red/Orange\n          boxShadow: \"0 0 4px rgba(255, 51, 51, 0.4)\",\n          transform: \"translateX(-1px)\",\n          zIndex: 20,\n          pointerEvents: \"none\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: 'absolute',\n            top: 0,\n            left: -6,\n            width: 0,\n            height: 0,\n            borderLeft: '7px solid transparent',\n            borderRight: '7px solid transparent',\n            borderTop: '8px solid #ff3333'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 394,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 381,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 360,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 282,\n    columnNumber: 9\n  }, this);\n}\n_s(PlaybackModern, \"viLpEQmWwuXBtJtdOUDXv1tR0q8=\", false, function () {\n  return [useSearchParams, useNavigate];\n});\n_c = PlaybackModern;\nvar _c;\n$RefreshReg$(_c, \"PlaybackModern\");","map":{"version":3,"names":["React","useEffect","useState","useRef","useMemo","useSearchParams","useNavigate","API","PlaybackCoreV2","jsxDEV","_jsxDEV","PlaybackModern","_s","searchParams","navigate","camId","get","selectedDate","setSelectedDate","Date","toISOString","split","segments","setSegments","currentTimeMs","setCurrentTimeMs","now","viewStartMs","setViewStartMs","setHours","zoomPxPerSec","setZoomPxPerSec","isPlaying","setIsPlaying","isLoading","setIsLoading","containerWidth","setContainerWidth","videoRef","coreRef","timelineContainerRef","dragRef","isDragging","startX","startViewTime","dayStartMs","dayEndMs","load","res","data","segs","map","s","startTs","Number","start_ts","endTs","end_ts","ds","e","console","error","current","_coreRef$current","destroy","length","file","interval","setInterval","epoch","getCurrentEpochMs","Math","abs","clearInterval","performSeek","seekTo","play","catch","handleResize","w","clientWidth","window","addEventListener","removeEventListener","handleWheel","preventDefault","rect","getBoundingClientRect","mouseX","clientX","left","mouseTime","delta","deltaY","newZoom","max","min","newViewStart","handleMouseDown","document","body","style","cursor","handleMouseMove","diffPx","dtMs","handleMouseUp","dist","clickX","clickTime","timeToPx","ts","renderGrid","ticks","startMs","endMs","targetTickPx","secondsPer100Px","steps","stepSec","stepMs","firstTick","floor","t","x","d","label","isMajor","toLocaleTimeString","hour","minute","getMinutes","second","getSeconds","push","position","top","bottom","borderLeft","pointerEvents","children","fontSize","fontFamily","color","fileName","_jsxFileName","lineNumber","columnNumber","renderSegments","endVis","i","x1","durationSec","width","background","opacity","border","borderRadius","display","flexDirection","height","userSelect","onMouseUp","onMouseLeave","onMouseMove","borderBottom","alignItems","padding","gap","boxShadow","onClick","fontWeight","flex","type","value","onChange","target","ref","pause","transform","justifyContent","borderTop","marginLeft","overflow","onWheel","onMouseDown","right","zIndex","borderRight","_c","$RefreshReg$"],"sources":["I:/dispecerat/github_release/dss-edge/local-ui/src/pages/PlaybackModern.js"],"sourcesContent":["import React, { useEffect, useState, useRef, useMemo } from \"react\";\r\nimport { useSearchParams, useNavigate } from \"react-router-dom\";\r\nimport API from \"../api\";\r\nimport PlaybackCoreV2 from \"../services/PlaybackCoreV2\";\r\n\r\nexport default function PlaybackModern() {\r\n    const [searchParams] = useSearchParams();\r\n    const navigate = useNavigate();\r\n    const camId = searchParams.get(\"camId\");\r\n\r\n    // --- STATE ---\r\n    const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0]);\r\n    const [segments, setSegments] = useState([]);\r\n\r\n    // 1. Where are we in the video? (The Red Line)\r\n    const [currentTimeMs, setCurrentTimeMs] = useState(Date.now());\r\n\r\n    // 2. What part of the day are we looking at? (The Left Edge of the Timeline)\r\n    const [viewStartMs, setViewStartMs] = useState(new Date().setHours(0, 0, 0, 0));\r\n\r\n    // 3. How zoomed in are we? (Pixels per Second)\r\n    const [zoomPxPerSec, setZoomPxPerSec] = useState(0.015); // Start zoomed out (approx full day)\r\n\r\n    const [isPlaying, setIsPlaying] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [containerWidth, setContainerWidth] = useState(1000);\r\n\r\n    const videoRef = useRef(null);\r\n    const coreRef = useRef(null);\r\n    const timelineContainerRef = useRef(null);\r\n    const dragRef = useRef({ isDragging: false, startX: 0, startViewTime: 0 });\r\n\r\n    const dayStartMs = new Date(selectedDate).setHours(0, 0, 0, 0);\r\n    const dayEndMs = dayStartMs + 86400000;\r\n\r\n    // --- 1. LOAD DATA ---\r\n    useEffect(() => {\r\n        if (!camId || !selectedDate) return;\r\n\r\n        const load = async () => {\r\n            setIsLoading(true);\r\n            try {\r\n                const res = await API.get(`/api/playback/timeline-day/${camId}/${selectedDate}`);\r\n                const data = res.data;\r\n                const segs = (data.segments || []).map(s => ({\r\n                    ...s,\r\n                    startTs: Number(s.start_ts),\r\n                    endTs: Number(s.end_ts)\r\n                }));\r\n                setSegments(segs);\r\n\r\n                // Auto-fit to Day initially\r\n                if (containerWidth > 0) {\r\n                    const ds = new Date(selectedDate).setHours(0, 0, 0, 0);\r\n                    setViewStartMs(ds);\r\n                    setZoomPxPerSec(containerWidth / 86400);\r\n                }\r\n\r\n            } catch (e) {\r\n                console.error(e);\r\n            } finally {\r\n                setIsLoading(false);\r\n            }\r\n        };\r\n        load();\r\n    }, [camId, selectedDate, containerWidth]);\r\n\r\n    // --- 2. PLAYER CORE ---\r\n    useEffect(() => {\r\n        if (videoRef.current && camId) {\r\n            coreRef.current = new PlaybackCoreV2(videoRef.current, camId);\r\n        }\r\n        return () => coreRef.current?.destroy();\r\n    }, [camId]);\r\n\r\n    useEffect(() => {\r\n        if (coreRef.current && segments.length > 0) {\r\n            coreRef.current.setSegments(segments.map(s => ({\r\n                startTs: s.start_ts,\r\n                endTs: s.end_ts,\r\n                file: s.file\r\n            })));\r\n        }\r\n    }, [segments]);\r\n\r\n    useEffect(() => {\r\n        const interval = setInterval(() => {\r\n            if (isPlaying && coreRef.current) {\r\n                const epoch = coreRef.current.getCurrentEpochMs();\r\n                if (epoch && Math.abs(epoch - currentTimeMs) > 200) {\r\n                    setCurrentTimeMs(epoch);\r\n                }\r\n            }\r\n        }, 50);\r\n        return () => clearInterval(interval);\r\n    }, [isPlaying, currentTimeMs]);\r\n\r\n    const performSeek = (epoch) => {\r\n        setCurrentTimeMs(epoch);\r\n        if (coreRef.current) {\r\n            coreRef.current.seekTo(epoch);\r\n            if (!isPlaying) {\r\n                videoRef.current.play().catch(() => { });\r\n                setIsPlaying(true);\r\n            }\r\n        }\r\n    };\r\n\r\n    // --- 3. INTERACTION ---\r\n\r\n    useEffect(() => {\r\n        const handleResize = () => {\r\n            if (timelineContainerRef.current) {\r\n                const w = timelineContainerRef.current.clientWidth;\r\n                setContainerWidth(w);\r\n                if (zoomPxPerSec < 0.1) setZoomPxPerSec(w / 86400);\r\n            }\r\n        };\r\n        window.addEventListener('resize', handleResize);\r\n        handleResize();\r\n        return () => window.removeEventListener('resize', handleResize);\r\n    }, []);\r\n\r\n    const handleWheel = (e) => {\r\n        e.preventDefault();\r\n\r\n        // 1. Get Mouse Position rel to Timeline\r\n        const rect = timelineContainerRef.current.getBoundingClientRect();\r\n        const mouseX = e.clientX - rect.left;\r\n\r\n        // 2. Calculate Time at Mouse Cursor (Pre-Zoom)\r\n        const mouseTime = viewStartMs + ((mouseX / zoomPxPerSec) * 1000);\r\n\r\n        // 3. Apply Zoom\r\n        const delta = e.deltaY > 0 ? 0.9 : 1.1; // Out : In\r\n        const newZoom = Math.max(containerWidth / 86400, Math.min(200, zoomPxPerSec * delta));\r\n        setZoomPxPerSec(newZoom);\r\n\r\n        // 4. Adjust ViewStart so MouseTime stays at MouseX\r\n        const newViewStart = mouseTime - ((mouseX / newZoom) * 1000);\r\n        setViewStartMs(newViewStart);\r\n    };\r\n\r\n    const handleMouseDown = (e) => {\r\n        dragRef.current = { isDragging: true, startX: e.clientX, startViewTime: viewStartMs };\r\n        document.body.style.cursor = 'grabbing';\r\n    };\r\n\r\n    const handleMouseMove = (e) => {\r\n        if (!dragRef.current.isDragging) return;\r\n        const diffPx = dragRef.current.startX - e.clientX;\r\n        const dtMs = (diffPx / zoomPxPerSec) * 1000;\r\n        setViewStartMs(dragRef.current.startViewTime + dtMs);\r\n    };\r\n\r\n    const handleMouseUp = (e) => {\r\n        if (dragRef.current.isDragging) {\r\n            dragRef.current.isDragging = false;\r\n            document.body.style.cursor = 'default';\r\n\r\n            const dist = Math.abs(e.clientX - dragRef.current.startX);\r\n            if (dist < 5) {\r\n                const rect = timelineContainerRef.current.getBoundingClientRect();\r\n                const clickX = e.clientX - rect.left;\r\n                const clickTime = viewStartMs + ((clickX / zoomPxPerSec) * 1000);\r\n                performSeek(clickTime);\r\n            }\r\n        }\r\n    };\r\n\r\n    // --- 4. RENDER V3 (TRASSIR STYLE) ---\r\n    // Colors\r\n    // BG: #222\r\n    // Track: #1a1a1a\r\n    // Grid: #444\r\n    // Segments: #2ea043\r\n    // Playhead: #ff3333\r\n\r\n    const timeToPx = (ts) => ((ts - viewStartMs) / 1000) * zoomPxPerSec;\r\n\r\n    const renderGrid = () => {\r\n        const ticks = [];\r\n        const startMs = viewStartMs;\r\n        const endMs = viewStartMs + (containerWidth / zoomPxPerSec * 1000);\r\n\r\n        // Determine Scale and Steps\r\n        // Strategy: We want ticks every ~100px\r\n        const targetTickPx = 100;\r\n        const secondsPer100Px = targetTickPx / zoomPxPerSec;\r\n\r\n        // Available steps (seconds)\r\n        const steps = [1, 5, 10, 30, 60, 300, 600, 1800, 3600, 7200, 14400];\r\n        let stepSec = 3600;\r\n\r\n        // Find best fit step (smallest step > target)\r\n        for (let s of steps) {\r\n            if (s >= secondsPer100Px) {\r\n                stepSec = s;\r\n                break;\r\n            }\r\n        }\r\n\r\n        const stepMs = stepSec * 1000;\r\n        const firstTick = Math.floor(startMs / stepMs) * stepMs;\r\n\r\n        for (let t = firstTick; t < endMs; t += stepMs) {\r\n            const x = timeToPx(t);\r\n            const d = new Date(t);\r\n\r\n            // Format Label based on granularity\r\n            let label = \"\";\r\n            let isMajor = false;\r\n\r\n            if (stepSec >= 3600) {\r\n                // Hour View (00:00)\r\n                label = d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\r\n                isMajor = true;\r\n            } else if (stepSec >= 60) {\r\n                // Minute View (00:30)\r\n                label = d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\r\n                if (d.getMinutes() === 0) isMajor = true;\r\n            } else {\r\n                // Second View (00:00:15)\r\n                label = d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' });\r\n                if (d.getSeconds() === 0) isMajor = true;\r\n            }\r\n\r\n            // Render Tick Line\r\n            ticks.push(\r\n                <div key={`tick-${t}`} style={{\r\n                    position: 'absolute',\r\n                    left: x,\r\n                    top: 0,\r\n                    bottom: 0,\r\n                    borderLeft: isMajor ? '1px solid #666' : '1px solid #333',\r\n                    pointerEvents: 'none'\r\n                }}>\r\n                    {/* Timestamp Label */}\r\n                    <div style={{\r\n                        position: 'absolute',\r\n                        bottom: 2,\r\n                        left: 4,\r\n                        fontSize: 10,\r\n                        fontFamily: 'monospace',\r\n                        color: isMajor ? '#fff' : '#888'\r\n                    }}>\r\n                        {label}\r\n                    </div>\r\n                </div>\r\n            );\r\n        }\r\n        return ticks;\r\n    };\r\n\r\n    const renderSegments = () => {\r\n        const endVis = viewStartMs + (containerWidth / zoomPxPerSec * 1000);\r\n        return segments.map((s, i) => {\r\n            if (s.endTs < viewStartMs || s.startTs > endVis) return null;\r\n\r\n            const x1 = timeToPx(s.startTs);\r\n            const durationSec = (s.endTs - s.startTs) / 1000;\r\n            const w = Math.max(1, durationSec * zoomPxPerSec);\r\n\r\n            return (\r\n                <div key={i} style={{\r\n                    position: 'absolute',\r\n                    left: x1,\r\n                    top: 10, // Slightly padded from top\r\n                    bottom: 20, // Leave room for time text\r\n                    width: w,\r\n                    background: 'linear-gradient(180deg, #2ecc71 0%, #27ae60 100%)', // Gradient Green\r\n                    opacity: 0.9,\r\n                    border: '1px solid #1e8449',\r\n                    borderRadius: 1,\r\n                    pointerEvents: 'none'\r\n                }} />\r\n            );\r\n        });\r\n    };\r\n\r\n    return (\r\n        <div style={{\r\n            display: \"flex\",\r\n            flexDirection: \"column\",\r\n            height: \"100vh\",\r\n            background: \"var(--bg-dark)\",\r\n            color: \"var(--text-primary)\",\r\n            userSelect: \"none\",\r\n            fontFamily: '\"Segoe UI\", Roboto, \"Helvetica Neue\", sans-serif'\r\n        }}\r\n            onMouseUp={handleMouseUp}\r\n            onMouseLeave={handleMouseUp}\r\n            onMouseMove={handleMouseMove}\r\n        >\r\n            {/* TOOLBAR */}\r\n            <div style={{\r\n                height: 48,\r\n                background: \"#1f1f1f\",\r\n                borderBottom: \"1px solid #333\",\r\n                display: \"flex\",\r\n                alignItems: \"center\",\r\n                padding: \"0 16px\",\r\n                gap: 16,\r\n                boxShadow: \"0 2px 4px rgba(0,0,0,0.2)\"\r\n            }}>\r\n                <button onClick={() => navigate(\"/\")} style={{\r\n                    background: \"#333\", border: \"1px solid #444\", borderRadius: 4,\r\n                    color: \"#fff\", height: 32, padding: \"0 12px\", cursor: \"pointer\", fontWeight: 600\r\n                }}>\r\n                    ‚Üê LIVE\r\n                </button>\r\n                <div style={{ fontWeight: 600, fontSize: 14, color: '#fff' }}>PLAYBACK ARCHIVE</div>\r\n\r\n                <div style={{ flex: 1 }} />\r\n\r\n                <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>\r\n                    <div style={{ fontSize: 10, color: '#888' }}>CURRENT TIME</div>\r\n                    <div style={{ fontSize: 14, fontWeight: 'bold', color: '#2ecc71', fontFamily: 'monospace' }}>\r\n                        {new Date(currentTimeMs).toLocaleTimeString()}\r\n                    </div>\r\n                </div>\r\n\r\n                <input\r\n                    type=\"date\"\r\n                    value={selectedDate}\r\n                    onChange={e => setSelectedDate(e.target.value)}\r\n                    style={{\r\n                        background: '#111', color: '#fff', border: '1px solid #444',\r\n                        padding: '4px 8px', borderRadius: 4, fontFamily: 'inherit'\r\n                    }}\r\n                />\r\n            </div>\r\n\r\n            {/* VIDEO PLAYER */}\r\n            <div style={{ flex: 1, background: \"#000\", position: 'relative' }}>\r\n                <video ref={videoRef} style={{ width: '100%', height: '100%' }} onClick={() => {\r\n                    if (isPlaying) { videoRef.current.pause(); setIsPlaying(false); }\r\n                    else { videoRef.current.play(); setIsPlaying(true); }\r\n                }} />\r\n\r\n                {/* Overlay Play Button */}\r\n                {!isPlaying && (\r\n                    <div style={{\r\n                        position: 'absolute', top: '50%', left: '50%', transform: 'translate(-50%, -50%)',\r\n                        background: 'rgba(0,0,0,0.5)', borderRadius: '50%', width: 64, height: 64,\r\n                        display: 'flex', alignItems: 'center', justifyContent: 'center', pointerEvents: 'none'\r\n                    }}>\r\n                        <div style={{\r\n                            width: 0, height: 0,\r\n                            borderTop: '15px solid transparent',\r\n                            borderBottom: '15px solid transparent',\r\n                            borderLeft: '25px solid white',\r\n                            marginLeft: 4\r\n                        }} />\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* TIMELINE AREA */}\r\n            <div\r\n                ref={timelineContainerRef}\r\n                style={{\r\n                    height: 90,\r\n                    background: \"#1a1a1a\",\r\n                    borderTop: \"1px solid #333\",\r\n                    position: \"relative\",\r\n                    overflow: \"hidden\",\r\n                    cursor: dragRef.current.isDragging ? \"grabbing\" : \"default\"\r\n                }}\r\n                onWheel={handleWheel}\r\n                onMouseDown={handleMouseDown}\r\n            >\r\n                {/* Track Background */}\r\n                <div style={{ position: 'absolute', top: 10, bottom: 20, left: 0, right: 0, background: '#111', borderTop: '1px solid #333', borderBottom: '1px solid #333' }} />\r\n\r\n                {/* Grid & Segments */}\r\n                {renderGrid()}\r\n                {renderSegments()}\r\n\r\n                {/* PLAYHEAD (Red Line) */}\r\n                <div style={{\r\n                    position: \"absolute\",\r\n                    left: timeToPx(currentTimeMs),\r\n                    top: 0,\r\n                    bottom: 0,\r\n                    width: 2,\r\n                    background: \"#ff3333\", // Bright Red/Orange\r\n                    boxShadow: \"0 0 4px rgba(255, 51, 51, 0.4)\",\r\n                    transform: \"translateX(-1px)\",\r\n                    zIndex: 20,\r\n                    pointerEvents: \"none\"\r\n                }}>\r\n                    {/* Triangle Top */}\r\n                    <div style={{\r\n                        position: 'absolute', top: 0, left: -6,\r\n                        width: 0, height: 0,\r\n                        borderLeft: '7px solid transparent',\r\n                        borderRight: '7px solid transparent',\r\n                        borderTop: '8px solid #ff3333'\r\n                    }} />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}