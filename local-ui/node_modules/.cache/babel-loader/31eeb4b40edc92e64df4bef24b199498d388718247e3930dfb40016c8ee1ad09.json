{"ast":null,"code":"import _objectSpread from\"I:/dispecerat/github_release/dss-edge/local-ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState,useRef,useMemo}from\"react\";import{useSearchParams,useNavigate}from\"react-router-dom\";import API from\"../api\";import PlaybackCoreV2 from\"../services/PlaybackCoreV2\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function PlaybackModern(){const[searchParams]=useSearchParams();const navigate=useNavigate();const camId=searchParams.get(\"camId\");// --- STATE ---\nconst[selectedDate,setSelectedDate]=useState(new Date().toISOString().split('T')[0]);const[segments,setSegments]=useState([]);const[dayStartMs,setDayStartMs]=useState(new Date().setHours(0,0,0,0));// The \"Red Line\" time\nconst[currentTimeMs,setCurrentTimeMs]=useState(Date.now());// Zoom level (Pixels per Second) - Default 10px (~30px width for 3s segment) for visibility\nconst[zoomPxPerSec,setZoomPxPerSec]=useState(10);const[isPlaying,setIsPlaying]=useState(false);const[isLoading,setIsLoading]=useState(false);const[containerWidth,setContainerWidth]=useState(1000);const videoRef=useRef(null);const coreRef=useRef(null);const timelineContainerRef=useRef(null);const dragRef=useRef({isDragging:false,startX:0,startTime:0});// --- 1. LOAD DATA ---\nuseEffect(()=>{if(!camId||!selectedDate)return;const load=async()=>{setIsLoading(true);try{const res=await API.get(\"playback/timeline-day/\".concat(camId,\"/\").concat(selectedDate));const data=res.data;const segs=data.segments||[];// Parse strings to ints just in case\nconst cleanSegs=segs.map(s=>_objectSpread(_objectSpread({},s),{},{start_ts:Number(s.start_ts),end_ts:Number(s.end_ts)}));setSegments(cleanSegs);if(data.dayStart)setDayStartMs(data.dayStart);else setDayStartMs(new Date(selectedDate).setHours(0,0,0,0));// Auto-center on the last segment if available\nif(cleanSegs.length>0){const last=cleanSegs[cleanSegs.length-1];setCurrentTimeMs(last.end_ts-1000);// 1s before end of last segment\n}}catch(e){console.error(\"Timeline Load Error:\",e);setSegments([]);}finally{setIsLoading(false);}};load();},[camId,selectedDate]);// --- 2. PLAYER & SYNC ---\nuseEffect(()=>{if(videoRef.current&&camId){coreRef.current=new PlaybackCoreV2(videoRef.current,camId);}return()=>{var _coreRef$current;return(_coreRef$current=coreRef.current)===null||_coreRef$current===void 0?void 0:_coreRef$current.destroy();};},[camId]);// Update Core with Segments (Crucial for Gap Skipping)\nuseEffect(()=>{if(coreRef.current&&segments.length>0){coreRef.current.setSegments(segments.map(s=>({startTs:s.start_ts,endTs:s.end_ts,file:s.file})));}},[segments]);// Sync Loop: Update UI from Player Time\nuseEffect(()=>{const interval=setInterval(()=>{if(isPlaying&&coreRef.current){const epoch=coreRef.current.getCurrentEpochMs();// Only update if difference is meaningful to prevent jitter, \n// but we need it smooth for the timeline movement.\nif(epoch&&Math.abs(epoch-currentTimeMs)>100){setCurrentTimeMs(epoch);}}},50);// 20FPS\nreturn()=>clearInterval(interval);},[isPlaying,currentTimeMs]);// Seek Action\nconst performSeek=epoch=>{// Clamp to day bounds? Optional, but good practice\n// epoch = Math.max(dayStartMs, Math.min(dayStartMs + 86400000, epoch));\nsetCurrentTimeMs(epoch);if(coreRef.current){console.log(\"[Playback] Seeking to \".concat(epoch,\" (\").concat(new Date(epoch).toLocaleTimeString(),\")\"));coreRef.current.seekTo(epoch);if(!isPlaying){videoRef.current.play().catch(()=>{});setIsPlaying(true);}}};// --- 3. TIMELINE LOGIC (NEW ARCHITECTURE) ---\n// Measure container\nuseEffect(()=>{const handleResize=()=>{if(timelineContainerRef.current){setContainerWidth(timelineContainerRef.current.clientWidth);}};window.addEventListener('resize',handleResize);handleResize();return()=>window.removeEventListener('resize',handleResize);},[]);// MAIN TRANSFORM CALCULATION\n// The content moves left as time increases.\n// At `dayStart`, content offset = 0 - (0) + W/2 ?? No.\n// We want: Position of `currentTime` = `containerWidth / 2`.\n// Segment X relative to DayStart = `(segStart - dayStart) * Px`.\n// Content Shift = `(containerWidth / 2) - (currentOffsetPx)`.\nconst currentOffsetFromDayStartPx=(currentTimeMs-dayStartMs)/1000*zoomPxPerSec;const contentTranslateX=containerWidth/2-currentOffsetFromDayStartPx;// Handlers\nconst handleWheel=e=>{e.preventDefault();const delta=e.deltaY>0?0.9:1.1;setZoomPxPerSec(prev=>{const next=prev*delta;return Math.max(0.1,Math.min(200,next));});};const handleMouseDown=e=>{dragRef.current={isDragging:true,startX:e.clientX,startTime:currentTimeMs};document.body.style.cursor='grabbing';};const handleMouseMove=e=>{if(!dragRef.current.isDragging)return;// Drag Left (e.clientX < startX) -> We want to move FUTURE into view -> Time INCREASES\nconst diffPx=dragRef.current.startX-e.clientX;const dtMs=diffPx/zoomPxPerSec*1000;const newTime=dragRef.current.startTime+dtMs;setCurrentTimeMs(newTime);};const handleMouseUp=e=>{if(dragRef.current.isDragging){dragRef.current.isDragging=false;document.body.style.cursor='default';// Check for Click vs Drag\nconst dist=Math.abs(e.clientX-dragRef.current.startX);if(dist<5){// CLICK LOGIC:\n// We clicked on the screen. We need to map ScreenX -> Time.\n// ScreenX is relative to container left.\n// pxToTime Formula:\n// px = (W/2) + (Target - Current) * Z\n// (px - W/2) / Z = Target - Current\n// Target = Current + (px - W/2) / Z\nconst rect=timelineContainerRef.current.getBoundingClientRect();const clickX=e.clientX-rect.left;// Convert pixels relative to center line\nconst offsetFromCenterPx=clickX-containerWidth/2;const offsetSeconds=offsetFromCenterPx/zoomPxPerSec;const clickedTime=currentTimeMs+offsetSeconds*1000;performSeek(clickedTime);}else{// End of Drag -> Seek to final drag position\nperformSeek(currentTimeMs);}}};// --- 4. RENDERERS ---\nconst renderGrid=useMemo(()=>{// Optimize: Only render ticks visible in viewport? \n// For 1000px width, we can just render the visible range.\nconst widthSec=containerWidth/zoomPxPerSec;const startSec=(currentTimeMs-dayStartMs)/1000-widthSec/2;const endSec=startSec+widthSec;const SECONDS_PER_TICK_TARGET=100/zoomPxPerSec;const steps=[1,5,10,30,60,300,600,1800,3600,7200,14400];const stepSec=steps.find(s=>s>=SECONDS_PER_TICK_TARGET)||3600;const stepMs=stepSec*1000;// Align\nconst rangeStartMs=Math.floor((dayStartMs+startSec*1000)/stepMs)*stepMs;const rangeEndMs=dayStartMs+endSec*1000;const ticks=[];for(let t=rangeStartMs;t<=rangeEndMs;t+=stepMs){// Position relative to DayStart\nconst posPx=(t-dayStartMs)/1000*zoomPxPerSec;const date=new Date(t);let label=stepSec<60?date.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit',second:'2-digit'}):date.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});ticks.push(/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',left:posPx,top:0,height:20,borderLeft:'1px solid #444',paddingLeft:4,fontSize:10,color:'#888'},children:label},t));}return ticks;},[containerWidth,currentTimeMs,dayStartMs,zoomPxPerSec]);const renderSegments=useMemo(()=>{// Visibility Culling\nconst paddingSec=100;// preload buffer\nconst visibleStartMs=currentTimeMs-containerWidth/2/zoomPxPerSec*1000-paddingSec*1000;const visibleEndMs=currentTimeMs+containerWidth/2/zoomPxPerSec*1000+paddingSec*1000;const visibleSegs=segments.filter(s=>s.end_ts>visibleStartMs&&s.start_ts<visibleEndMs);return visibleSegs.map((s,i)=>{const startPx=(s.start_ts-dayStartMs)/1000*zoomPxPerSec;const durationSec=(s.end_ts-s.start_ts)/1000;const widthPx=Math.max(2,durationSec*zoomPxPerSec);// Force min 2px\nreturn/*#__PURE__*/_jsx(\"div\",{// title={new Date(s.start_ts).toLocaleTimeString()}\nstyle:{position:'absolute',left:startPx,top:25,width:widthPx,height:40,background:'#00cc66',// Strong green\nopacity:0.9,borderRight:'1px solid rgba(0,0,0,0.2)'}},i);});},[segments,dayStartMs,zoomPxPerSec,currentTimeMs,containerWidth]);return/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexDirection:\"column\",height:\"100vh\",background:\"#111\",color:\"#ccc\",userSelect:\"none\",overflow:\"hidden\"},onMouseUp:handleMouseUp,onMouseLeave:handleMouseUp,onMouseMove:handleMouseMove,children:[/*#__PURE__*/_jsxs(\"div\",{style:{height:48,background:\"#1a1a1a\",display:\"flex\",alignItems:\"center\",padding:\"0 16px\",borderBottom:\"1px solid #333\",justifyContent:\"space-between\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",gap:16},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate(\"/\"),style:{background:\"none\",border:\"none\",color:\"#fff\",fontSize:18,cursor:\"pointer\"},children:\"\\u2190\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:600,color:\"#fff\"},children:\"ARCHIVE\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:13,background:\"#333\",padding:\"2px 8px\",borderRadius:4},children:camId}),isLoading&&/*#__PURE__*/_jsx(\"span\",{style:{color:\"#00cc66\",fontSize:12},children:\"Syncing...\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",gap:10},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setZoomPxPerSec(z=>z*1.5),style:{background:\"#333\",border:\"1px solid #444\",color:\"#fff\",width:24,height:24,cursor:\"pointer\"},children:\"+\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setZoomPxPerSec(z=>z/1.5),style:{background:\"#333\",border:\"1px solid #444\",color:\"#fff\",width:24,height:24,cursor:\"pointer\"},children:\"-\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:selectedDate,onChange:e=>setSelectedDate(e.target.value),style:{background:\"#000\",border:\"1px solid #444\",color:\"#fff\",padding:\"4px 8px\",borderRadius:4}})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{flex:1,position:\"relative\",background:\"#000\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\"},children:/*#__PURE__*/_jsx(\"video\",{ref:videoRef,onClick:()=>{if(isPlaying){videoRef.current.pause();setIsPlaying(false);}else{videoRef.current.play();setIsPlaying(true);}},style:{width:\"100%\",height:\"100%\"}})}),/*#__PURE__*/_jsxs(\"div\",{ref:timelineContainerRef,style:{height:140,background:\"#0f0f0f\",borderTop:\"1px solid #333\",position:\"relative\",overflow:\"hidden\",cursor:dragRef.current.isDragging?\"grabbing\":\"grab\"},onWheel:handleWheel,onMouseDown:handleMouseDown,children:[/*#__PURE__*/_jsx(\"div\",{style:{position:\"absolute\",left:\"50%\",top:0,bottom:0,width:2,background:\"#ff3333\",zIndex:20,transform:\"translateX(-1px)\",// Center exactly\npointerEvents:\"none\",boxShadow:\"0 0 4px rgba(255,0,0,0.5)\"},children:/*#__PURE__*/_jsx(\"div\",{style:{position:\"absolute\",bottom:-24,left:-60,width:120,textAlign:\"center\",fontSize:12,color:\"#ff3333\",fontWeight:\"bold\",background:\"#000\",padding:\"2px 0\"},children:new Date(currentTimeMs).toLocaleTimeString()})}),/*#__PURE__*/_jsx(\"div\",{style:{position:\"absolute\",top:0,height:\"100%\",left:0,willChange:\"transform\",// Hardware accel\ntransform:\"translateX(\".concat(contentTranslateX,\"px)\")},children:/*#__PURE__*/_jsxs(\"div\",{style:{position:\"relative\",height:\"100%\"},children:[renderGrid,renderSegments,/*#__PURE__*/_jsx(\"div\",{style:{position:\"absolute\",left:0,top:0,bottom:0,width:2,background:\"blue\"}}),/*#__PURE__*/_jsx(\"div\",{style:{position:\"absolute\",left:Constants_86400*zoomPxPerSec,top:0,bottom:0,width:2,background:\"blue\"}})]})})]})]});}const Constants_86400=86400;","map":{"version":3,"names":["React","useEffect","useState","useRef","useMemo","useSearchParams","useNavigate","API","PlaybackCoreV2","jsx","_jsx","jsxs","_jsxs","PlaybackModern","searchParams","navigate","camId","get","selectedDate","setSelectedDate","Date","toISOString","split","segments","setSegments","dayStartMs","setDayStartMs","setHours","currentTimeMs","setCurrentTimeMs","now","zoomPxPerSec","setZoomPxPerSec","isPlaying","setIsPlaying","isLoading","setIsLoading","containerWidth","setContainerWidth","videoRef","coreRef","timelineContainerRef","dragRef","isDragging","startX","startTime","load","res","concat","data","segs","cleanSegs","map","s","_objectSpread","start_ts","Number","end_ts","dayStart","length","last","e","console","error","current","_coreRef$current","destroy","startTs","endTs","file","interval","setInterval","epoch","getCurrentEpochMs","Math","abs","clearInterval","performSeek","log","toLocaleTimeString","seekTo","play","catch","handleResize","clientWidth","window","addEventListener","removeEventListener","currentOffsetFromDayStartPx","contentTranslateX","handleWheel","preventDefault","delta","deltaY","prev","next","max","min","handleMouseDown","clientX","document","body","style","cursor","handleMouseMove","diffPx","dtMs","newTime","handleMouseUp","dist","rect","getBoundingClientRect","clickX","left","offsetFromCenterPx","offsetSeconds","clickedTime","renderGrid","widthSec","startSec","endSec","SECONDS_PER_TICK_TARGET","steps","stepSec","find","stepMs","rangeStartMs","floor","rangeEndMs","ticks","t","posPx","date","label","hour","minute","second","push","position","top","height","borderLeft","paddingLeft","fontSize","color","children","renderSegments","paddingSec","visibleStartMs","visibleEndMs","visibleSegs","filter","i","startPx","durationSec","widthPx","width","background","opacity","borderRight","display","flexDirection","userSelect","overflow","onMouseUp","onMouseLeave","onMouseMove","alignItems","padding","borderBottom","justifyContent","gap","onClick","border","fontWeight","borderRadius","z","type","value","onChange","target","flex","ref","pause","borderTop","onWheel","onMouseDown","bottom","zIndex","transform","pointerEvents","boxShadow","textAlign","willChange","Constants_86400"],"sources":["I:/dispecerat/github_release/dss-edge/local-ui/src/pages/PlaybackModern.js"],"sourcesContent":["import React, { useEffect, useState, useRef, useMemo } from \"react\";\r\nimport { useSearchParams, useNavigate } from \"react-router-dom\";\r\nimport API from \"../api\";\r\nimport PlaybackCoreV2 from \"../services/PlaybackCoreV2\";\r\n\r\nexport default function PlaybackModern() {\r\n    const [searchParams] = useSearchParams();\r\n    const navigate = useNavigate();\r\n    const camId = searchParams.get(\"camId\");\r\n\r\n    // --- STATE ---\r\n    const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0]);\r\n    const [segments, setSegments] = useState([]);\r\n    const [dayStartMs, setDayStartMs] = useState(new Date().setHours(0, 0, 0, 0));\r\n\r\n    // The \"Red Line\" time\r\n    const [currentTimeMs, setCurrentTimeMs] = useState(Date.now());\r\n\r\n    // Zoom level (Pixels per Second) - Default 10px (~30px width for 3s segment) for visibility\r\n    const [zoomPxPerSec, setZoomPxPerSec] = useState(10);\r\n\r\n    const [isPlaying, setIsPlaying] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [containerWidth, setContainerWidth] = useState(1000);\r\n\r\n    const videoRef = useRef(null);\r\n    const coreRef = useRef(null);\r\n    const timelineContainerRef = useRef(null);\r\n    const dragRef = useRef({ isDragging: false, startX: 0, startTime: 0 });\r\n\r\n    // --- 1. LOAD DATA ---\r\n    useEffect(() => {\r\n        if (!camId || !selectedDate) return;\r\n\r\n        const load = async () => {\r\n            setIsLoading(true);\r\n            try {\r\n                const res = await API.get(`playback/timeline-day/${camId}/${selectedDate}`);\r\n                const data = res.data;\r\n                const segs = data.segments || [];\r\n\r\n                // Parse strings to ints just in case\r\n                const cleanSegs = segs.map(s => ({\r\n                    ...s,\r\n                    start_ts: Number(s.start_ts),\r\n                    end_ts: Number(s.end_ts)\r\n                }));\r\n\r\n                setSegments(cleanSegs);\r\n                if (data.dayStart) setDayStartMs(data.dayStart);\r\n                else setDayStartMs(new Date(selectedDate).setHours(0, 0, 0, 0));\r\n\r\n                // Auto-center on the last segment if available\r\n                if (cleanSegs.length > 0) {\r\n                    const last = cleanSegs[cleanSegs.length - 1];\r\n                    setCurrentTimeMs(last.end_ts - 1000); // 1s before end of last segment\r\n                }\r\n            } catch (e) {\r\n                console.error(\"Timeline Load Error:\", e);\r\n                setSegments([]);\r\n            } finally {\r\n                setIsLoading(false);\r\n            }\r\n        };\r\n\r\n        load();\r\n    }, [camId, selectedDate]);\r\n\r\n    // --- 2. PLAYER & SYNC ---\r\n    useEffect(() => {\r\n        if (videoRef.current && camId) {\r\n            coreRef.current = new PlaybackCoreV2(videoRef.current, camId);\r\n        }\r\n        return () => coreRef.current?.destroy();\r\n    }, [camId]);\r\n\r\n    // Update Core with Segments (Crucial for Gap Skipping)\r\n    useEffect(() => {\r\n        if (coreRef.current && segments.length > 0) {\r\n            coreRef.current.setSegments(segments.map(s => ({\r\n                startTs: s.start_ts,\r\n                endTs: s.end_ts,\r\n                file: s.file\r\n            })));\r\n        }\r\n    }, [segments]);\r\n\r\n    // Sync Loop: Update UI from Player Time\r\n    useEffect(() => {\r\n        const interval = setInterval(() => {\r\n            if (isPlaying && coreRef.current) {\r\n                const epoch = coreRef.current.getCurrentEpochMs();\r\n                // Only update if difference is meaningful to prevent jitter, \r\n                // but we need it smooth for the timeline movement.\r\n                if (epoch && Math.abs(epoch - currentTimeMs) > 100) {\r\n                    setCurrentTimeMs(epoch);\r\n                }\r\n            }\r\n        }, 50); // 20FPS\r\n        return () => clearInterval(interval);\r\n    }, [isPlaying, currentTimeMs]);\r\n\r\n    // Seek Action\r\n    const performSeek = (epoch) => {\r\n        // Clamp to day bounds? Optional, but good practice\r\n        // epoch = Math.max(dayStartMs, Math.min(dayStartMs + 86400000, epoch));\r\n\r\n        setCurrentTimeMs(epoch);\r\n        if (coreRef.current) {\r\n            console.log(`[Playback] Seeking to ${epoch} (${new Date(epoch).toLocaleTimeString()})`);\r\n            coreRef.current.seekTo(epoch);\r\n            if (!isPlaying) {\r\n                videoRef.current.play().catch(() => { });\r\n                setIsPlaying(true);\r\n            }\r\n        }\r\n    };\r\n\r\n    // --- 3. TIMELINE LOGIC (NEW ARCHITECTURE) ---\r\n\r\n    // Measure container\r\n    useEffect(() => {\r\n        const handleResize = () => {\r\n            if (timelineContainerRef.current) {\r\n                setContainerWidth(timelineContainerRef.current.clientWidth);\r\n            }\r\n        };\r\n        window.addEventListener('resize', handleResize);\r\n        handleResize();\r\n        return () => window.removeEventListener('resize', handleResize);\r\n    }, []);\r\n\r\n    // MAIN TRANSFORM CALCULATION\r\n    // The content moves left as time increases.\r\n    // At `dayStart`, content offset = 0 - (0) + W/2 ?? No.\r\n    // We want: Position of `currentTime` = `containerWidth / 2`.\r\n    // Segment X relative to DayStart = `(segStart - dayStart) * Px`.\r\n    // Content Shift = `(containerWidth / 2) - (currentOffsetPx)`.\r\n    const currentOffsetFromDayStartPx = (currentTimeMs - dayStartMs) / 1000 * zoomPxPerSec;\r\n    const contentTranslateX = (containerWidth / 2) - currentOffsetFromDayStartPx;\r\n\r\n    // Handlers\r\n    const handleWheel = (e) => {\r\n        e.preventDefault();\r\n        const delta = e.deltaY > 0 ? 0.9 : 1.1;\r\n        setZoomPxPerSec(prev => {\r\n            const next = prev * delta;\r\n            return Math.max(0.1, Math.min(200, next));\r\n        });\r\n    };\r\n\r\n    const handleMouseDown = (e) => {\r\n        dragRef.current = {\r\n            isDragging: true,\r\n            startX: e.clientX,\r\n            startTime: currentTimeMs\r\n        };\r\n        document.body.style.cursor = 'grabbing';\r\n    };\r\n\r\n    const handleMouseMove = (e) => {\r\n        if (!dragRef.current.isDragging) return;\r\n\r\n        // Drag Left (e.clientX < startX) -> We want to move FUTURE into view -> Time INCREASES\r\n        const diffPx = dragRef.current.startX - e.clientX;\r\n        const dtMs = (diffPx / zoomPxPerSec) * 1000;\r\n\r\n        const newTime = dragRef.current.startTime + dtMs;\r\n        setCurrentTimeMs(newTime);\r\n    };\r\n\r\n    const handleMouseUp = (e) => {\r\n        if (dragRef.current.isDragging) {\r\n            dragRef.current.isDragging = false;\r\n            document.body.style.cursor = 'default';\r\n\r\n            // Check for Click vs Drag\r\n            const dist = Math.abs(e.clientX - dragRef.current.startX);\r\n            if (dist < 5) {\r\n                // CLICK LOGIC:\r\n                // We clicked on the screen. We need to map ScreenX -> Time.\r\n                // ScreenX is relative to container left.\r\n                // pxToTime Formula:\r\n                // px = (W/2) + (Target - Current) * Z\r\n                // (px - W/2) / Z = Target - Current\r\n                // Target = Current + (px - W/2) / Z\r\n                const rect = timelineContainerRef.current.getBoundingClientRect();\r\n                const clickX = e.clientX - rect.left;\r\n\r\n                // Convert pixels relative to center line\r\n                const offsetFromCenterPx = clickX - (containerWidth / 2);\r\n                const offsetSeconds = offsetFromCenterPx / zoomPxPerSec;\r\n                const clickedTime = currentTimeMs + (offsetSeconds * 1000);\r\n\r\n                performSeek(clickedTime);\r\n            } else {\r\n                // End of Drag -> Seek to final drag position\r\n                performSeek(currentTimeMs);\r\n            }\r\n        }\r\n    };\r\n\r\n    // --- 4. RENDERERS ---\r\n\r\n    const renderGrid = useMemo(() => {\r\n        // Optimize: Only render ticks visible in viewport? \r\n        // For 1000px width, we can just render the visible range.\r\n        const widthSec = containerWidth / zoomPxPerSec;\r\n        const startSec = (currentTimeMs - dayStartMs) / 1000 - (widthSec / 2);\r\n        const endSec = startSec + widthSec;\r\n\r\n        const SECONDS_PER_TICK_TARGET = 100 / zoomPxPerSec;\r\n        const steps = [1, 5, 10, 30, 60, 300, 600, 1800, 3600, 7200, 14400];\r\n        const stepSec = steps.find(s => s >= SECONDS_PER_TICK_TARGET) || 3600;\r\n        const stepMs = stepSec * 1000;\r\n\r\n        // Align\r\n        const rangeStartMs = Math.floor((dayStartMs + (startSec * 1000)) / stepMs) * stepMs;\r\n        const rangeEndMs = dayStartMs + (endSec * 1000);\r\n\r\n        const ticks = [];\r\n        for (let t = rangeStartMs; t <= rangeEndMs; t += stepMs) {\r\n            // Position relative to DayStart\r\n            const posPx = (t - dayStartMs) / 1000 * zoomPxPerSec;\r\n\r\n            const date = new Date(t);\r\n            let label = stepSec < 60\r\n                ? date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' })\r\n                : date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\r\n\r\n            ticks.push(\r\n                <div key={t} style={{\r\n                    position: 'absolute',\r\n                    left: posPx,\r\n                    top: 0,\r\n                    height: 20,\r\n                    borderLeft: '1px solid #444',\r\n                    paddingLeft: 4,\r\n                    fontSize: 10,\r\n                    color: '#888'\r\n                }}>\r\n                    {label}\r\n                </div>\r\n            );\r\n        }\r\n        return ticks;\r\n    }, [containerWidth, currentTimeMs, dayStartMs, zoomPxPerSec]);\r\n\r\n    const renderSegments = useMemo(() => {\r\n        // Visibility Culling\r\n        const paddingSec = 100; // preload buffer\r\n        const visibleStartMs = currentTimeMs - ((containerWidth / 2) / zoomPxPerSec * 1000) - (paddingSec * 1000);\r\n        const visibleEndMs = currentTimeMs + ((containerWidth / 2) / zoomPxPerSec * 1000) + (paddingSec * 1000);\r\n\r\n        const visibleSegs = segments.filter(s => s.end_ts > visibleStartMs && s.start_ts < visibleEndMs);\r\n\r\n        return visibleSegs.map((s, i) => {\r\n            const startPx = (s.start_ts - dayStartMs) / 1000 * zoomPxPerSec;\r\n            const durationSec = (s.end_ts - s.start_ts) / 1000;\r\n            const widthPx = Math.max(2, durationSec * zoomPxPerSec); // Force min 2px\r\n\r\n            return (\r\n                <div\r\n                    key={i}\r\n                    // title={new Date(s.start_ts).toLocaleTimeString()}\r\n                    style={{\r\n                        position: 'absolute',\r\n                        left: startPx,\r\n                        top: 25,\r\n                        width: widthPx,\r\n                        height: 40,\r\n                        background: '#00cc66', // Strong green\r\n                        opacity: 0.9,\r\n                        borderRight: '1px solid rgba(0,0,0,0.2)'\r\n                    }}\r\n                />\r\n            );\r\n        });\r\n    }, [segments, dayStartMs, zoomPxPerSec, currentTimeMs, containerWidth]);\r\n\r\n    return (\r\n        <div style={{ display: \"flex\", flexDirection: \"column\", height: \"100vh\", background: \"#111\", color: \"#ccc\", userSelect: \"none\", overflow: \"hidden\" }}\r\n            onMouseUp={handleMouseUp}\r\n            onMouseLeave={handleMouseUp}\r\n            onMouseMove={handleMouseMove}\r\n        >\r\n            {/* 1. HEADER */}\r\n            <div style={{ height: 48, background: \"#1a1a1a\", display: \"flex\", alignItems: \"center\", padding: \"0 16px\", borderBottom: \"1px solid #333\", justifyContent: \"space-between\" }}>\r\n                <div style={{ display: \"flex\", alignItems: \"center\", gap: 16 }}>\r\n                    <button onClick={() => navigate(\"/\")} style={{ background: \"none\", border: \"none\", color: \"#fff\", fontSize: 18, cursor: \"pointer\" }}>‚Üê</button>\r\n                    <div style={{ fontWeight: 600, color: \"#fff\" }}>ARCHIVE</div>\r\n                    <div style={{ fontSize: 13, background: \"#333\", padding: \"2px 8px\", borderRadius: 4 }}>{camId}</div>\r\n                    {isLoading && <span style={{ color: \"#00cc66\", fontSize: 12 }}>Syncing...</span>}\r\n                </div>\r\n                <div style={{ display: \"flex\", alignItems: \"center\", gap: 10 }}>\r\n                    <button onClick={() => setZoomPxPerSec(z => z * 1.5)} style={{ background: \"#333\", border: \"1px solid #444\", color: \"#fff\", width: 24, height: 24, cursor: \"pointer\" }}>+</button>\r\n                    <button onClick={() => setZoomPxPerSec(z => z / 1.5)} style={{ background: \"#333\", border: \"1px solid #444\", color: \"#fff\", width: 24, height: 24, cursor: \"pointer\" }}>-</button>\r\n                    <input\r\n                        type=\"date\"\r\n                        value={selectedDate}\r\n                        onChange={(e) => setSelectedDate(e.target.value)}\r\n                        style={{ background: \"#000\", border: \"1px solid #444\", color: \"#fff\", padding: \"4px 8px\", borderRadius: 4 }}\r\n                    />\r\n                </div>\r\n            </div>\r\n\r\n            {/* 2. VIDEO PLAYER */}\r\n            <div style={{ flex: 1, position: \"relative\", background: \"#000\", display: \"flex\", alignItems: \"center\", justifyContent: \"center\" }}>\r\n                <video\r\n                    ref={videoRef}\r\n                    onClick={() => { if (isPlaying) { videoRef.current.pause(); setIsPlaying(false); } else { videoRef.current.play(); setIsPlaying(true); } }}\r\n                    style={{ width: \"100%\", height: \"100%\" }}\r\n                />\r\n            </div>\r\n\r\n            {/* 3. TIMELINE AREA (THE FIXED VIEWPORT) */}\r\n            <div\r\n                ref={timelineContainerRef}\r\n                style={{\r\n                    height: 140,\r\n                    background: \"#0f0f0f\",\r\n                    borderTop: \"1px solid #333\",\r\n                    position: \"relative\",\r\n                    overflow: \"hidden\",\r\n                    cursor: dragRef.current.isDragging ? \"grabbing\" : \"grab\"\r\n                }}\r\n                onWheel={handleWheel}\r\n                onMouseDown={handleMouseDown}\r\n            >\r\n                {/* 3.1 RED PLAYHEAD (FIXED) */}\r\n                <div style={{\r\n                    position: \"absolute\",\r\n                    left: \"50%\",\r\n                    top: 0,\r\n                    bottom: 0,\r\n                    width: 2,\r\n                    background: \"#ff3333\",\r\n                    zIndex: 20,\r\n                    transform: \"translateX(-1px)\", // Center exactly\r\n                    pointerEvents: \"none\",\r\n                    boxShadow: \"0 0 4px rgba(255,0,0,0.5)\"\r\n                }}>\r\n                    <div style={{ position: \"absolute\", bottom: -24, left: -60, width: 120, textAlign: \"center\", fontSize: 12, color: \"#ff3333\", fontWeight: \"bold\", background: \"#000\", padding: \"2px 0\" }}>\r\n                        {new Date(currentTimeMs).toLocaleTimeString()}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* 3.2 MOVING CONTENT CONTAINER */}\r\n                <div style={{\r\n                    position: \"absolute\",\r\n                    top: 0,\r\n                    height: \"100%\",\r\n                    left: 0,\r\n                    willChange: \"transform\", // Hardware accel\r\n                    transform: `translateX(${contentTranslateX}px)`\r\n                }}>\r\n                    {/* Render Segments & Grid inside this moving world */}\r\n                    <div style={{ position: \"relative\", height: \"100%\" }}>\r\n                        {renderGrid}\r\n                        {renderSegments}\r\n\r\n                        {/* Day Bounds Markers */}\r\n                        <div style={{ position: \"absolute\", left: 0, top: 0, bottom: 0, width: 2, background: \"blue\" }} />\r\n                        <div style={{ position: \"absolute\", left: Constants_86400 * zoomPxPerSec, top: 0, bottom: 0, width: 2, background: \"blue\" }} />\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nconst Constants_86400 = 86400;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}