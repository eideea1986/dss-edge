{"ast":null,"code":"import React,{useEffect,useState,useRef,useCallback}from\"react\";import{useSearchParams}from\"react-router-dom\";import API from\"../api\";import Hls from'hls.js';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const styles=\"\\n* { box-sizing: border-box; margin: 0; padding: 0; }\\nbody { background: #cfd2d6; }\\n.playback-page { height: 100vh; display: flex; flex-direction: column; background: #cfd2d6; font-family: Arial, sans-serif; }\\n.playback-header { height: 40px; background: #d9d9d9; display: flex; align-items: center; padding: 0 10px; gap: 8px; border-bottom: 1px solid #999; }\\n.video-viewport { height: calc(100vh - 140px); background: #000; display: flex; align-items: center; justify-content: center; position: relative; }\\nvideo { width: 100%; height: 100%; object-fit: contain; background: #000; }\\n.controls { height: 60px; background: #d9d9d9; display: flex; align-items: center; gap: 6px; padding: 0 8px; border-bottom: 1px solid #999; }\\n.timeline-area { height: 80px; background: #e6e6e6; border-top: 1px solid #999; position: relative; overflow: hidden; cursor: crosshair; user-select: none; z-index: 10; }\\n.time-markers { position: absolute; top: 0; left: 0; width: 100%; height: 20px; display: flex; pointer-events: none; border-bottom: 1px solid #ccc; }\\n.time-marker { flex: 1; border-left: 1px solid #999; font-size: 10px; color: #555; padding-left: 2px; height: 100%; }\\n.segments-track { position: absolute; top: 25px; height: 30px; left: 0; right: 0; background: rgba(0,0,0,0.05); pointer-events: none; }\\n.segment { position: absolute; height: 100%; background: #2ecc71; opacity: 0.8; }\\n.test-segment { position: absolute; height: 100%; background: red; opacity: 0.8; top: 0; z-index: 5; }\\n.cursor { position: absolute; top: 0; height: 100%; width: 2px; background: red; z-index: 10; pointer-events: none; }\\nbutton { padding: 4px 10px; border: 1px solid #555; background: #f0f0f0; cursor: pointer; font-size: 13px; }\\nbutton:hover { background: #fff; }\\nbutton:disabled { color: #aaa; cursor: not-allowed; }\\n.info-text { font-size: 11px; color: #555; margin-left: 10px; }\\n.hud { position: absolute; top: 10px; right: 10px; background: black; color: lime; padding: 5px; font-size: 10px; z-index: 1000; pointer-events: none; }\\n\";export default function Playback(){var _debug$firstNorm,_debug$firstNorm$left;const[params]=useSearchParams();const camId=params.get(\"camId\");const[timelineSegments,setTimelineSegments]=useState([]);const[serverDayStart,setServerDayStart]=useState(0);const[debug,setDebug]=useState({});const[selectedDate,setSelectedDate]=useState(()=>{const d=new Date();const offset=d.getTimezoneOffset()*60000;const local=new Date(d.getTime()-offset);return local.toISOString().split('T')[0];});const[isPlaying,setIsPlaying]=useState(false);const[isLoading,setIsLoading]=useState(false);const videoRef=useRef(null);const hlsRef=useRef(null);const cursorRef=useRef(null);const timelineRef=useRef(null);// FETCH TIMELINE\nuseEffect(()=>{if(!camId||!selectedDate)return;console.log(\"[Timeline] Fetching FULL DAY: \".concat(selectedDate));API.get(\"/playback/timeline-day/\".concat(camId,\"/\").concat(selectedDate)).then(res=>{const{segments:raw,dayStart}=res.data;setServerDayStart(dayStart);const DAY_MS=86400000;const dayEnd=dayStart+DAY_MS;console.log('UI serverNowMs (DayStart)',dayStart,new Date(dayStart).toLocaleString());// FORCE TEST SEGMENT: 12:00-14:00 (50% - 58%)\nconst testSeg={start_ts:dayStart+12*3600*1000,// 12:00\nend_ts:dayStart+14*3600*1000// 14:00\n};// NORMALIZE\nconst norm=raw.map(e=>{const start=Math.max(Number(e.start_ts),dayStart);const end=Math.min(Number(e.end_ts),dayEnd);if(end<=start)return null;return{left:(start-dayStart)/DAY_MS,width:(end-start)/DAY_MS,ts:Number(e.start_ts)// Original start\n};}).filter(Boolean);// Add TEST segment to norm for rendering check\nnorm.push({left:0.5,// 12:00\nwidth:0.083,// 2h\nts:testSeg.start_ts,isTest:true});setTimelineSegments(norm);setDebug({dayStart,dayStartStr:new Date(dayStart).toLocaleString(),rawCount:raw.length,normCount:norm.length,firstRaw:raw[0],firstNorm:norm[0]});}).catch(e=>console.error(e));},[camId,selectedDate]);// HLS Helper\nconst waitForHls=async function(url){let retries=arguments.length>1&&arguments[1]!==undefined?arguments[1]:50;for(let i=0;i<retries;i++){try{const res=await fetch(url,{method:'HEAD'});if(res.ok)return true;}catch(_unused){/* ignore */}await new Promise(r=>setTimeout(r,200));}return false;};const play=useCallback(async startTime=>{if(!startTime)return alert(\"Selectează un moment pe timeline\");setIsLoading(true);try{try{API.post('/playback/stop',{camId});if(hlsRef.current){hlsRef.current.destroy();hlsRef.current=null;}}catch(e){}console.log(\"[Playback] REQUEST TS: \".concat(startTime,\" (\").concat(new Date(startTime).toLocaleTimeString(),\")\"));const res=await API.post('/playback/start',{camId,from:startTime,to:Date.now(),speed:1});const hlsUrl=\"http://192.168.120.208:8080\".concat(res.data.hlsUrl);const videoUrl=\"\".concat(hlsUrl,\"?t=\").concat(Date.now());if(!(await waitForHls(hlsUrl)))throw new Error(\"HLS Timeout\");if(Hls.isSupported()){const hls=new Hls();hls.loadSource(videoUrl);hls.attachMedia(videoRef.current);hls.on(Hls.Events.MANIFEST_PARSED,()=>videoRef.current.play().catch(console.error));hlsRef.current=hls;}else if(videoRef.current.canPlayType('application/vnd.apple.mpegurl')){videoRef.current.src=videoUrl;videoRef.current.play();}setIsPlaying(true);}catch(e){console.error(e);}finally{setIsLoading(false);}},[camId]);const stop=async()=>{try{API.post('/playback/stop',{camId});if(hlsRef.current){hlsRef.current.destroy();hlsRef.current=null;}if(videoRef.current){videoRef.current.pause();videoRef.current.removeAttribute('src');videoRef.current.load();}setIsPlaying(false);}catch(e){console.error(e);}};const handleSeek=e=>{if(!serverDayStart)return;const rect=timelineRef.current.getBoundingClientRect();const x=e.clientX-rect.left;const width=rect.width;const ratio=Math.max(0,Math.min(1,x/width));const seekTs=Math.floor(serverDayStart+ratio*86400000);if(cursorRef.current)cursorRef.current.style.left=ratio*100+\"%\";console.log(\"[Seek] ClickX: \".concat(x,\" Ratio: \").concat(ratio,\" -> TS: \").concat(seekTs,\" (\").concat(new Date(seekTs).toLocaleTimeString(),\")\"));// Find segment\nconst seg=timelineSegments.find(s=>s.ts<=seekTs&&s.ts+s.width*86400000>=seekTs)||timelineSegments.find(s=>s.ts>seekTs);console.log('SEGMENT SELECTAT',seg);play(seekTs);};const handleMainPlay=()=>{if(timelineSegments.length>0)play(timelineSegments[0].ts);else alert(\"Nu există înregistrări.\");};return/*#__PURE__*/_jsxs(\"div\",{className:\"playback-page\",children:[/*#__PURE__*/_jsx(\"style\",{children:styles}),/*#__PURE__*/_jsxs(\"div\",{className:\"hud\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"DEBUG V99 (ServerTime)\"}),/*#__PURE__*/_jsx(\"br\",{}),\"DayStart: \",debug.dayStart,\" (\",debug.dayStartStr,\")\",/*#__PURE__*/_jsx(\"br\",{}),\"Raw Segs: \",debug.rawCount,/*#__PURE__*/_jsx(\"br\",{}),\"Norm Segs: \",debug.normCount,/*#__PURE__*/_jsx(\"br\",{}),\"Sample Left: \",(_debug$firstNorm=debug.firstNorm)===null||_debug$firstNorm===void 0?void 0:(_debug$firstNorm$left=_debug$firstNorm.left)===null||_debug$firstNorm$left===void 0?void 0:_debug$firstNorm$left.toFixed(4),/*#__PURE__*/_jsx(\"br\",{}),\"(RED BAR = TEST SEGMENT 12:00-14:00)\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"playback-header\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.location.href='/',children:\"\\u2190 \\xCEnapoi\"}),/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:600},children:camId}),/*#__PURE__*/_jsxs(\"span\",{className:\"info-text\",children:[\"Intervale: \",timelineSegments.length,\" | Dat\\u0103: \",selectedDate]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"video-viewport\",children:/*#__PURE__*/_jsx(\"video\",{ref:videoRef,controls:true,autoPlay:true,muted:true,playsInline:true})}),/*#__PURE__*/_jsx(\"div\",{className:\"controls\",children:!isPlaying?/*#__PURE__*/_jsx(\"button\",{onClick:handleMainPlay,disabled:isLoading,children:isLoading?\"Încărcare...\":\"▶ REDĂ TOATE\"}):/*#__PURE__*/_jsx(\"button\",{onClick:stop,children:\"\\u25A0 OPRIRE\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"timeline-area\",ref:timelineRef,onClick:handleSeek,title:\"Click pentru a reda\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"time-markers\",children:Array.from({length:24},(_,i)=>i).map(h=>/*#__PURE__*/_jsx(\"div\",{className:\"time-marker\",children:h},h))}),/*#__PURE__*/_jsx(\"div\",{className:\"segments-track\",children:timelineSegments.map((s,i)=>/*#__PURE__*/_jsx(\"div\",{className:\"segment \".concat(s.isTest?'test-segment':''),style:{left:\"\".concat(s.left*100,\"%\"),width:\"\".concat(Math.max(s.width*100,0.2),\"%\"),background:s.isTest?'red':'#2ecc71'}},i))}),/*#__PURE__*/_jsx(\"div\",{ref:cursorRef,className:\"cursor\",style:{left:'0%'}})]})]});}","map":{"version":3,"names":["React","useEffect","useState","useRef","useCallback","useSearchParams","API","Hls","jsx","_jsx","jsxs","_jsxs","styles","Playback","_debug$firstNorm","_debug$firstNorm$left","params","camId","get","timelineSegments","setTimelineSegments","serverDayStart","setServerDayStart","debug","setDebug","selectedDate","setSelectedDate","d","Date","offset","getTimezoneOffset","local","getTime","toISOString","split","isPlaying","setIsPlaying","isLoading","setIsLoading","videoRef","hlsRef","cursorRef","timelineRef","console","log","concat","then","res","segments","raw","dayStart","data","DAY_MS","dayEnd","toLocaleString","testSeg","start_ts","end_ts","norm","map","e","start","Math","max","Number","end","min","left","width","ts","filter","Boolean","push","isTest","dayStartStr","rawCount","length","normCount","firstRaw","firstNorm","catch","error","waitForHls","url","retries","arguments","undefined","i","fetch","method","ok","_unused","Promise","r","setTimeout","play","startTime","alert","post","current","destroy","toLocaleTimeString","from","to","now","speed","hlsUrl","videoUrl","Error","isSupported","hls","loadSource","attachMedia","on","Events","MANIFEST_PARSED","canPlayType","src","stop","pause","removeAttribute","load","handleSeek","rect","getBoundingClientRect","x","clientX","ratio","seekTs","floor","style","seg","find","s","handleMainPlay","className","children","toFixed","onClick","window","location","href","fontWeight","ref","controls","autoPlay","muted","playsInline","disabled","title","Array","_","h","background"],"sources":["I:/dispecerat/github_release/dss-edge/local-ui/src/pages/Playback.js"],"sourcesContent":["import React, { useEffect, useState, useRef, useCallback } from \"react\";\r\nimport { useSearchParams } from \"react-router-dom\";\r\nimport API from \"../api\";\r\nimport Hls from 'hls.js';\r\n\r\nconst styles = `\r\n* { box-sizing: border-box; margin: 0; padding: 0; }\r\nbody { background: #cfd2d6; }\r\n.playback-page { height: 100vh; display: flex; flex-direction: column; background: #cfd2d6; font-family: Arial, sans-serif; }\r\n.playback-header { height: 40px; background: #d9d9d9; display: flex; align-items: center; padding: 0 10px; gap: 8px; border-bottom: 1px solid #999; }\r\n.video-viewport { height: calc(100vh - 140px); background: #000; display: flex; align-items: center; justify-content: center; position: relative; }\r\nvideo { width: 100%; height: 100%; object-fit: contain; background: #000; }\r\n.controls { height: 60px; background: #d9d9d9; display: flex; align-items: center; gap: 6px; padding: 0 8px; border-bottom: 1px solid #999; }\r\n.timeline-area { height: 80px; background: #e6e6e6; border-top: 1px solid #999; position: relative; overflow: hidden; cursor: crosshair; user-select: none; z-index: 10; }\r\n.time-markers { position: absolute; top: 0; left: 0; width: 100%; height: 20px; display: flex; pointer-events: none; border-bottom: 1px solid #ccc; }\r\n.time-marker { flex: 1; border-left: 1px solid #999; font-size: 10px; color: #555; padding-left: 2px; height: 100%; }\r\n.segments-track { position: absolute; top: 25px; height: 30px; left: 0; right: 0; background: rgba(0,0,0,0.05); pointer-events: none; }\r\n.segment { position: absolute; height: 100%; background: #2ecc71; opacity: 0.8; }\r\n.test-segment { position: absolute; height: 100%; background: red; opacity: 0.8; top: 0; z-index: 5; }\r\n.cursor { position: absolute; top: 0; height: 100%; width: 2px; background: red; z-index: 10; pointer-events: none; }\r\nbutton { padding: 4px 10px; border: 1px solid #555; background: #f0f0f0; cursor: pointer; font-size: 13px; }\r\nbutton:hover { background: #fff; }\r\nbutton:disabled { color: #aaa; cursor: not-allowed; }\r\n.info-text { font-size: 11px; color: #555; margin-left: 10px; }\r\n.hud { position: absolute; top: 10px; right: 10px; background: black; color: lime; padding: 5px; font-size: 10px; z-index: 1000; pointer-events: none; }\r\n`;\r\n\r\nexport default function Playback() {\r\n    const [params] = useSearchParams();\r\n    const camId = params.get(\"camId\");\r\n\r\n    const [timelineSegments, setTimelineSegments] = useState([]);\r\n    const [serverDayStart, setServerDayStart] = useState(0);\r\n    const [debug, setDebug] = useState({});\r\n\r\n    const [selectedDate, setSelectedDate] = useState(() => {\r\n        const d = new Date();\r\n        const offset = d.getTimezoneOffset() * 60000;\r\n        const local = new Date(d.getTime() - offset);\r\n        return local.toISOString().split('T')[0];\r\n    });\r\n\r\n    const [isPlaying, setIsPlaying] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n\r\n    const videoRef = useRef(null);\r\n    const hlsRef = useRef(null);\r\n    const cursorRef = useRef(null);\r\n    const timelineRef = useRef(null);\r\n\r\n    // FETCH TIMELINE\r\n    useEffect(() => {\r\n        if (!camId || !selectedDate) return;\r\n\r\n        console.log(`[Timeline] Fetching FULL DAY: ${selectedDate}`);\r\n\r\n        API.get(`/playback/timeline-day/${camId}/${selectedDate}`)\r\n            .then(res => {\r\n                const { segments: raw, dayStart } = res.data;\r\n                setServerDayStart(dayStart);\r\n\r\n                const DAY_MS = 86400000;\r\n                const dayEnd = dayStart + DAY_MS;\r\n\r\n                console.log('UI serverNowMs (DayStart)', dayStart, new Date(dayStart).toLocaleString());\r\n\r\n                // FORCE TEST SEGMENT: 12:00-14:00 (50% - 58%)\r\n                const testSeg = {\r\n                    start_ts: dayStart + (12 * 3600 * 1000), // 12:00\r\n                    end_ts: dayStart + (14 * 3600 * 1000)    // 14:00\r\n                };\r\n\r\n                // NORMALIZE\r\n                const norm = raw.map(e => {\r\n                    const start = Math.max(Number(e.start_ts), dayStart);\r\n                    const end = Math.min(Number(e.end_ts), dayEnd);\r\n                    if (end <= start) return null;\r\n                    return {\r\n                        left: (start - dayStart) / DAY_MS,\r\n                        width: (end - start) / DAY_MS,\r\n                        ts: Number(e.start_ts) // Original start\r\n                    };\r\n                }).filter(Boolean);\r\n\r\n                // Add TEST segment to norm for rendering check\r\n                norm.push({\r\n                    left: 0.5, // 12:00\r\n                    width: 0.083, // 2h\r\n                    ts: testSeg.start_ts,\r\n                    isTest: true\r\n                });\r\n\r\n                setTimelineSegments(norm);\r\n\r\n                setDebug({\r\n                    dayStart,\r\n                    dayStartStr: new Date(dayStart).toLocaleString(),\r\n                    rawCount: raw.length,\r\n                    normCount: norm.length,\r\n                    firstRaw: raw[0],\r\n                    firstNorm: norm[0]\r\n                });\r\n            })\r\n            .catch(e => console.error(e));\r\n    }, [camId, selectedDate]);\r\n\r\n    // HLS Helper\r\n    const waitForHls = async (url, retries = 50) => {\r\n        for (let i = 0; i < retries; i++) {\r\n            try {\r\n                const res = await fetch(url, { method: 'HEAD' });\r\n                if (res.ok) return true;\r\n            } catch { /* ignore */ }\r\n            await new Promise(r => setTimeout(r, 200));\r\n        }\r\n        return false;\r\n    };\r\n\r\n    const play = useCallback(async (startTime) => {\r\n        if (!startTime) return alert(\"Selectează un moment pe timeline\");\r\n        setIsLoading(true);\r\n        try {\r\n            try {\r\n                API.post('/playback/stop', { camId });\r\n                if (hlsRef.current) { hlsRef.current.destroy(); hlsRef.current = null; }\r\n            } catch (e) { }\r\n\r\n            console.log(`[Playback] REQUEST TS: ${startTime} (${new Date(startTime).toLocaleTimeString()})`);\r\n\r\n            const res = await API.post('/playback/start', {\r\n                camId,\r\n                from: startTime,\r\n                to: Date.now(),\r\n                speed: 1\r\n            });\r\n\r\n            const hlsUrl = `http://192.168.120.208:8080${res.data.hlsUrl}`;\r\n            const videoUrl = `${hlsUrl}?t=${Date.now()}`;\r\n\r\n            if (!await waitForHls(hlsUrl)) throw new Error(\"HLS Timeout\");\r\n\r\n            if (Hls.isSupported()) {\r\n                const hls = new Hls();\r\n                hls.loadSource(videoUrl);\r\n                hls.attachMedia(videoRef.current);\r\n                hls.on(Hls.Events.MANIFEST_PARSED, () => videoRef.current.play().catch(console.error));\r\n                hlsRef.current = hls;\r\n            } else if (videoRef.current.canPlayType('application/vnd.apple.mpegurl')) {\r\n                videoRef.current.src = videoUrl;\r\n                videoRef.current.play();\r\n            }\r\n            setIsPlaying(true);\r\n        } catch (e) {\r\n            console.error(e);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    }, [camId]);\r\n\r\n    const stop = async () => {\r\n        try {\r\n            API.post('/playback/stop', { camId });\r\n            if (hlsRef.current) { hlsRef.current.destroy(); hlsRef.current = null; }\r\n            if (videoRef.current) {\r\n                videoRef.current.pause();\r\n                videoRef.current.removeAttribute('src');\r\n                videoRef.current.load();\r\n            }\r\n            setIsPlaying(false);\r\n        } catch (e) { console.error(e); }\r\n    };\r\n\r\n    const handleSeek = (e) => {\r\n        if (!serverDayStart) return;\r\n        const rect = timelineRef.current.getBoundingClientRect();\r\n\r\n        const x = e.clientX - rect.left;\r\n        const width = rect.width;\r\n        const ratio = Math.max(0, Math.min(1, x / width));\r\n\r\n        const seekTs = Math.floor(serverDayStart + ratio * 86400000);\r\n\r\n        if (cursorRef.current) cursorRef.current.style.left = (ratio * 100) + \"%\";\r\n        console.log(`[Seek] ClickX: ${x} Ratio: ${ratio} -> TS: ${seekTs} (${new Date(seekTs).toLocaleTimeString()})`);\r\n\r\n        // Find segment\r\n        const seg = timelineSegments.find(s => s.ts <= seekTs && (s.ts + s.width * 86400000) >= seekTs)\r\n            || timelineSegments.find(s => s.ts > seekTs);\r\n        console.log('SEGMENT SELECTAT', seg);\r\n\r\n        play(seekTs);\r\n    };\r\n\r\n    const handleMainPlay = () => {\r\n        if (timelineSegments.length > 0) play(timelineSegments[0].ts);\r\n        else alert(\"Nu există înregistrări.\");\r\n    };\r\n\r\n    return (\r\n        <div className=\"playback-page\">\r\n            <style>{styles}</style>\r\n\r\n            {/* DEBUG HUD */}\r\n            <div className=\"hud\">\r\n                <b>DEBUG V99 (ServerTime)</b><br />\r\n                DayStart: {debug.dayStart} ({debug.dayStartStr})<br />\r\n                Raw Segs: {debug.rawCount}<br />\r\n                Norm Segs: {debug.normCount}<br />\r\n                Sample Left: {debug.firstNorm?.left?.toFixed(4)}<br />\r\n                (RED BAR = TEST SEGMENT 12:00-14:00)\r\n            </div>\r\n\r\n            <div className=\"playback-header\">\r\n                <button onClick={() => window.location.href = '/'}>← Înapoi</button>\r\n                <span style={{ fontWeight: 600 }}>{camId}</span>\r\n                <span className=\"info-text\">\r\n                    Intervale: {timelineSegments.length} | Dată: {selectedDate}\r\n                </span>\r\n            </div>\r\n\r\n            <div className=\"video-viewport\">\r\n                <video ref={videoRef} controls autoPlay muted playsInline />\r\n            </div>\r\n\r\n            <div className=\"controls\">\r\n                {!isPlaying ? (\r\n                    <button onClick={handleMainPlay} disabled={isLoading}>\r\n                        {isLoading ? \"Încărcare...\" : \"▶ REDĂ TOATE\"}\r\n                    </button>\r\n                ) : (\r\n                    <button onClick={stop}>■ OPRIRE</button>\r\n                )}\r\n            </div>\r\n\r\n            <div\r\n                className=\"timeline-area\"\r\n                ref={timelineRef}\r\n                onClick={handleSeek}\r\n                title=\"Click pentru a reda\"\r\n            >\r\n                <div className=\"time-markers\">\r\n                    {Array.from({ length: 24 }, (_, i) => i).map(h => <div key={h} className=\"time-marker\">{h}</div>)}\r\n                </div>\r\n\r\n                <div className=\"segments-track\">\r\n                    {timelineSegments.map((s, i) => (\r\n                        <div key={i} className={`segment ${s.isTest ? 'test-segment' : ''}`}\r\n                            style={{\r\n                                left: `${s.left * 100}%`,\r\n                                width: `${Math.max(s.width * 100, 0.2)}%`,\r\n                                background: s.isTest ? 'red' : '#2ecc71'\r\n                            }}\r\n                        />\r\n                    ))}\r\n                </div>\r\n\r\n                <div ref={cursorRef} className=\"cursor\" style={{ left: '0%' }} />\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}