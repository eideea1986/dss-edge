{"ast":null,"code":"var _jsxFileName = \"I:\\\\dispecerat\\\\github_release\\\\dss-edge\\\\local-ui\\\\src\\\\pages\\\\PlaybackModern.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef, useLayoutEffect } from \"react\";\nimport { useSearchParams, useNavigate } from \"react-router-dom\";\nimport API from \"../api\";\nimport PlaybackController, { PlayerStates } from \"../services/PlaybackController\";\nimport { ArrowLeft, Play, Pause, ChevronLeft, ChevronRight, ZoomIn, ZoomOut, Calendar, Monitor, Maximize } from \"../components/Icons\";\n\n// --- THEME ---\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst THEME = {\n  bg: \"#121212\",\n  panel: \"#1e1e1e\",\n  border: \"#333\",\n  accent: \"#007acc\",\n  text: \"#e0e0e0\",\n  textDim: \"#888\",\n  timelineTrack: \"#252525\",\n  segment: \"#4caf50\",\n  segmentBorder: \"#2e7d32\",\n  playhead: \"#ff1744\"\n};\nexport default function PlaybackModern() {\n  _s();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n  const camId = searchParams.get(\"camId\");\n\n  // --- STATE ---\n  const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0]);\n  const [playerState, setPlayerState] = useState(PlayerStates.IDLE);\n\n  // Timezone Support\n  const [serverTimezone, setServerTimezone] = useState(null);\n\n  // Timeline\n  const [currentTimeMs, setCurrentTimeMs] = useState(Date.now());\n  const [viewStartMs, setViewStartMs] = useState(new Date().setHours(0, 0, 0, 0));\n  const [zoomLevel, setZoomLevel] = useState(1);\n  const [zoomPxPerSec, setZoomPxPerSec] = useState(0.01);\n  const [containerWidth, setContainerWidth] = useState(1000);\n  const [segments, setSegments] = useState([]);\n  const [isLoadingData, setIsLoadingData] = useState(false);\n  const videoRef = useRef(null);\n  const playerRef = useRef(null);\n  const timelineRef = useRef(null);\n  const dragRef = useRef({\n    isDragging: false,\n    startX: 0,\n    startViewTime: 0\n  });\n\n  // --- 0. LOAD TIMEZONE ---\n  useEffect(() => {\n    API.get('/system/time').then(res => {\n      var _res$data, _res$data$raw;\n      if ((_res$data = res.data) !== null && _res$data !== void 0 && (_res$data$raw = _res$data.raw) !== null && _res$data$raw !== void 0 && _res$data$raw['Time zone']) {\n        const tz = res.data.raw['Time zone'].split(' ')[0];\n        setServerTimezone(tz);\n        console.log(\"[Playback] Using Server Timezone:\", tz);\n      }\n    }).catch(err => console.warn(\"Failed to get server timezone\", err));\n  }, []);\n  useEffect(() => {\n    if (selectedDate) {\n      const startOfDay = new Date(selectedDate).setHours(0, 0, 0, 0);\n      setViewStartMs(startOfDay);\n    }\n  }, [selectedDate, serverTimezone]);\n\n  // --- 1. INITIALIZE CONTROLLER (Uses FSM Internally) ---\n  useEffect(() => {\n    if (videoRef.current && camId) {\n      console.log(\"[Playback] Init Controller:\", camId);\n      playerRef.current = new PlaybackController(videoRef.current, camId, (s, payload) => {\n        setPlayerState(s);\n      });\n      return () => {\n        var _playerRef$current;\n        return (_playerRef$current = playerRef.current) === null || _playerRef$current === void 0 ? void 0 : _playerRef$current.destroy();\n      };\n    }\n  }, [camId]);\n\n  // --- 2. LAYOUT & RESIZE ---\n  useLayoutEffect(() => {\n    const updateWidth = () => {\n      if (timelineRef.current) setContainerWidth(timelineRef.current.clientWidth);\n    };\n    window.addEventListener('resize', updateWidth);\n    updateWidth();\n    return () => window.removeEventListener('resize', updateWidth);\n  }, []);\n\n  // --- 3. LOAD DATA ---\n  useEffect(() => {\n    if (!camId || !selectedDate) return;\n    const fetchData = async () => {\n      setIsLoadingData(true);\n      try {\n        const res = await API.get(`/api/playback/timeline-day/${camId}/${selectedDate}`);\n        const data = res.data;\n        const segs = (data.segments || []).map(s => ({\n          start: Number(s.start_ts || s.startTs),\n          end: Number(s.end_ts || s.endTs),\n          file: s.file\n        })).sort((a, b) => a.start - b.start);\n        console.log(`[Playback] Loaded ${segs.length} segments.`);\n        setSegments(segs);\n        if (playerRef.current) playerRef.current.loadSegments(segs);\n\n        // Auto-fit Day\n        if (containerWidth > 0) {\n          const s = new Date(selectedDate).setHours(0, 0, 0, 0);\n          setViewStartMs(s);\n          setZoomPxPerSec(containerWidth / 86400);\n        }\n      } catch (e) {\n        console.error(\"Timeline Load Error:\", e);\n      } finally {\n        setIsLoadingData(false);\n      }\n    };\n    fetchData();\n  }, [camId, selectedDate]);\n\n  // --- 4. PLAYER SYNC ---\n  useEffect(() => {\n    const i = setInterval(() => {\n      if (playerState === PlayerStates.PLAYING && playerRef.current) {\n        const now = playerRef.current.getCurrentTime();\n        if (Math.abs(now - currentTimeMs) > 200) setCurrentTimeMs(now);\n      }\n    }, 100);\n    return () => clearInterval(i);\n  }, [playerState, currentTimeMs]);\n\n  // --- 5. HELPERS ---\n  const fitDay = () => {\n    const s = new Date(selectedDate).setHours(0, 0, 0, 0);\n    setViewStartMs(s);\n    setZoomPxPerSec(containerWidth / 86400);\n    setZoomLevel(0);\n  };\n  const zoomIn = () => {\n    const newZoom = Math.min(200, zoomPxPerSec * 2);\n    const centerTime = viewStartMs + containerWidth / 2 / zoomPxPerSec * 1000;\n    setZoomPxPerSec(newZoom);\n    setViewStartMs(centerTime - containerWidth / 2 / newZoom * 1000);\n  };\n  const zoomOut = () => {\n    const newZoom = Math.max(containerWidth / 86400, zoomPxPerSec / 2);\n    const centerTime = viewStartMs + containerWidth / 2 / zoomPxPerSec * 1000;\n    setZoomPxPerSec(newZoom);\n    setViewStartMs(centerTime - containerWidth / 2 / newZoom * 1000);\n  };\n  const performSeek = ts => {\n    var _playerRef$current2;\n    setCurrentTimeMs(ts);\n    (_playerRef$current2 = playerRef.current) === null || _playerRef$current2 === void 0 ? void 0 : _playerRef$current2.seekTo(ts);\n  };\n\n  // --- 6. MOUSE EVENTS ---\n  const handleMouseDown = e => {\n    dragRef.current = {\n      isDragging: true,\n      startX: e.clientX,\n      startView: viewStartMs\n    };\n    document.body.style.cursor = 'grabbing';\n  };\n  const handleMouseMove = e => {\n    if (!dragRef.current.isDragging) return;\n    const dx = dragRef.current.startX - e.clientX;\n    const dt = dx / zoomPxPerSec * 1000;\n    setViewStartMs(dragRef.current.startView + dt);\n  };\n  const handleMouseUp = e => {\n    if (dragRef.current.isDragging) {\n      dragRef.current.isDragging = false;\n      document.body.style.cursor = 'default';\n      if (Math.abs(e.clientX - dragRef.current.startX) < 5) {\n        const rect = timelineRef.current.getBoundingClientRect();\n        const x = e.clientX - rect.left;\n        const ts = viewStartMs + x / zoomPxPerSec * 1000;\n        performSeek(ts);\n      }\n    }\n  };\n  const handleWheel = e => {\n    if (e.target.closest('.timeline-area')) {\n      e.preventDefault();\n      const rect = timelineRef.current.getBoundingClientRect();\n      const mouseX = e.clientX - rect.left;\n      const mouseTime = viewStartMs + mouseX / zoomPxPerSec * 1000;\n      const factor = e.deltaY > 0 ? 0.9 : 1.1;\n      const newZoom = Math.max(containerWidth / 86400, Math.min(200, zoomPxPerSec * factor));\n      setZoomPxPerSec(newZoom);\n      setViewStartMs(mouseTime - mouseX / newZoom * 1000);\n    }\n  };\n\n  // --- RENDER TIMELINE CANVAS ---\n  const timeToPx = t => (t - viewStartMs) / 1000 * zoomPxPerSec;\n  const renderTicks = () => {\n    const ticks = [];\n    const pxPerMin = zoomPxPerSec * 60;\n    let stepMin = 60 * 24;\n    if (pxPerMin > 1000) stepMin = 1;else if (pxPerMin > 200) stepMin = 5;else if (pxPerMin > 50) stepMin = 15;else if (pxPerMin > 10) stepMin = 60;else if (pxPerMin > 2) stepMin = 240;\n    const stepMs = stepMin * 60 * 1000;\n    if (stepMs <= 0) return [];\n    const start = Math.floor(viewStartMs / stepMs) * stepMs;\n    const end = viewStartMs + containerWidth / zoomPxPerSec * 1000;\n    for (let t = start; t < end; t += stepMs) {\n      const x = timeToPx(t);\n      const date = new Date(t);\n      const isHour = date.getMinutes() === 0;\n      ticks.push(/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'absolute',\n          left: x,\n          top: 0,\n          bottom: 0,\n          borderLeft: `1px solid ${isHour ? '#666' : '#333'}`,\n          pointerEvents: 'none'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: 'absolute',\n            bottom: 4,\n            left: 4,\n            fontSize: 10,\n            color: isHour ? '#eee' : '#777',\n            fontFamily: 'monospace'\n          },\n          children: date.toLocaleTimeString([], {\n            hour: '2-digit',\n            minute: '2-digit'\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 21\n        }, this)\n      }, t, false, {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 17\n      }, this));\n    }\n    return ticks;\n  };\n  const renderSegments = () => {\n    const visEnd = viewStartMs + containerWidth / zoomPxPerSec * 1000;\n    return segments.map((s, i) => {\n      if (s.end < viewStartMs || s.start > visEnd) return null;\n      const x = timeToPx(s.start);\n      const w = Math.max(2, (s.end - s.start) / 1000 * zoomPxPerSec);\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        title: new Date(s.start).toLocaleTimeString(),\n        style: {\n          position: 'absolute',\n          left: x,\n          width: w,\n          top: 20,\n          height: 40,\n          background: THEME.segment,\n          border: `1px solid ${THEME.segmentBorder}`,\n          borderRadius: 2,\n          opacity: 0.9\n        }\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 17\n      }, this);\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'column',\n      height: '100vh',\n      background: THEME.bg,\n      color: THEME.text,\n      fontFamily: 'Segoe UI, sans-serif'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      style: {\n        height: 50,\n        background: THEME.panel,\n        borderBottom: `1px solid ${THEME.border}`,\n        display: 'flex',\n        alignItems: 'center',\n        padding: '0 16px',\n        gap: 16\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate('/'),\n        style: {\n          background: 'none',\n          border: `1px solid ${THEME.border}`,\n          color: THEME.text,\n          padding: '6px 12px',\n          borderRadius: 4,\n          cursor: 'pointer',\n          fontSize: 13\n        },\n        children: \"\\u2190 LIVE\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontWeight: 600,\n          fontSize: 16\n        },\n        children: \"PLAYBACK\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: 1,\n          height: 20,\n          background: THEME.border\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => {\n          var _playerRef$current3;\n          return (_playerRef$current3 = playerRef.current) === null || _playerRef$current3 === void 0 ? void 0 : _playerRef$current3.seekTo(currentTimeMs - 10000);\n        },\n        style: {\n          ...btnStyle\n        },\n        children: \"\\u23EA -10s\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => {\n          var _playerRef$current4, _playerRef$current5;\n          return playerState === PlayerStates.PLAYING ? (_playerRef$current4 = playerRef.current) === null || _playerRef$current4 === void 0 ? void 0 : _playerRef$current4.pause() : (_playerRef$current5 = playerRef.current) === null || _playerRef$current5 === void 0 ? void 0 : _playerRef$current5.play();\n        },\n        style: {\n          ...btnStyle,\n          background: THEME.accent,\n          border: 'none',\n          color: '#fff',\n          fontWeight: 'bold'\n        },\n        children: playerState === PlayerStates.PLAYING ? \"PAUSE\" : \"PLAY\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => {\n          var _playerRef$current6;\n          return (_playerRef$current6 = playerRef.current) === null || _playerRef$current6 === void 0 ? void 0 : _playerRef$current6.seekTo(currentTimeMs + 10000);\n        },\n        style: {\n          ...btnStyle\n        },\n        children: \"\\u23E9 +10s\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flex: 1\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 17\n      }, this), serverTimezone && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontSize: 11,\n          color: '#666',\n          marginRight: 10\n        },\n        children: [\"TZ: \", serverTimezone]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 36\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          gap: 8,\n          background: '#000',\n          padding: '4px 8px',\n          borderRadius: 4,\n          border: `1px solid ${THEME.border}`\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            fontSize: 12,\n            color: THEME.textDim\n          },\n          children: \"DATE\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"date\",\n          value: selectedDate,\n          onChange: e => setSelectedDate(e.target.value),\n          style: {\n            background: 'transparent',\n            border: 'none',\n            color: '#fff',\n            fontFamily: 'inherit',\n            outline: 'none'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: 1,\n        background: '#000',\n        position: 'relative',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"video\", {\n        ref: videoRef,\n        style: {\n          width: '100%',\n          height: '100%'\n        },\n        onClick: () => {\n          var _playerRef$current7;\n          return (_playerRef$current7 = playerRef.current) === null || _playerRef$current7 === void 0 ? void 0 : _playerRef$current7.play();\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 17\n      }, this), isLoadingData && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: overlayStyle,\n        children: \"Loading Timeline...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 35\n      }, this), playerState === PlayerStates.BUFFERING && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: overlayStyle,\n        children: \"Buffering...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 60\n      }, this), !isLoadingData && segments.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...overlayStyle,\n          top: '40%'\n        },\n        children: \"No Recordings Found\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 61\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'absolute',\n          top: 16,\n          right: 16,\n          background: 'rgba(0,0,0,0.6)',\n          padding: '6px 12px',\n          borderRadius: 4,\n          fontFamily: 'monospace',\n          fontSize: 14,\n          color: '#0f0'\n        },\n        children: new Date(currentTimeMs).toLocaleTimeString()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"timeline-area\",\n      ref: timelineRef,\n      style: {\n        height: 120,\n        background: THEME.timelineTrack,\n        borderTop: `1px solid ${THEME.border}`,\n        position: 'relative',\n        overflow: 'hidden',\n        cursor: dragRef.current.isDragging ? 'grabbing' : 'grab'\n      },\n      onMouseUp: handleMouseUp,\n      onMouseLeave: handleMouseUp,\n      onMouseMove: handleMouseMove,\n      onMouseDown: handleMouseDown,\n      onWheel: handleWheel,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'absolute',\n          top: 4,\n          right: 10,\n          zIndex: 20,\n          display: 'flex',\n          gap: 4\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: zoomOut,\n          style: btnSmall,\n          children: \"-\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: fitDay,\n          style: btnSmall,\n          children: \"FIT\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: zoomIn,\n          style: btnSmall,\n          children: \"+\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 17\n      }, this), renderTicks(), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          pointerEvents: 'none'\n        },\n        children: renderSegments()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'absolute',\n          left: timeToPx(currentTimeMs),\n          top: 0,\n          bottom: 0,\n          width: 2,\n          background: THEME.playhead,\n          zIndex: 10,\n          pointerEvents: 'none'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: 'absolute',\n            top: 0,\n            left: -6,\n            borderLeft: '7px solid transparent',\n            borderRight: '7px solid transparent',\n            borderTop: `8px solid ${THEME.playhead}`\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 253,\n    columnNumber: 9\n  }, this);\n}\n_s(PlaybackModern, \"Jf+DJlucctqoeptw8Xj5ZSGWMvc=\", false, function () {\n  return [useSearchParams, useNavigate];\n});\n_c = PlaybackModern;\nconst btnStyle = {\n  background: '#222',\n  border: '1px solid #444',\n  color: '#ddd',\n  padding: '6px 12px',\n  borderRadius: 4,\n  cursor: 'pointer',\n  fontSize: 12\n};\nconst btnSmall = {\n  background: '#333',\n  border: '1px solid #555',\n  color: '#fff',\n  width: 24,\n  height: 24,\n  padding: 0,\n  borderRadius: 2,\n  cursor: 'pointer',\n  fontSize: 10\n};\nconst overlayStyle = {\n  position: 'absolute',\n  background: 'rgba(0,0,0,0.7)',\n  color: '#fff',\n  padding: '10px 20px',\n  borderRadius: 8,\n  fontSize: 14,\n  fontWeight: 'bold'\n};\nvar _c;\n$RefreshReg$(_c, \"PlaybackModern\");","map":{"version":3,"names":["React","useEffect","useState","useRef","useLayoutEffect","useSearchParams","useNavigate","API","PlaybackController","PlayerStates","ArrowLeft","Play","Pause","ChevronLeft","ChevronRight","ZoomIn","ZoomOut","Calendar","Monitor","Maximize","jsxDEV","_jsxDEV","THEME","bg","panel","border","accent","text","textDim","timelineTrack","segment","segmentBorder","playhead","PlaybackModern","_s","searchParams","navigate","camId","get","selectedDate","setSelectedDate","Date","toISOString","split","playerState","setPlayerState","IDLE","serverTimezone","setServerTimezone","currentTimeMs","setCurrentTimeMs","now","viewStartMs","setViewStartMs","setHours","zoomLevel","setZoomLevel","zoomPxPerSec","setZoomPxPerSec","containerWidth","setContainerWidth","segments","setSegments","isLoadingData","setIsLoadingData","videoRef","playerRef","timelineRef","dragRef","isDragging","startX","startViewTime","then","res","_res$data","_res$data$raw","data","raw","tz","console","log","catch","err","warn","startOfDay","current","s","payload","_playerRef$current","destroy","updateWidth","clientWidth","window","addEventListener","removeEventListener","fetchData","segs","map","start","Number","start_ts","startTs","end","end_ts","endTs","file","sort","a","b","length","loadSegments","e","error","i","setInterval","PLAYING","getCurrentTime","Math","abs","clearInterval","fitDay","zoomIn","newZoom","min","centerTime","zoomOut","max","performSeek","ts","_playerRef$current2","seekTo","handleMouseDown","clientX","startView","document","body","style","cursor","handleMouseMove","dx","dt","handleMouseUp","rect","getBoundingClientRect","x","left","handleWheel","target","closest","preventDefault","mouseX","mouseTime","factor","deltaY","timeToPx","t","renderTicks","ticks","pxPerMin","stepMin","stepMs","floor","date","isHour","getMinutes","push","position","top","bottom","borderLeft","pointerEvents","children","fontSize","color","fontFamily","toLocaleTimeString","hour","minute","fileName","_jsxFileName","lineNumber","columnNumber","renderSegments","visEnd","w","title","width","height","background","borderRadius","opacity","display","flexDirection","borderBottom","alignItems","padding","gap","onClick","fontWeight","_playerRef$current3","btnStyle","_playerRef$current4","_playerRef$current5","pause","play","_playerRef$current6","flex","marginRight","type","value","onChange","outline","justifyContent","ref","_playerRef$current7","overlayStyle","BUFFERING","right","className","borderTop","overflow","onMouseUp","onMouseLeave","onMouseMove","onMouseDown","onWheel","zIndex","btnSmall","borderRight","_c","$RefreshReg$"],"sources":["I:/dispecerat/github_release/dss-edge/local-ui/src/pages/PlaybackModern.js"],"sourcesContent":["import React, { useEffect, useState, useRef, useLayoutEffect } from \"react\";\r\nimport { useSearchParams, useNavigate } from \"react-router-dom\";\r\nimport API from \"../api\";\r\nimport PlaybackController, { PlayerStates } from \"../services/PlaybackController\";\r\nimport { ArrowLeft, Play, Pause, ChevronLeft, ChevronRight, ZoomIn, ZoomOut, Calendar, Monitor, Maximize } from \"../components/Icons\";\r\n\r\n// --- THEME ---\r\nconst THEME = {\r\n    bg: \"#121212\",\r\n    panel: \"#1e1e1e\",\r\n    border: \"#333\",\r\n    accent: \"#007acc\",\r\n    text: \"#e0e0e0\",\r\n    textDim: \"#888\",\r\n    timelineTrack: \"#252525\",\r\n    segment: \"#4caf50\",\r\n    segmentBorder: \"#2e7d32\",\r\n    playhead: \"#ff1744\"\r\n};\r\n\r\nexport default function PlaybackModern() {\r\n    const [searchParams] = useSearchParams();\r\n    const navigate = useNavigate();\r\n    const camId = searchParams.get(\"camId\");\r\n\r\n    // --- STATE ---\r\n    const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0]);\r\n    const [playerState, setPlayerState] = useState(PlayerStates.IDLE);\r\n\r\n    // Timezone Support\r\n    const [serverTimezone, setServerTimezone] = useState(null);\r\n\r\n    // Timeline\r\n    const [currentTimeMs, setCurrentTimeMs] = useState(Date.now());\r\n    const [viewStartMs, setViewStartMs] = useState(new Date().setHours(0, 0, 0, 0));\r\n    const [zoomLevel, setZoomLevel] = useState(1);\r\n    const [zoomPxPerSec, setZoomPxPerSec] = useState(0.01);\r\n    const [containerWidth, setContainerWidth] = useState(1000);\r\n    const [segments, setSegments] = useState([]);\r\n    const [isLoadingData, setIsLoadingData] = useState(false);\r\n\r\n    const videoRef = useRef(null);\r\n    const playerRef = useRef(null);\r\n    const timelineRef = useRef(null);\r\n    const dragRef = useRef({ isDragging: false, startX: 0, startViewTime: 0 });\r\n\r\n    // --- 0. LOAD TIMEZONE ---\r\n    useEffect(() => {\r\n        API.get('/system/time').then(res => {\r\n            if (res.data?.raw?.['Time zone']) {\r\n                const tz = res.data.raw['Time zone'].split(' ')[0];\r\n                setServerTimezone(tz);\r\n                console.log(\"[Playback] Using Server Timezone:\", tz);\r\n            }\r\n        }).catch(err => console.warn(\"Failed to get server timezone\", err));\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (selectedDate) {\r\n            const startOfDay = new Date(selectedDate).setHours(0, 0, 0, 0);\r\n            setViewStartMs(startOfDay);\r\n        }\r\n    }, [selectedDate, serverTimezone]);\r\n\r\n    // --- 1. INITIALIZE CONTROLLER (Uses FSM Internally) ---\r\n    useEffect(() => {\r\n        if (videoRef.current && camId) {\r\n            console.log(\"[Playback] Init Controller:\", camId);\r\n            playerRef.current = new PlaybackController(videoRef.current, camId, (s, payload) => {\r\n                setPlayerState(s);\r\n            });\r\n            return () => playerRef.current?.destroy();\r\n        }\r\n    }, [camId]);\r\n\r\n    // --- 2. LAYOUT & RESIZE ---\r\n    useLayoutEffect(() => {\r\n        const updateWidth = () => {\r\n            if (timelineRef.current) setContainerWidth(timelineRef.current.clientWidth);\r\n        };\r\n        window.addEventListener('resize', updateWidth);\r\n        updateWidth();\r\n        return () => window.removeEventListener('resize', updateWidth);\r\n    }, []);\r\n\r\n    // --- 3. LOAD DATA ---\r\n    useEffect(() => {\r\n        if (!camId || !selectedDate) return;\r\n\r\n        const fetchData = async () => {\r\n            setIsLoadingData(true);\r\n            try {\r\n                const res = await API.get(`/api/playback/timeline-day/${camId}/${selectedDate}`);\r\n                const data = res.data;\r\n                const segs = (data.segments || []).map(s => ({\r\n                    start: Number(s.start_ts || s.startTs),\r\n                    end: Number(s.end_ts || s.endTs),\r\n                    file: s.file\r\n                })).sort((a, b) => a.start - b.start);\r\n\r\n                console.log(`[Playback] Loaded ${segs.length} segments.`);\r\n                setSegments(segs);\r\n                if (playerRef.current) playerRef.current.loadSegments(segs);\r\n\r\n                // Auto-fit Day\r\n                if (containerWidth > 0) {\r\n                    const s = new Date(selectedDate).setHours(0, 0, 0, 0);\r\n                    setViewStartMs(s);\r\n                    setZoomPxPerSec(containerWidth / 86400);\r\n                }\r\n\r\n            } catch (e) {\r\n                console.error(\"Timeline Load Error:\", e);\r\n            } finally {\r\n                setIsLoadingData(false);\r\n            }\r\n        };\r\n        fetchData();\r\n    }, [camId, selectedDate]);\r\n\r\n    // --- 4. PLAYER SYNC ---\r\n    useEffect(() => {\r\n        const i = setInterval(() => {\r\n            if (playerState === PlayerStates.PLAYING && playerRef.current) {\r\n                const now = playerRef.current.getCurrentTime();\r\n                if (Math.abs(now - currentTimeMs) > 200) setCurrentTimeMs(now);\r\n            }\r\n        }, 100);\r\n        return () => clearInterval(i);\r\n    }, [playerState, currentTimeMs]);\r\n\r\n    // --- 5. HELPERS ---\r\n    const fitDay = () => {\r\n        const s = new Date(selectedDate).setHours(0, 0, 0, 0);\r\n        setViewStartMs(s);\r\n        setZoomPxPerSec(containerWidth / 86400);\r\n        setZoomLevel(0);\r\n    };\r\n\r\n    const zoomIn = () => {\r\n        const newZoom = Math.min(200, zoomPxPerSec * 2);\r\n        const centerTime = viewStartMs + ((containerWidth / 2) / zoomPxPerSec) * 1000;\r\n        setZoomPxPerSec(newZoom);\r\n        setViewStartMs(centerTime - ((containerWidth / 2) / newZoom) * 1000);\r\n    };\r\n\r\n    const zoomOut = () => {\r\n        const newZoom = Math.max(containerWidth / 86400, zoomPxPerSec / 2);\r\n        const centerTime = viewStartMs + ((containerWidth / 2) / zoomPxPerSec) * 1000;\r\n        setZoomPxPerSec(newZoom);\r\n        setViewStartMs(centerTime - ((containerWidth / 2) / newZoom) * 1000);\r\n    };\r\n\r\n    const performSeek = (ts) => {\r\n        setCurrentTimeMs(ts);\r\n        playerRef.current?.seekTo(ts);\r\n    };\r\n\r\n    // --- 6. MOUSE EVENTS ---\r\n    const handleMouseDown = (e) => {\r\n        dragRef.current = { isDragging: true, startX: e.clientX, startView: viewStartMs };\r\n        document.body.style.cursor = 'grabbing';\r\n    };\r\n    const handleMouseMove = (e) => {\r\n        if (!dragRef.current.isDragging) return;\r\n        const dx = dragRef.current.startX - e.clientX;\r\n        const dt = (dx / zoomPxPerSec) * 1000;\r\n        setViewStartMs(dragRef.current.startView + dt);\r\n    };\r\n    const handleMouseUp = (e) => {\r\n        if (dragRef.current.isDragging) {\r\n            dragRef.current.isDragging = false;\r\n            document.body.style.cursor = 'default';\r\n            if (Math.abs(e.clientX - dragRef.current.startX) < 5) {\r\n                const rect = timelineRef.current.getBoundingClientRect();\r\n                const x = e.clientX - rect.left;\r\n                const ts = viewStartMs + (x / zoomPxPerSec) * 1000;\r\n                performSeek(ts);\r\n            }\r\n        }\r\n    };\r\n    const handleWheel = (e) => {\r\n        if (e.target.closest('.timeline-area')) {\r\n            e.preventDefault();\r\n            const rect = timelineRef.current.getBoundingClientRect();\r\n            const mouseX = e.clientX - rect.left;\r\n            const mouseTime = viewStartMs + (mouseX / zoomPxPerSec) * 1000;\r\n\r\n            const factor = e.deltaY > 0 ? 0.9 : 1.1;\r\n            const newZoom = Math.max(containerWidth / 86400, Math.min(200, zoomPxPerSec * factor));\r\n\r\n            setZoomPxPerSec(newZoom);\r\n            setViewStartMs(mouseTime - (mouseX / newZoom) * 1000);\r\n        }\r\n    };\r\n\r\n    // --- RENDER TIMELINE CANVAS ---\r\n    const timeToPx = (t) => (t - viewStartMs) / 1000 * zoomPxPerSec;\r\n\r\n    const renderTicks = () => {\r\n        const ticks = [];\r\n        const pxPerMin = zoomPxPerSec * 60;\r\n        let stepMin = 60 * 24;\r\n        if (pxPerMin > 1000) stepMin = 1;\r\n        else if (pxPerMin > 200) stepMin = 5;\r\n        else if (pxPerMin > 50) stepMin = 15;\r\n        else if (pxPerMin > 10) stepMin = 60;\r\n        else if (pxPerMin > 2) stepMin = 240;\r\n\r\n        const stepMs = stepMin * 60 * 1000;\r\n        if (stepMs <= 0) return [];\r\n\r\n        const start = Math.floor(viewStartMs / stepMs) * stepMs;\r\n        const end = viewStartMs + (containerWidth / zoomPxPerSec * 1000);\r\n\r\n        for (let t = start; t < end; t += stepMs) {\r\n            const x = timeToPx(t);\r\n            const date = new Date(t);\r\n            const isHour = date.getMinutes() === 0;\r\n            ticks.push(\r\n                <div key={t} style={{ position: 'absolute', left: x, top: 0, bottom: 0, borderLeft: `1px solid ${isHour ? '#666' : '#333'}`, pointerEvents: 'none' }}>\r\n                    <div style={{ position: 'absolute', bottom: 4, left: 4, fontSize: 10, color: isHour ? '#eee' : '#777', fontFamily: 'monospace' }}>\r\n                        {date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\r\n                    </div>\r\n                </div>\r\n            );\r\n        }\r\n        return ticks;\r\n    };\r\n\r\n    const renderSegments = () => {\r\n        const visEnd = viewStartMs + (containerWidth / zoomPxPerSec * 1000);\r\n        return segments.map((s, i) => {\r\n            if (s.end < viewStartMs || s.start > visEnd) return null;\r\n            const x = timeToPx(s.start);\r\n            const w = Math.max(2, (s.end - s.start) / 1000 * zoomPxPerSec);\r\n            return (\r\n                <div key={i} title={new Date(s.start).toLocaleTimeString()}\r\n                    style={{\r\n                        position: 'absolute', left: x, width: w,\r\n                        top: 20, height: 40,\r\n                        background: THEME.segment,\r\n                        border: `1px solid ${THEME.segmentBorder}`,\r\n                        borderRadius: 2,\r\n                        opacity: 0.9\r\n                    }}\r\n                />\r\n            );\r\n        });\r\n    };\r\n\r\n    return (\r\n        <div style={{ display: 'flex', flexDirection: 'column', height: '100vh', background: THEME.bg, color: THEME.text, fontFamily: 'Segoe UI, sans-serif' }}>\r\n            {/* HEADER */}\r\n            <header style={{ height: 50, background: THEME.panel, borderBottom: `1px solid ${THEME.border}`, display: 'flex', alignItems: 'center', padding: '0 16px', gap: 16 }}>\r\n                <button onClick={() => navigate('/')} style={{ background: 'none', border: `1px solid ${THEME.border}`, color: THEME.text, padding: '6px 12px', borderRadius: 4, cursor: 'pointer', fontSize: 13 }}>\r\n                    ← LIVE\r\n                </button>\r\n                <div style={{ fontWeight: 600, fontSize: 16 }}>PLAYBACK</div>\r\n                <div style={{ width: 1, height: 20, background: THEME.border }} />\r\n\r\n                {/* TOOLBAR */}\r\n                <button onClick={() => playerRef.current?.seekTo(currentTimeMs - 10000)} style={{ ...btnStyle }}>⏪ -10s</button>\r\n                <button onClick={() => playerState === PlayerStates.PLAYING ? playerRef.current?.pause() : playerRef.current?.play()}\r\n                    style={{ ...btnStyle, background: THEME.accent, border: 'none', color: '#fff', fontWeight: 'bold' }}>\r\n                    {playerState === PlayerStates.PLAYING ? \"PAUSE\" : \"PLAY\"}\r\n                </button>\r\n                <button onClick={() => playerRef.current?.seekTo(currentTimeMs + 10000)} style={{ ...btnStyle }}>⏩ +10s</button>\r\n\r\n                <div style={{ flex: 1 }} />\r\n\r\n                {/* INFO */}\r\n                {serverTimezone && <div style={{ fontSize: 11, color: '#666', marginRight: 10 }}>TZ: {serverTimezone}</div>}\r\n\r\n                {/* DATE PICKER */}\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: 8, background: '#000', padding: '4px 8px', borderRadius: 4, border: `1px solid ${THEME.border}` }}>\r\n                    <span style={{ fontSize: 12, color: THEME.textDim }}>DATE</span>\r\n                    <input type=\"date\" value={selectedDate} onChange={e => setSelectedDate(e.target.value)}\r\n                        style={{ background: 'transparent', border: 'none', color: '#fff', fontFamily: 'inherit', outline: 'none' }} />\r\n                </div>\r\n            </header>\r\n\r\n            {/* VIDEO AREA */}\r\n            <div style={{ flex: 1, background: '#000', position: 'relative', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>\r\n                <video ref={videoRef} style={{ width: '100%', height: '100%' }} onClick={() => playerRef.current?.play()} />\r\n\r\n                {isLoadingData && <div style={overlayStyle}>Loading Timeline...</div>}\r\n                {playerState === PlayerStates.BUFFERING && <div style={overlayStyle}>Buffering...</div>}\r\n                {!isLoadingData && segments.length === 0 && <div style={{ ...overlayStyle, top: '40%' }}>No Recordings Found</div>}\r\n\r\n                <div style={{ position: 'absolute', top: 16, right: 16, background: 'rgba(0,0,0,0.6)', padding: '6px 12px', borderRadius: 4, fontFamily: 'monospace', fontSize: 14, color: '#0f0' }}>\r\n                    {new Date(currentTimeMs).toLocaleTimeString()}\r\n                </div>\r\n            </div>\r\n\r\n            {/* TIMELINE AREA */}\r\n            <div className=\"timeline-area\"\r\n                ref={timelineRef}\r\n                style={{ height: 120, background: THEME.timelineTrack, borderTop: `1px solid ${THEME.border}`, position: 'relative', overflow: 'hidden', cursor: dragRef.current.isDragging ? 'grabbing' : 'grab' }}\r\n                onMouseUp={handleMouseUp} onMouseLeave={handleMouseUp} onMouseMove={handleMouseMove} onMouseDown={handleMouseDown} onWheel={handleWheel}\r\n            >\r\n                <div style={{ position: 'absolute', top: 4, right: 10, zIndex: 20, display: 'flex', gap: 4 }}>\r\n                    <button onClick={zoomOut} style={btnSmall}>-</button>\r\n                    <button onClick={fitDay} style={btnSmall}>FIT</button>\r\n                    <button onClick={zoomIn} style={btnSmall}>+</button>\r\n                </div>\r\n\r\n                {renderTicks()}\r\n                <div style={{ position: 'absolute', top: 0, left: 0, right: 0, bottom: 0, pointerEvents: 'none' }}>\r\n                    {renderSegments()}\r\n                </div>\r\n\r\n                <div style={{ position: 'absolute', left: timeToPx(currentTimeMs), top: 0, bottom: 0, width: 2, background: THEME.playhead, zIndex: 10, pointerEvents: 'none' }}>\r\n                    <div style={{ position: 'absolute', top: 0, left: -6, borderLeft: '7px solid transparent', borderRight: '7px solid transparent', borderTop: `8px solid ${THEME.playhead}` }} />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nconst btnStyle = { background: '#222', border: '1px solid #444', color: '#ddd', padding: '6px 12px', borderRadius: 4, cursor: 'pointer', fontSize: 12 };\r\nconst btnSmall = { background: '#333', border: '1px solid #555', color: '#fff', width: 24, height: 24, padding: 0, borderRadius: 2, cursor: 'pointer', fontSize: 10 };\r\nconst overlayStyle = { position: 'absolute', background: 'rgba(0,0,0,0.7)', color: '#fff', padding: '10px 20px', borderRadius: 8, fontSize: 14, fontWeight: 'bold' };\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}