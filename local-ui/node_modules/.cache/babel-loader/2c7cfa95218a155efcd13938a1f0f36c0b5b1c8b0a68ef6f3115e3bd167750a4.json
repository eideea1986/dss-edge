{"ast":null,"code":"import _objectSpread from\"I:/dispecerat/github_release/dss-edge/local-ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState,useRef}from\"react\";import{useSearchParams}from\"react-router-dom\";import API from\"../api\";import Hls from'hls.js';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const styles=\"\\n* { box-sizing: border-box; margin: 0; padding: 0; }\\nbody { background: #cfd2d6; }\\n\\n.playback-page {\\n  height: 100vh;\\n  display: flex;\\n  flex-direction: column;\\n  background: #cfd2d6;\\n  font-family: Arial, sans-serif;\\n}\\n\\n.playback-header {\\n  height: 40px;\\n  background: #d9d9d9;\\n  display: flex;\\n  align-items: center;\\n  padding: 0 10px;\\n  gap: 8px;\\n  border-bottom: 1px solid #999;\\n}\\n\\n.video-viewport {\\n  height: calc(100vh - 140px);\\n  background: #000;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n}\\n\\nvideo {\\n  width: 100%;\\n  height: 100%;\\n  object-fit: contain;\\n  background: #000;\\n}\\n\\n.controls {\\n  height: 60px;\\n  background: #d9d9d9;\\n  display: flex;\\n  align-items: center;\\n  gap: 6px;\\n  padding: 0 8px;\\n  border-bottom: 1px solid #999;\\n}\\n\\n.timeline-area {\\n  height: 80px;\\n  background: #e6e6e6;\\n  border-top: 1px solid #999;\\n  position: relative;\\n  overflow: hidden;\\n  cursor: pointer;\\n}\\n\\n.segments-track {\\n  position: absolute;\\n  top: 20px;\\n  height: 40px;\\n  left: 0;\\n  right: 0;\\n  background: rgba(0,0,0,0.05); /* Track background */\\n}\\n\\n.segment {\\n  position: absolute;\\n  height: 100%;\\n  background: #2ecc71; /* Vivid Green */\\n  border-left: 1px solid rgba(255,255,255,0.2);\\n  min-width: 4px; /* Ensure visibility */\\n}\\n\\n.cursor {\\n  position: absolute;\\n  top: 0;\\n  height: 100%;\\n  width: 2px;\\n  background: red;\\n  z-index: 10;\\n  pointer-events: none;\\n}\\n\\nbutton {\\n  padding: 4px 10px;\\n  border: 1px solid #555;\\n  background: #f0f0f0;\\n  cursor: pointer;\\n  font-size: 13px;\\n}\\n\\nbutton:hover { background: #fff; }\\nbutton:active { background: #ddd; }\\n\\n.time-display {\\n  margin-left: auto;\\n  font-weight: bold;\\n}\\n\";export default function Playback(){const[params]=useSearchParams();const camId=params.get(\"camId\");const[rawSegments,setRawSegments]=useState([]);// Raw data from API\nconst[segments,setSegments]=useState([]);// Normalized for display\nconst[isPlaying,setIsPlaying]=useState(false);const[currentTime,setCurrentTime]=useState(\"00:00:00\");const[isLoading,setIsLoading]=useState(false);// Time Range State (Auto-scaled)\nconst[timeRange,setTimeRange]=useState({from:Date.now()-3600000,to:Date.now()});const videoRef=useRef(null);const hlsRef=useRef(null);const cursorRef=useRef(null);const timelineRef=useRef(null);// 1. Initial Load - Request big range (24h)\nuseEffect(()=>{if(!camId)return;const now=Date.now();const initialFrom=now-24*60*60*1000;console.log(\"Loading data...\");API.get(\"/playback/timeline/\".concat(camId,\"?from=\").concat(initialFrom,\"&to=\").concat(now)).then(res=>{const segs=res.data.segments||[];const valid=segs.filter(s=>s.start_ts>0).sort((a,b)=>a.start_ts-b.start_ts);setRawSegments(valid);if(valid.length>0){// AUTO-SCALE TIMELINE TO DATA\nconst minTs=valid[0].start_ts;const maxTs=valid[valid.length-1].end_ts||now;// Add 10% padding for context\nconst duration=maxTs-minTs;const paddedFrom=minTs-duration*0.05;const paddedTo=maxTs+duration*0.05;console.log(\"Auto-Scaling Timeline: \".concat(new Date(paddedFrom).toLocaleTimeString(),\" -> \").concat(new Date(paddedTo).toLocaleTimeString()));setTimeRange({from:paddedFrom,to:paddedTo});}}).catch(e=>console.error(\"Timeline error:\",e));},[camId]);// 2. Normalize Segments when Range or Data changes\nuseEffect(()=>{if(rawSegments.length===0)return;const span=timeRange.to-timeRange.from;if(span<=0)return;const normalized=rawSegments.map(s=>_objectSpread(_objectSpread({},s),{},{s:(s.start_ts-timeRange.from)/span,e:(s.end_ts-timeRange.from)/span}));setSegments(normalized);},[rawSegments,timeRange]);// Helper: Wait for HLS\nconst waitForHls=async function(url){let retries=arguments.length>1&&arguments[1]!==undefined?arguments[1]:30;for(let i=0;i<retries;i++){try{const res=await fetch(url,{method:'HEAD'});if(res.ok)return true;}catch(e){/* ignore */}await new Promise(r=>setTimeout(r,500));}return false;};const startPlayback=async()=>{if(rawSegments.length===0)return;setIsLoading(true);try{const res=await API.post('/playback/start',{camId,from:rawSegments[0].start_ts,to:rawSegments[rawSegments.length-1].end_ts||Date.now(),speed:1});const hlsUrl=\"http://192.168.120.208:8080\".concat(res.data.hlsUrl);if(!(await waitForHls(hlsUrl)))throw new Error(\"HLS Timeout\");if(Hls.isSupported()){if(hlsRef.current)hlsRef.current.destroy();const hls=new Hls();hls.loadSource(hlsUrl);hls.attachMedia(videoRef.current);hls.on(Hls.Events.MANIFEST_PARSED,()=>videoRef.current.play().catch(console.error));hlsRef.current=hls;}else if(videoRef.current.canPlayType('application/vnd.apple.mpegurl')){videoRef.current.src=hlsUrl;videoRef.current.play();}setIsPlaying(true);}catch(e){alert('Error: '+e.message);}finally{setIsLoading(false);}};const stopPlayback=async()=>{try{await API.post('/playback/stop',{camId});if(hlsRef.current)hlsRef.current.destroy();if(videoRef.current){videoRef.current.pause();videoRef.current.removeAttribute('src');videoRef.current.load();}setIsPlaying(false);}catch(e){console.error(e);}};// Update cursor & time\nuseEffect(()=>{const interval=setInterval(()=>{if(videoRef.current&&!videoRef.current.paused&&isPlaying){// Approximate visualization (since streaming is separate from timeline state)\n// In real app, we'd map stream time to absolute time.\n// For now, let's just show video time\nconst t=videoRef.current.currentTime;// Move cursor based on progress (simplification)\n}},200);return()=>clearInterval(interval);},[isPlaying]);return/*#__PURE__*/_jsxs(\"div\",{className:\"playback-page\",children:[/*#__PURE__*/_jsx(\"style\",{children:styles}),/*#__PURE__*/_jsxs(\"div\",{className:\"playback-header\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.location.href='/',children:\"\\u2190 \\xCEnapoi\"}),/*#__PURE__*/_jsxs(\"span\",{style:{fontWeight:600},children:[camId,\" - PLAYBACK\"]}),/*#__PURE__*/_jsxs(\"span\",{style:{fontSize:11,color:'#555',marginLeft:10},children:[rawSegments.length,\" segmente | \",new Date(timeRange.from).toLocaleTimeString(),\" - \",new Date(timeRange.to).toLocaleTimeString()]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"video-viewport\",children:/*#__PURE__*/_jsx(\"video\",{ref:videoRef,controls:true,autoPlay:true,muted:true,playsInline:true})}),/*#__PURE__*/_jsx(\"div\",{className:\"controls\",children:!isPlaying?/*#__PURE__*/_jsx(\"button\",{onClick:startPlayback,disabled:isLoading,children:isLoading?\"Încărcare...\":\"▶ REDĂ\"}):/*#__PURE__*/_jsx(\"button\",{onClick:stopPlayback,children:\"\\u25A0 OPRIRE\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"timeline-area\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"segments-track\",children:segments.map((seg,i)=>/*#__PURE__*/_jsx(\"div\",{className:\"segment\",style:{left:\"\".concat(seg.s*100,\"%\"),width:\"\".concat((seg.e-seg.s)*100,\"%\")}},i))}),/*#__PURE__*/_jsx(\"div\",{ref:cursorRef,className:\"cursor\",style:{left:'0%'}})]})]});}","map":{"version":3,"names":["React","useEffect","useState","useRef","useSearchParams","API","Hls","jsx","_jsx","jsxs","_jsxs","styles","Playback","params","camId","get","rawSegments","setRawSegments","segments","setSegments","isPlaying","setIsPlaying","currentTime","setCurrentTime","isLoading","setIsLoading","timeRange","setTimeRange","from","Date","now","to","videoRef","hlsRef","cursorRef","timelineRef","initialFrom","console","log","concat","then","res","segs","data","valid","filter","s","start_ts","sort","a","b","length","minTs","maxTs","end_ts","duration","paddedFrom","paddedTo","toLocaleTimeString","catch","e","error","span","normalized","map","_objectSpread","waitForHls","url","retries","arguments","undefined","i","fetch","method","ok","Promise","r","setTimeout","startPlayback","post","speed","hlsUrl","Error","isSupported","current","destroy","hls","loadSource","attachMedia","on","Events","MANIFEST_PARSED","play","canPlayType","src","alert","message","stopPlayback","pause","removeAttribute","load","interval","setInterval","paused","t","clearInterval","className","children","onClick","window","location","href","style","fontWeight","fontSize","color","marginLeft","ref","controls","autoPlay","muted","playsInline","disabled","seg","left","width"],"sources":["I:/dispecerat/github_release/dss-edge/local-ui/src/pages/Playback.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\r\nimport { useSearchParams } from \"react-router-dom\";\r\nimport API from \"../api\";\r\nimport Hls from 'hls.js';\r\n\r\nconst styles = `\r\n* { box-sizing: border-box; margin: 0; padding: 0; }\r\nbody { background: #cfd2d6; }\r\n\r\n.playback-page {\r\n  height: 100vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  background: #cfd2d6;\r\n  font-family: Arial, sans-serif;\r\n}\r\n\r\n.playback-header {\r\n  height: 40px;\r\n  background: #d9d9d9;\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 0 10px;\r\n  gap: 8px;\r\n  border-bottom: 1px solid #999;\r\n}\r\n\r\n.video-viewport {\r\n  height: calc(100vh - 140px);\r\n  background: #000;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\nvideo {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: contain;\r\n  background: #000;\r\n}\r\n\r\n.controls {\r\n  height: 60px;\r\n  background: #d9d9d9;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 6px;\r\n  padding: 0 8px;\r\n  border-bottom: 1px solid #999;\r\n}\r\n\r\n.timeline-area {\r\n  height: 80px;\r\n  background: #e6e6e6;\r\n  border-top: 1px solid #999;\r\n  position: relative;\r\n  overflow: hidden;\r\n  cursor: pointer;\r\n}\r\n\r\n.segments-track {\r\n  position: absolute;\r\n  top: 20px;\r\n  height: 40px;\r\n  left: 0;\r\n  right: 0;\r\n  background: rgba(0,0,0,0.05); /* Track background */\r\n}\r\n\r\n.segment {\r\n  position: absolute;\r\n  height: 100%;\r\n  background: #2ecc71; /* Vivid Green */\r\n  border-left: 1px solid rgba(255,255,255,0.2);\r\n  min-width: 4px; /* Ensure visibility */\r\n}\r\n\r\n.cursor {\r\n  position: absolute;\r\n  top: 0;\r\n  height: 100%;\r\n  width: 2px;\r\n  background: red;\r\n  z-index: 10;\r\n  pointer-events: none;\r\n}\r\n\r\nbutton {\r\n  padding: 4px 10px;\r\n  border: 1px solid #555;\r\n  background: #f0f0f0;\r\n  cursor: pointer;\r\n  font-size: 13px;\r\n}\r\n\r\nbutton:hover { background: #fff; }\r\nbutton:active { background: #ddd; }\r\n\r\n.time-display {\r\n  margin-left: auto;\r\n  font-weight: bold;\r\n}\r\n`;\r\n\r\nexport default function Playback() {\r\n    const [params] = useSearchParams();\r\n    const camId = params.get(\"camId\");\r\n\r\n    const [rawSegments, setRawSegments] = useState([]); // Raw data from API\r\n    const [segments, setSegments] = useState([]);       // Normalized for display\r\n    const [isPlaying, setIsPlaying] = useState(false);\r\n    const [currentTime, setCurrentTime] = useState(\"00:00:00\");\r\n    const [isLoading, setIsLoading] = useState(false);\r\n\r\n    // Time Range State (Auto-scaled)\r\n    const [timeRange, setTimeRange] = useState({ from: Date.now() - 3600000, to: Date.now() });\r\n\r\n    const videoRef = useRef(null);\r\n    const hlsRef = useRef(null);\r\n    const cursorRef = useRef(null);\r\n    const timelineRef = useRef(null);\r\n\r\n    // 1. Initial Load - Request big range (24h)\r\n    useEffect(() => {\r\n        if (!camId) return;\r\n\r\n        const now = Date.now();\r\n        const initialFrom = now - 24 * 60 * 60 * 1000;\r\n\r\n        console.log(\"Loading data...\");\r\n\r\n        API.get(`/playback/timeline/${camId}?from=${initialFrom}&to=${now}`)\r\n            .then(res => {\r\n                const segs = res.data.segments || [];\r\n                const valid = segs.filter(s => s.start_ts > 0).sort((a, b) => a.start_ts - b.start_ts);\r\n\r\n                setRawSegments(valid);\r\n\r\n                if (valid.length > 0) {\r\n                    // AUTO-SCALE TIMELINE TO DATA\r\n                    const minTs = valid[0].start_ts;\r\n                    const maxTs = valid[valid.length - 1].end_ts || now;\r\n\r\n                    // Add 10% padding for context\r\n                    const duration = maxTs - minTs;\r\n                    const paddedFrom = minTs - duration * 0.05;\r\n                    const paddedTo = maxTs + duration * 0.05;\r\n\r\n                    console.log(`Auto-Scaling Timeline: ${new Date(paddedFrom).toLocaleTimeString()} -> ${new Date(paddedTo).toLocaleTimeString()}`);\r\n                    setTimeRange({ from: paddedFrom, to: paddedTo });\r\n                }\r\n            })\r\n            .catch(e => console.error(\"Timeline error:\", e));\r\n    }, [camId]);\r\n\r\n    // 2. Normalize Segments when Range or Data changes\r\n    useEffect(() => {\r\n        if (rawSegments.length === 0) return;\r\n\r\n        const span = timeRange.to - timeRange.from;\r\n        if (span <= 0) return;\r\n\r\n        const normalized = rawSegments.map(s => ({\r\n            ...s,\r\n            s: (s.start_ts - timeRange.from) / span,\r\n            e: (s.end_ts - timeRange.from) / span\r\n        }));\r\n\r\n        setSegments(normalized);\r\n    }, [rawSegments, timeRange]);\r\n\r\n    // Helper: Wait for HLS\r\n    const waitForHls = async (url, retries = 30) => {\r\n        for (let i = 0; i < retries; i++) {\r\n            try {\r\n                const res = await fetch(url, { method: 'HEAD' });\r\n                if (res.ok) return true;\r\n            } catch (e) { /* ignore */ }\r\n            await new Promise(r => setTimeout(r, 500));\r\n        }\r\n        return false;\r\n    };\r\n\r\n    const startPlayback = async () => {\r\n        if (rawSegments.length === 0) return;\r\n\r\n        setIsLoading(true);\r\n        try {\r\n            const res = await API.post('/playback/start', {\r\n                camId,\r\n                from: rawSegments[0].start_ts,\r\n                to: rawSegments[rawSegments.length - 1].end_ts || Date.now(),\r\n                speed: 1\r\n            });\r\n\r\n            const hlsUrl = `http://192.168.120.208:8080${res.data.hlsUrl}`;\r\n\r\n            if (!await waitForHls(hlsUrl)) throw new Error(\"HLS Timeout\");\r\n\r\n            if (Hls.isSupported()) {\r\n                if (hlsRef.current) hlsRef.current.destroy();\r\n                const hls = new Hls();\r\n                hls.loadSource(hlsUrl);\r\n                hls.attachMedia(videoRef.current);\r\n                hls.on(Hls.Events.MANIFEST_PARSED, () => videoRef.current.play().catch(console.error));\r\n                hlsRef.current = hls;\r\n            } else if (videoRef.current.canPlayType('application/vnd.apple.mpegurl')) {\r\n                videoRef.current.src = hlsUrl;\r\n                videoRef.current.play();\r\n            }\r\n\r\n            setIsPlaying(true);\r\n        } catch (e) {\r\n            alert('Error: ' + e.message);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const stopPlayback = async () => {\r\n        try {\r\n            await API.post('/playback/stop', { camId });\r\n            if (hlsRef.current) hlsRef.current.destroy();\r\n            if (videoRef.current) {\r\n                videoRef.current.pause();\r\n                videoRef.current.removeAttribute('src');\r\n                videoRef.current.load();\r\n            }\r\n            setIsPlaying(false);\r\n        } catch (e) { console.error(e); }\r\n    };\r\n\r\n    // Update cursor & time\r\n    useEffect(() => {\r\n        const interval = setInterval(() => {\r\n            if (videoRef.current && !videoRef.current.paused && isPlaying) {\r\n                // Approximate visualization (since streaming is separate from timeline state)\r\n                // In real app, we'd map stream time to absolute time.\r\n                // For now, let's just show video time\r\n                const t = videoRef.current.currentTime;\r\n                // Move cursor based on progress (simplification)\r\n            }\r\n        }, 200);\r\n        return () => clearInterval(interval);\r\n    }, [isPlaying]);\r\n\r\n    return (\r\n        <div className=\"playback-page\">\r\n            <style>{styles}</style>\r\n\r\n            <div className=\"playback-header\">\r\n                <button onClick={() => window.location.href = '/'}>← Înapoi</button>\r\n                <span style={{ fontWeight: 600 }}>{camId} - PLAYBACK</span>\r\n                <span style={{ fontSize: 11, color: '#555', marginLeft: 10 }}>\r\n                    {rawSegments.length} segmente | {new Date(timeRange.from).toLocaleTimeString()} - {new Date(timeRange.to).toLocaleTimeString()}\r\n                </span>\r\n            </div>\r\n\r\n            <div className=\"video-viewport\">\r\n                <video ref={videoRef} controls autoPlay muted playsInline />\r\n            </div>\r\n\r\n            <div className=\"controls\">\r\n                {!isPlaying ? (\r\n                    <button onClick={startPlayback} disabled={isLoading}>\r\n                        {isLoading ? \"Încărcare...\" : \"▶ REDĂ\"}\r\n                    </button>\r\n                ) : (\r\n                    <button onClick={stopPlayback}>■ OPRIRE</button>\r\n                )}\r\n            </div>\r\n\r\n            <div className=\"timeline-area\">\r\n                <div className=\"segments-track\">\r\n                    {segments.map((seg, i) => (\r\n                        <div\r\n                            key={i}\r\n                            className=\"segment\"\r\n                            style={{\r\n                                left: `${seg.s * 100}%`,\r\n                                width: `${(seg.e - seg.s) * 100}%`\r\n                            }}\r\n                        />\r\n                    ))}\r\n                </div>\r\n                <div ref={cursorRef} className=\"cursor\" style={{ left: '0%' }} />\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}