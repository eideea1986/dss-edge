{"ast":null,"code":"import React,{useEffect,useState,useRef}from\"react\";import{useSearchParams}from\"react-router-dom\";import API from\"../api\";import Hls from'hls.js';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const styles=\"\\n* { box-sizing: border-box; margin: 0; padding: 0; }\\nbody { background: #cfd2d6; }\\n\\n.playback-page {\\n  height: 100vh;\\n  display: flex;\\n  flex-direction: column;\\n  background: #cfd2d6;\\n  font-family: Arial, sans-serif;\\n}\\n\\n.playback-header {\\n  height: 40px;\\n  background: #d9d9d9;\\n  display: flex;\\n  align-items: center;\\n  padding: 0 10px;\\n  gap: 8px;\\n  border-bottom: 1px solid #999;\\n}\\n\\n.video-viewport {\\n  height: calc(100vh - 140px);\\n  background: #000;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  position: relative;\\n}\\n\\nvideo {\\n  width: 100%;\\n  height: 100%;\\n  object-fit: contain;\\n  background: #000;\\n}\\n\\n.controls {\\n  height: 60px;\\n  background: #d9d9d9;\\n  display: flex;\\n  align-items: center;\\n  gap: 6px;\\n  padding: 0 8px;\\n  border-bottom: 1px solid #999;\\n}\\n\\n.timeline-area {\\n  height: 80px;\\n  background: #e6e6e6;\\n  border-top: 1px solid #999;\\n  position: relative;\\n  overflow: hidden;\\n  cursor: pointer;\\n  user-select: none;\\n}\\n\\n/* Time axis (0-24h) markers */\\n.time-markers {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  width: 100%;\\n  height: 20px;\\n  display: flex;\\n  pointer-events: none;\\n}\\n.time-marker {\\n  flex: 1;\\n  border-left: 1px solid #999;\\n  font-size: 10px;\\n  color: #555;\\n  padding-left: 2px;\\n  height: 100%;\\n}\\n\\n.segments-track {\\n  position: absolute;\\n  top: 25px;\\n  height: 30px;\\n  left: 0;\\n  right: 0;\\n  background: rgba(0,0,0,0.05);\\n}\\n\\n.segment {\\n  position: absolute;\\n  height: 100%;\\n  background: #2ecc71; /* Green */\\n  min-width: 2px; /* Ensure visibility */\\n  opacity: 0.8;\\n}\\n\\n.cursor {\\n  position: absolute;\\n  top: 0;\\n  height: 100%;\\n  width: 2px;\\n  background: red;\\n  z-index: 10;\\n  pointer-events: none;\\n}\\n\\nbutton {\\n  padding: 4px 10px;\\n  border: 1px solid #555;\\n  background: #f0f0f0;\\n  cursor: pointer;\\n  font-size: 13px;\\n}\\nbutton:hover { background: #fff; }\\nbutton:active { background: #ddd; }\\nbutton:disabled { color: #aaa; cursor: not-allowed; }\\n\\n.info-text { font-size: 11px; color: #555; margin-left: 10px; }\\n\";export default function Playback(){const[params]=useSearchParams();const camId=params.get(\"camId\");// Timeline Data (Normalized 0-1 relative to 24h day)\nconst[segments,setSegments]=useState([]);const[segCount,setSegCount]=useState(0);// Playback State\nconst[isPlaying,setIsPlaying]=useState(false);const[isLoading,setIsLoading]=useState(false);// Current View Date (Start of Day Epoch)\nconst[viewDate]=useState(()=>{const d=new Date();d.setHours(0,0,0,0);return d.getTime();});const videoRef=useRef(null);const hlsRef=useRef(null);const cursorRef=useRef(null);const timelineRef=useRef(null);// 1. Load FULL DAY timeline\nuseEffect(()=>{if(!camId)return;const dayEnd=viewDate+86400000;// +24h\nconsole.log(\"Loading timeline for day: \".concat(new Date(viewDate).toLocaleDateString()));API.get(\"/playback/timeline/\".concat(camId,\"?from=\").concat(viewDate,\"&to=\").concat(dayEnd)).then(res=>{const rawSegs=res.data.segments||[];setSegCount(rawSegs.length);// NORMALIZE to 0-1 range relative to THE DAY (00:00 - 24:00)\n// Independent of request 'from', we use viewDate as base\nconst daySpan=86400000;const normalized=rawSegs.filter(s=>s.start_ts>0).map(s=>({s:(s.start_ts-viewDate)/daySpan,e:(s.end_ts-viewDate)/daySpan,origStart:s.start_ts,origEnd:s.end_ts}));setSegments(normalized);}).catch(e=>console.error(e));},[camId,viewDate]);// Helper: Wait for HLS\nconst waitForHls=async function(url){let retries=arguments.length>1&&arguments[1]!==undefined?arguments[1]:30;for(let i=0;i<retries;i++){try{const res=await fetch(url,{method:'HEAD'});if(res.ok)return true;}catch(e){/* ignore */}await new Promise(r=>setTimeout(r,500));}return false;};// 2. Playback Logic\nconst startPlayback=async function(){let startTime=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;// If no start time given, find first segment\nif(!startTime){if(segments.length===0)return alert(\"Nicio înregistrare azi.\");startTime=segments[0].origStart;}setIsLoading(true);try{// Request playback from 'startTime' until NOW (or end of day)\n// This ensures HLS has all subsequent segments too\n// Note: If data ends at 10:00, and it's 12:00, we request until 12:00\nconst endTime=Date.now();console.log(\"Starting playback: \".concat(new Date(startTime).toLocaleTimeString(),\" -> NOW\"));const res=await API.post('/playback/start',{camId,from:startTime,to:endTime,speed:1});const hlsUrl=\"http://192.168.120.208:8080\".concat(res.data.hlsUrl);if(!(await waitForHls(hlsUrl)))throw new Error(\"HLS Timeout\");if(Hls.isSupported()){if(hlsRef.current)hlsRef.current.destroy();const hls=new Hls();hls.loadSource(hlsUrl);hls.attachMedia(videoRef.current);hls.on(Hls.Events.MANIFEST_PARSED,()=>videoRef.current.play().catch(console.error));hlsRef.current=hls;}else if(videoRef.current.canPlayType('application/vnd.apple.mpegurl')){videoRef.current.src=hlsUrl;videoRef.current.play();}setIsPlaying(true);}catch(e){console.error(e);alert(\"Error: \"+e.message);}finally{setIsLoading(false);}};const stopPlayback=async()=>{try{API.post('/playback/stop',{camId});if(hlsRef.current)hlsRef.current.destroy();if(videoRef.current){videoRef.current.pause();videoRef.current.removeAttribute('src');videoRef.current.load();}setIsPlaying(false);}catch(e){console.error(e);}};// 3. Timeline Interaction (Seek)\nconst handleTimelineClick=e=>{const rect=timelineRef.current.getBoundingClientRect();const ratio=(e.clientX-rect.left)/rect.width;// Update Cursor UI\nif(cursorRef.current)cursorRef.current.style.left=ratio*100+\"%\";// Calculate Timestamp (0-24h)\nconst seekTs=Math.floor(viewDate+ratio*86400000);console.log(\"Seek to: \".concat(new Date(seekTs).toLocaleTimeString()));// Start playback from this timestamp\nstopPlayback().then(()=>startPlayback(seekTs));};// Generate 24h markers\nconst markers=Array.from({length:24},(_,i)=>i);return/*#__PURE__*/_jsxs(\"div\",{className:\"playback-page\",children:[/*#__PURE__*/_jsx(\"style\",{children:styles}),/*#__PURE__*/_jsxs(\"div\",{className:\"playback-header\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.location.href='/',children:\"\\u2190 \\xCEnapoi\"}),/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:600},children:camId}),/*#__PURE__*/_jsxs(\"span\",{className:\"info-text\",children:[\"Data: \",new Date(viewDate).toLocaleDateString(),\" | Segmente: \",segCount]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"video-viewport\",children:/*#__PURE__*/_jsx(\"video\",{ref:videoRef,controls:true,autoPlay:true,muted:true,playsInline:true})}),/*#__PURE__*/_jsx(\"div\",{className:\"controls\",children:!isPlaying?/*#__PURE__*/_jsx(\"button\",{onClick:()=>startPlayback(),disabled:isLoading,children:isLoading?\"Încărcare...\":\"▶ REDĂ (Tot)\"}):/*#__PURE__*/_jsx(\"button\",{onClick:stopPlayback,children:\"\\u25A0 OPRIRE\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"timeline-area\",ref:timelineRef,onClick:handleTimelineClick,title:\"Click pentru a reda de la ora selectat\\u0103\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"time-markers\",children:markers.map(h=>/*#__PURE__*/_jsx(\"div\",{className:\"time-marker\",children:h},h))}),/*#__PURE__*/_jsx(\"div\",{className:\"segments-track\",children:segments.map((seg,i)=>/*#__PURE__*/_jsx(\"div\",{className:\"segment\",style:{left:\"\".concat(Math.max(0,Math.min(1,seg.s))*100,\"%\"),width:\"\".concat(Math.max((seg.e-seg.s)*100,0.1),\"%\")// Min width handled by CSS min-width: 2px, but percentage helps too\n}},i))}),/*#__PURE__*/_jsx(\"div\",{ref:cursorRef,className:\"cursor\",style:{left:'0%'}})]})]});}","map":{"version":3,"names":["React","useEffect","useState","useRef","useSearchParams","API","Hls","jsx","_jsx","jsxs","_jsxs","styles","Playback","params","camId","get","segments","setSegments","segCount","setSegCount","isPlaying","setIsPlaying","isLoading","setIsLoading","viewDate","d","Date","setHours","getTime","videoRef","hlsRef","cursorRef","timelineRef","dayEnd","console","log","concat","toLocaleDateString","then","res","rawSegs","data","length","daySpan","normalized","filter","s","start_ts","map","e","end_ts","origStart","origEnd","catch","error","waitForHls","url","retries","arguments","undefined","i","fetch","method","ok","Promise","r","setTimeout","startPlayback","startTime","alert","endTime","now","toLocaleTimeString","post","from","to","speed","hlsUrl","Error","isSupported","current","destroy","hls","loadSource","attachMedia","on","Events","MANIFEST_PARSED","play","canPlayType","src","message","stopPlayback","pause","removeAttribute","load","handleTimelineClick","rect","getBoundingClientRect","ratio","clientX","left","width","style","seekTs","Math","floor","markers","Array","_","className","children","onClick","window","location","href","fontWeight","ref","controls","autoPlay","muted","playsInline","disabled","title","h","seg","max","min"],"sources":["I:/dispecerat/github_release/dss-edge/local-ui/src/pages/Playback.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\r\nimport { useSearchParams } from \"react-router-dom\";\r\nimport API from \"../api\";\r\nimport Hls from 'hls.js';\r\n\r\nconst styles = `\r\n* { box-sizing: border-box; margin: 0; padding: 0; }\r\nbody { background: #cfd2d6; }\r\n\r\n.playback-page {\r\n  height: 100vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  background: #cfd2d6;\r\n  font-family: Arial, sans-serif;\r\n}\r\n\r\n.playback-header {\r\n  height: 40px;\r\n  background: #d9d9d9;\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 0 10px;\r\n  gap: 8px;\r\n  border-bottom: 1px solid #999;\r\n}\r\n\r\n.video-viewport {\r\n  height: calc(100vh - 140px);\r\n  background: #000;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  position: relative;\r\n}\r\n\r\nvideo {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: contain;\r\n  background: #000;\r\n}\r\n\r\n.controls {\r\n  height: 60px;\r\n  background: #d9d9d9;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 6px;\r\n  padding: 0 8px;\r\n  border-bottom: 1px solid #999;\r\n}\r\n\r\n.timeline-area {\r\n  height: 80px;\r\n  background: #e6e6e6;\r\n  border-top: 1px solid #999;\r\n  position: relative;\r\n  overflow: hidden;\r\n  cursor: pointer;\r\n  user-select: none;\r\n}\r\n\r\n/* Time axis (0-24h) markers */\r\n.time-markers {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 20px;\r\n  display: flex;\r\n  pointer-events: none;\r\n}\r\n.time-marker {\r\n  flex: 1;\r\n  border-left: 1px solid #999;\r\n  font-size: 10px;\r\n  color: #555;\r\n  padding-left: 2px;\r\n  height: 100%;\r\n}\r\n\r\n.segments-track {\r\n  position: absolute;\r\n  top: 25px;\r\n  height: 30px;\r\n  left: 0;\r\n  right: 0;\r\n  background: rgba(0,0,0,0.05);\r\n}\r\n\r\n.segment {\r\n  position: absolute;\r\n  height: 100%;\r\n  background: #2ecc71; /* Green */\r\n  min-width: 2px; /* Ensure visibility */\r\n  opacity: 0.8;\r\n}\r\n\r\n.cursor {\r\n  position: absolute;\r\n  top: 0;\r\n  height: 100%;\r\n  width: 2px;\r\n  background: red;\r\n  z-index: 10;\r\n  pointer-events: none;\r\n}\r\n\r\nbutton {\r\n  padding: 4px 10px;\r\n  border: 1px solid #555;\r\n  background: #f0f0f0;\r\n  cursor: pointer;\r\n  font-size: 13px;\r\n}\r\nbutton:hover { background: #fff; }\r\nbutton:active { background: #ddd; }\r\nbutton:disabled { color: #aaa; cursor: not-allowed; }\r\n\r\n.info-text { font-size: 11px; color: #555; margin-left: 10px; }\r\n`;\r\n\r\nexport default function Playback() {\r\n    const [params] = useSearchParams();\r\n    const camId = params.get(\"camId\");\r\n\r\n    // Timeline Data (Normalized 0-1 relative to 24h day)\r\n    const [segments, setSegments] = useState([]);\r\n    const [segCount, setSegCount] = useState(0);\r\n\r\n    // Playback State\r\n    const [isPlaying, setIsPlaying] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n\r\n    // Current View Date (Start of Day Epoch)\r\n    const [viewDate] = useState(() => {\r\n        const d = new Date();\r\n        d.setHours(0, 0, 0, 0);\r\n        return d.getTime();\r\n    });\r\n\r\n    const videoRef = useRef(null);\r\n    const hlsRef = useRef(null);\r\n    const cursorRef = useRef(null);\r\n    const timelineRef = useRef(null);\r\n\r\n    // 1. Load FULL DAY timeline\r\n    useEffect(() => {\r\n        if (!camId) return;\r\n\r\n        const dayEnd = viewDate + 86400000; // +24h\r\n        console.log(`Loading timeline for day: ${new Date(viewDate).toLocaleDateString()}`);\r\n\r\n        API.get(`/playback/timeline/${camId}?from=${viewDate}&to=${dayEnd}`)\r\n            .then(res => {\r\n                const rawSegs = res.data.segments || [];\r\n                setSegCount(rawSegs.length);\r\n\r\n                // NORMALIZE to 0-1 range relative to THE DAY (00:00 - 24:00)\r\n                // Independent of request 'from', we use viewDate as base\r\n                const daySpan = 86400000;\r\n\r\n                const normalized = rawSegs\r\n                    .filter(s => s.start_ts > 0)\r\n                    .map(s => ({\r\n                        s: (s.start_ts - viewDate) / daySpan,\r\n                        e: (s.end_ts - viewDate) / daySpan,\r\n                        origStart: s.start_ts,\r\n                        origEnd: s.end_ts\r\n                    }));\r\n\r\n                setSegments(normalized);\r\n            })\r\n            .catch(e => console.error(e));\r\n    }, [camId, viewDate]);\r\n\r\n    // Helper: Wait for HLS\r\n    const waitForHls = async (url, retries = 30) => {\r\n        for (let i = 0; i < retries; i++) {\r\n            try {\r\n                const res = await fetch(url, { method: 'HEAD' });\r\n                if (res.ok) return true;\r\n            } catch (e) { /* ignore */ }\r\n            await new Promise(r => setTimeout(r, 500));\r\n        }\r\n        return false;\r\n    };\r\n\r\n    // 2. Playback Logic\r\n    const startPlayback = async (startTime = null) => {\r\n        // If no start time given, find first segment\r\n        if (!startTime) {\r\n            if (segments.length === 0) return alert(\"Nicio înregistrare azi.\");\r\n            startTime = segments[0].origStart;\r\n        }\r\n\r\n        setIsLoading(true);\r\n        try {\r\n            // Request playback from 'startTime' until NOW (or end of day)\r\n            // This ensures HLS has all subsequent segments too\r\n            // Note: If data ends at 10:00, and it's 12:00, we request until 12:00\r\n            const endTime = Date.now();\r\n\r\n            console.log(`Starting playback: ${new Date(startTime).toLocaleTimeString()} -> NOW`);\r\n\r\n            const res = await API.post('/playback/start', {\r\n                camId,\r\n                from: startTime,\r\n                to: endTime,\r\n                speed: 1\r\n            });\r\n\r\n            const hlsUrl = `http://192.168.120.208:8080${res.data.hlsUrl}`;\r\n\r\n            if (!await waitForHls(hlsUrl)) throw new Error(\"HLS Timeout\");\r\n\r\n            if (Hls.isSupported()) {\r\n                if (hlsRef.current) hlsRef.current.destroy();\r\n                const hls = new Hls();\r\n                hls.loadSource(hlsUrl);\r\n                hls.attachMedia(videoRef.current);\r\n                hls.on(Hls.Events.MANIFEST_PARSED, () => videoRef.current.play().catch(console.error));\r\n                hlsRef.current = hls;\r\n            } else if (videoRef.current.canPlayType('application/vnd.apple.mpegurl')) {\r\n                videoRef.current.src = hlsUrl;\r\n                videoRef.current.play();\r\n            }\r\n\r\n            setIsPlaying(true);\r\n        } catch (e) {\r\n            console.error(e);\r\n            alert(\"Error: \" + e.message);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const stopPlayback = async () => {\r\n        try {\r\n            API.post('/playback/stop', { camId });\r\n            if (hlsRef.current) hlsRef.current.destroy();\r\n            if (videoRef.current) {\r\n                videoRef.current.pause();\r\n                videoRef.current.removeAttribute('src');\r\n                videoRef.current.load();\r\n            }\r\n            setIsPlaying(false);\r\n        } catch (e) { console.error(e); }\r\n    };\r\n\r\n    // 3. Timeline Interaction (Seek)\r\n    const handleTimelineClick = (e) => {\r\n        const rect = timelineRef.current.getBoundingClientRect();\r\n        const ratio = (e.clientX - rect.left) / rect.width;\r\n\r\n        // Update Cursor UI\r\n        if (cursorRef.current) cursorRef.current.style.left = (ratio * 100) + \"%\";\r\n\r\n        // Calculate Timestamp (0-24h)\r\n        const seekTs = Math.floor(viewDate + ratio * 86400000);\r\n        console.log(`Seek to: ${new Date(seekTs).toLocaleTimeString()}`);\r\n\r\n        // Start playback from this timestamp\r\n        stopPlayback().then(() => startPlayback(seekTs));\r\n    };\r\n\r\n    // Generate 24h markers\r\n    const markers = Array.from({ length: 24 }, (_, i) => i);\r\n\r\n    return (\r\n        <div className=\"playback-page\">\r\n            <style>{styles}</style>\r\n\r\n            <div className=\"playback-header\">\r\n                <button onClick={() => window.location.href = '/'}>← Înapoi</button>\r\n                <span style={{ fontWeight: 600 }}>{camId}</span>\r\n                <span className=\"info-text\">\r\n                    Data: {new Date(viewDate).toLocaleDateString()} | Segmente: {segCount}\r\n                </span>\r\n            </div>\r\n\r\n            <div className=\"video-viewport\">\r\n                <video ref={videoRef} controls autoPlay muted playsInline />\r\n            </div>\r\n\r\n            <div className=\"controls\">\r\n                {!isPlaying ? (\r\n                    <button onClick={() => startPlayback()} disabled={isLoading}>\r\n                        {isLoading ? \"Încărcare...\" : \"▶ REDĂ (Tot)\"}\r\n                    </button>\r\n                ) : (\r\n                    <button onClick={stopPlayback}>■ OPRIRE</button>\r\n                )}\r\n            </div>\r\n\r\n            <div\r\n                className=\"timeline-area\"\r\n                ref={timelineRef}\r\n                onClick={handleTimelineClick}\r\n                title=\"Click pentru a reda de la ora selectată\"\r\n            >\r\n                {/* 1. Time Axis (Static 0-24h) */}\r\n                <div className=\"time-markers\">\r\n                    {markers.map(h => (\r\n                        <div key={h} className=\"time-marker\">{h}</div>\r\n                    ))}\r\n                </div>\r\n\r\n                {/* 2. Segments (Data Overlay) */}\r\n                <div className=\"segments-track\">\r\n                    {segments.map((seg, i) => (\r\n                        <div\r\n                            key={i}\r\n                            className=\"segment\"\r\n                            style={{\r\n                                left: `${Math.max(0, Math.min(1, seg.s)) * 100}%`,\r\n                                width: `${Math.max((seg.e - seg.s) * 100, 0.1)}%`\r\n                                // Min width handled by CSS min-width: 2px, but percentage helps too\r\n                            }}\r\n                        />\r\n                    ))}\r\n                </div>\r\n\r\n                <div ref={cursorRef} className=\"cursor\" style={{ left: '0%' }} />\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}