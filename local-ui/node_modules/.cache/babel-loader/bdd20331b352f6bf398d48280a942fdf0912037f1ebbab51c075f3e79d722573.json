{"ast":null,"code":"import _objectSpread from\"I:/dispecerat/github_release/dss-edge/local-ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState,useRef,useCallback}from\"react\";import{useSearchParams}from\"react-router-dom\";import API from\"../api\";import Hls from'hls.js';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const styles=\"\\n* { box-sizing: border-box; margin: 0; padding: 0; }\\nbody { background: #cfd2d6; }\\n.playback-page { height: 100vh; display: flex; flex-direction: column; background: #cfd2d6; font-family: Arial, sans-serif; }\\n.playback-header { height: 40px; background: #d9d9d9; display: flex; align-items: center; padding: 0 10px; gap: 8px; border-bottom: 1px solid #999; }\\n.video-viewport { height: calc(100vh - 140px); background: #000; display: flex; align-items: center; justify-content: center; position: relative; }\\nvideo { width: 100%; height: 100%; object-fit: contain; background: #000; }\\n.controls { height: 60px; background: #d9d9d9; display: flex; align-items: center; gap: 6px; padding: 0 8px; border-bottom: 1px solid #999; }\\n.timeline-area { height: 80px; background: #e6e6e6; border-top: 1px solid #999; position: relative; overflow: hidden; cursor: pointer; user-select: none; z-index: 10; }\\n.time-markers { position: absolute; top: 0; left: 0; width: 100%; height: 20px; display: flex; pointer-events: none; border-bottom: 1px solid #ccc; }\\n.time-marker { flex: 1; border-left: 1px solid #999; font-size: 10px; color: #555; padding-left: 2px; height: 100%; }\\n.segments-track { position: absolute; top: 25px; height: 30px; left: 0; right: 0; background: rgba(0,0,0,0.05); pointer-events: none; }\\n.segment { position: absolute; height: 100%; background: #ff0000; border: 1px solid yellow; opacity: 0.8; } /* RED FOR DEBUG */\\n.cursor { position: absolute; top: 0; height: 100%; width: 2px; background: blue; z-index: 10; pointer-events: none; }\\nbutton { padding: 4px 10px; border: 1px solid #555; background: #f0f0f0; cursor: pointer; font-size: 13px; }\\nbutton:hover { background: #fff; }\\nbutton:disabled { color: #aaa; cursor: not-allowed; }\\n.info-text { font-size: 11px; color: #555; margin-left: 10px; }\\n.debug-panel { position: absolute; top: 50px; right: 10px; background: rgba(0,0,0,0.7); color: lime; padding: 5px; font-size: 10px; z-index: 9999; pointer-events: none; }\\n\";export default function Playback(){const[params]=useSearchParams();const camId=params.get(\"camId\");// ----------------------------------------------------\n// 1. TIMELINE STATE (READ ONLY - Global Day Overview)\n// ----------------------------------------------------\nconst[timelineSegments,setTimelineSegments]=useState([]);const[dayStart,setDayStart]=useState(0);// Current View Date (Local YYYY-MM-DD)\nconst[selectedDate,setSelectedDate]=useState(()=>{const d=new Date();const offset=d.getTimezoneOffset()*60000;const local=new Date(d.getTime()-offset);return local.toISOString().split('T')[0];});// ----------------------------------------------------\n// 2. PLAYBACK STATE (Streaming - Does NOT affect Timeline)\n// ----------------------------------------------------\nconst[isPlaying,setIsPlaying]=useState(false);const[isLoading,setIsLoading]=useState(false);const videoRef=useRef(null);const hlsRef=useRef(null);const cursorRef=useRef(null);const timelineRef=useRef(null);// UTILS: Merge overlapping/adjacent segments for cleaner timeline\nconst mergeAndDeduplicate=segs=>{if(!segs||segs.length===0)return[];// Ensure numbers\nconst sorted=[...segs].map(s=>({start_ts:Number(s.start_ts),end_ts:Number(s.end_ts)})).sort((a,b)=>a.start_ts-b.start_ts);const merged=sorted.reduce((acc,s)=>{const last=acc[acc.length-1];if(last&&s.start_ts<=last.end_ts+2000){last.end_ts=Math.max(last.end_ts,s.end_ts);}else{acc.push(_objectSpread({},s));}return acc;},[]);return merged;};// FETCH TIMELINE (Strictly separated from playback)\nuseEffect(()=>{if(!camId||!selectedDate)return;console.log(\"[Timeline] Fetching FULL DAY: \".concat(selectedDate));API.get(\"/playback/timeline-day/\".concat(camId,\"/\").concat(selectedDate)).then(res=>{const{segments:raw,dayStart:ds}=res.data;// 1. Merge tiny segments into blocks\nconst mergedBlocks=mergeAndDeduplicate(raw);// 2. Align DayStart to Data (UTC Floor)\nlet alignedDayStart=0;if(mergedBlocks.length>0){const firstTs=mergedBlocks[0].start_ts;alignedDayStart=Math.floor(firstTs/86400000)*86400000;}// Fallback if no data (use backend dayStart or calc from local date)\nif(alignedDayStart===0&&ds)alignedDayStart=ds;if(alignedDayStart===0){// Calc from selectedDate\nconst parts=selectedDate.split('-');alignedDayStart=new Date(Date.UTC(parts[0],parts[1]-1,parts[2])).getTime();}setDayStart(alignedDayStart);// 3. Normalize for Render\nconst daySpan=86400000;const norm=mergedBlocks.map(s=>{const l=(s.start_ts-alignedDayStart)/daySpan;const w=(s.end_ts-s.start_ts)/daySpan;return{left:Math.max(0,Math.min(1,l)),// Clamp 0-1\nwidth:Math.max(0,Math.min(1,w)),// Clamp width\nts:s.start_ts,rawStart:s.start_ts,// For debug\nrawEnd:s.end_ts// For debug\n};});setTimelineSegments(norm);}).catch(e=>console.error(e));},[camId,selectedDate]);// HLS Helper\nconst waitForHls=async function(url){let retries=arguments.length>1&&arguments[1]!==undefined?arguments[1]:50;for(let i=0;i<retries;i++){try{const res=await fetch(url,{method:'HEAD'});if(res.ok)return true;}catch(_unused){/* ignore */}await new Promise(r=>setTimeout(r,200));}return false;};const play=useCallback(async startTime=>{if(!startTime)return alert(\"Selectează un moment pe timeline\");setIsLoading(true);try{try{API.post('/playback/stop',{camId});if(hlsRef.current){hlsRef.current.destroy();hlsRef.current=null;}}catch(e){}console.log(\"[Playback] Start Req: \".concat(new Date(startTime).toLocaleTimeString()));const res=await API.post('/playback/start',{camId,from:startTime,to:Date.now(),speed:1});const hlsUrl=\"http://192.168.120.208:8080\".concat(res.data.hlsUrl);if(!(await waitForHls(hlsUrl)))throw new Error(\"HLS Timeout\");if(Hls.isSupported()){const hls=new Hls();hls.loadSource(hlsUrl);hls.attachMedia(videoRef.current);hls.on(Hls.Events.MANIFEST_PARSED,()=>videoRef.current.play().catch(console.error));hlsRef.current=hls;}else if(videoRef.current.canPlayType('application/vnd.apple.mpegurl')){videoRef.current.src=hlsUrl;videoRef.current.play();}setIsPlaying(true);}catch(e){console.error(e);alert(\"Eroare redare: \"+e.message);}finally{setIsLoading(false);}},[camId]);const stop=async()=>{try{API.post('/playback/stop',{camId});if(hlsRef.current){hlsRef.current.destroy();hlsRef.current=null;}if(videoRef.current){videoRef.current.pause();videoRef.current.removeAttribute('src');videoRef.current.load();}setIsPlaying(false);}catch(e){console.error(e);}};const handleSeek=e=>{if(!dayStart)return;const rect=timelineRef.current.getBoundingClientRect();const ratio=(e.clientX-rect.left)/rect.width;if(cursorRef.current)cursorRef.current.style.left=ratio*100+\"%\";const seekTs=Math.floor(dayStart+ratio*86400000);console.log(\"[Seek] Ratio: \".concat(ratio.toFixed(3),\" -> TS: \").concat(seekTs));play(seekTs);};const handleMainPlay=()=>{if(timelineSegments.length>0)play(timelineSegments[0].ts);else alert(\"Nu există înregistrări.\");};return/*#__PURE__*/_jsxs(\"div\",{className:\"playback-page\",children:[/*#__PURE__*/_jsx(\"style\",{children:styles}),timelineSegments.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"debug-panel\",children:[\"DEBUG SEGMENT 1:\",/*#__PURE__*/_jsx(\"br\",{}),\"Start: \",new Date(timelineSegments[0].rawStart).toLocaleTimeString(),\" (TS: \",timelineSegments[0].rawStart,\")\",/*#__PURE__*/_jsx(\"br\",{}),\"Left: \",(timelineSegments[0].left*100).toFixed(2),\"%\",/*#__PURE__*/_jsx(\"br\",{}),\"Width: \",(timelineSegments[0].width*100).toFixed(2),\"%\",/*#__PURE__*/_jsx(\"br\",{}),\"DayStart: \",new Date(dayStart).toISOString(),\" (\",dayStart,\")\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"playback-header\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.location.href='/',children:\"\\u2190 \\xCEnapoi\"}),/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:600},children:camId}),/*#__PURE__*/_jsxs(\"span\",{className:\"info-text\",children:[\"Intervale (Merge): \",timelineSegments.length,\" | Dat\\u0103: \",selectedDate]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"video-viewport\",children:/*#__PURE__*/_jsx(\"video\",{ref:videoRef,controls:true,autoPlay:true,muted:true,playsInline:true})}),/*#__PURE__*/_jsx(\"div\",{className:\"controls\",children:!isPlaying?/*#__PURE__*/_jsx(\"button\",{onClick:handleMainPlay,disabled:isLoading,children:isLoading?\"Încărcare...\":\"▶ REDĂ TOATE\"}):/*#__PURE__*/_jsx(\"button\",{onClick:stop,children:\"\\u25A0 OPRIRE\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"timeline-area\",ref:timelineRef,onClick:handleSeek,title:\"Click pentru a reda\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"time-markers\",children:Array.from({length:24},(_,i)=>i).map(h=>/*#__PURE__*/_jsx(\"div\",{className:\"time-marker\",children:h},h))}),/*#__PURE__*/_jsx(\"div\",{className:\"segments-track\",children:timelineSegments.map((s,i)=>/*#__PURE__*/_jsx(\"div\",{className:\"segment\",style:{left:\"\".concat(s.left*100,\"%\"),width:\"\".concat(Math.max(s.width*100,0.2),\"%\")}},i))}),/*#__PURE__*/_jsx(\"div\",{ref:cursorRef,className:\"cursor\",style:{left:'0%'}})]})]});}","map":{"version":3,"names":["React","useEffect","useState","useRef","useCallback","useSearchParams","API","Hls","jsx","_jsx","jsxs","_jsxs","styles","Playback","params","camId","get","timelineSegments","setTimelineSegments","dayStart","setDayStart","selectedDate","setSelectedDate","d","Date","offset","getTimezoneOffset","local","getTime","toISOString","split","isPlaying","setIsPlaying","isLoading","setIsLoading","videoRef","hlsRef","cursorRef","timelineRef","mergeAndDeduplicate","segs","length","sorted","map","s","start_ts","Number","end_ts","sort","a","b","merged","reduce","acc","last","Math","max","push","_objectSpread","console","log","concat","then","res","segments","raw","ds","data","mergedBlocks","alignedDayStart","firstTs","floor","parts","UTC","daySpan","norm","l","w","left","min","width","ts","rawStart","rawEnd","catch","e","error","waitForHls","url","retries","arguments","undefined","i","fetch","method","ok","_unused","Promise","r","setTimeout","play","startTime","alert","post","current","destroy","toLocaleTimeString","from","to","now","speed","hlsUrl","Error","isSupported","hls","loadSource","attachMedia","on","Events","MANIFEST_PARSED","canPlayType","src","message","stop","pause","removeAttribute","load","handleSeek","rect","getBoundingClientRect","ratio","clientX","style","seekTs","toFixed","handleMainPlay","className","children","onClick","window","location","href","fontWeight","ref","controls","autoPlay","muted","playsInline","disabled","title","Array","_","h"],"sources":["I:/dispecerat/github_release/dss-edge/local-ui/src/pages/Playback.js"],"sourcesContent":["import React, { useEffect, useState, useRef, useCallback } from \"react\";\r\nimport { useSearchParams } from \"react-router-dom\";\r\nimport API from \"../api\";\r\nimport Hls from 'hls.js';\r\n\r\nconst styles = `\r\n* { box-sizing: border-box; margin: 0; padding: 0; }\r\nbody { background: #cfd2d6; }\r\n.playback-page { height: 100vh; display: flex; flex-direction: column; background: #cfd2d6; font-family: Arial, sans-serif; }\r\n.playback-header { height: 40px; background: #d9d9d9; display: flex; align-items: center; padding: 0 10px; gap: 8px; border-bottom: 1px solid #999; }\r\n.video-viewport { height: calc(100vh - 140px); background: #000; display: flex; align-items: center; justify-content: center; position: relative; }\r\nvideo { width: 100%; height: 100%; object-fit: contain; background: #000; }\r\n.controls { height: 60px; background: #d9d9d9; display: flex; align-items: center; gap: 6px; padding: 0 8px; border-bottom: 1px solid #999; }\r\n.timeline-area { height: 80px; background: #e6e6e6; border-top: 1px solid #999; position: relative; overflow: hidden; cursor: pointer; user-select: none; z-index: 10; }\r\n.time-markers { position: absolute; top: 0; left: 0; width: 100%; height: 20px; display: flex; pointer-events: none; border-bottom: 1px solid #ccc; }\r\n.time-marker { flex: 1; border-left: 1px solid #999; font-size: 10px; color: #555; padding-left: 2px; height: 100%; }\r\n.segments-track { position: absolute; top: 25px; height: 30px; left: 0; right: 0; background: rgba(0,0,0,0.05); pointer-events: none; }\r\n.segment { position: absolute; height: 100%; background: #ff0000; border: 1px solid yellow; opacity: 0.8; } /* RED FOR DEBUG */\r\n.cursor { position: absolute; top: 0; height: 100%; width: 2px; background: blue; z-index: 10; pointer-events: none; }\r\nbutton { padding: 4px 10px; border: 1px solid #555; background: #f0f0f0; cursor: pointer; font-size: 13px; }\r\nbutton:hover { background: #fff; }\r\nbutton:disabled { color: #aaa; cursor: not-allowed; }\r\n.info-text { font-size: 11px; color: #555; margin-left: 10px; }\r\n.debug-panel { position: absolute; top: 50px; right: 10px; background: rgba(0,0,0,0.7); color: lime; padding: 5px; font-size: 10px; z-index: 9999; pointer-events: none; }\r\n`;\r\n\r\nexport default function Playback() {\r\n    const [params] = useSearchParams();\r\n    const camId = params.get(\"camId\");\r\n\r\n    // ----------------------------------------------------\r\n    // 1. TIMELINE STATE (READ ONLY - Global Day Overview)\r\n    // ----------------------------------------------------\r\n    const [timelineSegments, setTimelineSegments] = useState([]);\r\n    const [dayStart, setDayStart] = useState(0);\r\n\r\n    // Current View Date (Local YYYY-MM-DD)\r\n    const [selectedDate, setSelectedDate] = useState(() => {\r\n        const d = new Date();\r\n        const offset = d.getTimezoneOffset() * 60000;\r\n        const local = new Date(d.getTime() - offset);\r\n        return local.toISOString().split('T')[0];\r\n    });\r\n\r\n    // ----------------------------------------------------\r\n    // 2. PLAYBACK STATE (Streaming - Does NOT affect Timeline)\r\n    // ----------------------------------------------------\r\n    const [isPlaying, setIsPlaying] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n\r\n    const videoRef = useRef(null);\r\n    const hlsRef = useRef(null);\r\n    const cursorRef = useRef(null);\r\n    const timelineRef = useRef(null);\r\n\r\n    // UTILS: Merge overlapping/adjacent segments for cleaner timeline\r\n    const mergeAndDeduplicate = (segs) => {\r\n        if (!segs || segs.length === 0) return [];\r\n\r\n        // Ensure numbers\r\n        const sorted = [...segs].map(s => ({\r\n            start_ts: Number(s.start_ts),\r\n            end_ts: Number(s.end_ts)\r\n        })).sort((a, b) => a.start_ts - b.start_ts);\r\n\r\n        const merged = sorted.reduce((acc, s) => {\r\n            const last = acc[acc.length - 1];\r\n            if (last && s.start_ts <= last.end_ts + 2000) {\r\n                last.end_ts = Math.max(last.end_ts, s.end_ts);\r\n            } else {\r\n                acc.push({ ...s });\r\n            }\r\n            return acc;\r\n        }, []);\r\n\r\n        return merged;\r\n    };\r\n\r\n    // FETCH TIMELINE (Strictly separated from playback)\r\n    useEffect(() => {\r\n        if (!camId || !selectedDate) return;\r\n\r\n        console.log(`[Timeline] Fetching FULL DAY: ${selectedDate}`);\r\n\r\n        API.get(`/playback/timeline-day/${camId}/${selectedDate}`)\r\n            .then(res => {\r\n                const { segments: raw, dayStart: ds } = res.data;\r\n\r\n                // 1. Merge tiny segments into blocks\r\n                const mergedBlocks = mergeAndDeduplicate(raw);\r\n\r\n                // 2. Align DayStart to Data (UTC Floor)\r\n                let alignedDayStart = 0;\r\n                if (mergedBlocks.length > 0) {\r\n                    const firstTs = mergedBlocks[0].start_ts;\r\n                    alignedDayStart = Math.floor(firstTs / 86400000) * 86400000;\r\n                }\r\n\r\n                // Fallback if no data (use backend dayStart or calc from local date)\r\n                if (alignedDayStart === 0 && ds) alignedDayStart = ds;\r\n                if (alignedDayStart === 0) {\r\n                    // Calc from selectedDate\r\n                    const parts = selectedDate.split('-');\r\n                    alignedDayStart = new Date(Date.UTC(parts[0], parts[1] - 1, parts[2])).getTime();\r\n                }\r\n\r\n                setDayStart(alignedDayStart);\r\n\r\n                // 3. Normalize for Render\r\n                const daySpan = 86400000;\r\n                const norm = mergedBlocks.map(s => {\r\n                    const l = (s.start_ts - alignedDayStart) / daySpan;\r\n                    const w = (s.end_ts - s.start_ts) / daySpan;\r\n                    return {\r\n                        left: Math.max(0, Math.min(1, l)), // Clamp 0-1\r\n                        width: Math.max(0, Math.min(1, w)), // Clamp width\r\n                        ts: s.start_ts,\r\n                        rawStart: s.start_ts, // For debug\r\n                        rawEnd: s.end_ts      // For debug\r\n                    };\r\n                });\r\n\r\n                setTimelineSegments(norm);\r\n            })\r\n            .catch(e => console.error(e));\r\n    }, [camId, selectedDate]);\r\n\r\n    // HLS Helper\r\n    const waitForHls = async (url, retries = 50) => {\r\n        for (let i = 0; i < retries; i++) {\r\n            try {\r\n                const res = await fetch(url, { method: 'HEAD' });\r\n                if (res.ok) return true;\r\n            } catch { /* ignore */ }\r\n            await new Promise(r => setTimeout(r, 200));\r\n        }\r\n        return false;\r\n    };\r\n\r\n    const play = useCallback(async (startTime) => {\r\n        if (!startTime) return alert(\"Selectează un moment pe timeline\");\r\n        setIsLoading(true);\r\n        try {\r\n            try {\r\n                API.post('/playback/stop', { camId });\r\n                if (hlsRef.current) { hlsRef.current.destroy(); hlsRef.current = null; }\r\n            } catch (e) { }\r\n\r\n            console.log(`[Playback] Start Req: ${new Date(startTime).toLocaleTimeString()}`);\r\n\r\n            const res = await API.post('/playback/start', {\r\n                camId,\r\n                from: startTime,\r\n                to: Date.now(),\r\n                speed: 1\r\n            });\r\n\r\n            const hlsUrl = `http://192.168.120.208:8080${res.data.hlsUrl}`;\r\n            if (!await waitForHls(hlsUrl)) throw new Error(\"HLS Timeout\");\r\n\r\n            if (Hls.isSupported()) {\r\n                const hls = new Hls();\r\n                hls.loadSource(hlsUrl);\r\n                hls.attachMedia(videoRef.current);\r\n                hls.on(Hls.Events.MANIFEST_PARSED, () => videoRef.current.play().catch(console.error));\r\n                hlsRef.current = hls;\r\n            } else if (videoRef.current.canPlayType('application/vnd.apple.mpegurl')) {\r\n                videoRef.current.src = hlsUrl;\r\n                videoRef.current.play();\r\n            }\r\n            setIsPlaying(true);\r\n        } catch (e) {\r\n            console.error(e);\r\n            alert(\"Eroare redare: \" + e.message);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    }, [camId]);\r\n\r\n    const stop = async () => {\r\n        try {\r\n            API.post('/playback/stop', { camId });\r\n            if (hlsRef.current) { hlsRef.current.destroy(); hlsRef.current = null; }\r\n            if (videoRef.current) {\r\n                videoRef.current.pause();\r\n                videoRef.current.removeAttribute('src');\r\n                videoRef.current.load();\r\n            }\r\n            setIsPlaying(false);\r\n        } catch (e) { console.error(e); }\r\n    };\r\n\r\n    const handleSeek = (e) => {\r\n        if (!dayStart) return;\r\n        const rect = timelineRef.current.getBoundingClientRect();\r\n        const ratio = (e.clientX - rect.left) / rect.width;\r\n        if (cursorRef.current) cursorRef.current.style.left = (ratio * 100) + \"%\";\r\n        const seekTs = Math.floor(dayStart + ratio * 86400000);\r\n        console.log(`[Seek] Ratio: ${ratio.toFixed(3)} -> TS: ${seekTs}`);\r\n        play(seekTs);\r\n    };\r\n\r\n    const handleMainPlay = () => {\r\n        if (timelineSegments.length > 0) play(timelineSegments[0].ts);\r\n        else alert(\"Nu există înregistrări.\");\r\n    };\r\n\r\n    return (\r\n        <div className=\"playback-page\">\r\n            <style>{styles}</style>\r\n\r\n            {/* DEBUG PANEL */}\r\n            {timelineSegments.length > 0 && (\r\n                <div className=\"debug-panel\">\r\n                    DEBUG SEGMENT 1:<br />\r\n                    Start: {new Date(timelineSegments[0].rawStart).toLocaleTimeString()} (TS: {timelineSegments[0].rawStart})<br />\r\n                    Left: {(timelineSegments[0].left * 100).toFixed(2)}%<br />\r\n                    Width: {(timelineSegments[0].width * 100).toFixed(2)}%<br />\r\n                    DayStart: {new Date(dayStart).toISOString()} ({dayStart})\r\n                </div>\r\n            )}\r\n\r\n            <div className=\"playback-header\">\r\n                <button onClick={() => window.location.href = '/'}>← Înapoi</button>\r\n                <span style={{ fontWeight: 600 }}>{camId}</span>\r\n                <span className=\"info-text\">\r\n                    Intervale (Merge): {timelineSegments.length} | Dată: {selectedDate}\r\n                </span>\r\n            </div>\r\n\r\n            <div className=\"video-viewport\">\r\n                <video ref={videoRef} controls autoPlay muted playsInline />\r\n            </div>\r\n\r\n            <div className=\"controls\">\r\n                {!isPlaying ? (\r\n                    <button onClick={handleMainPlay} disabled={isLoading}>\r\n                        {isLoading ? \"Încărcare...\" : \"▶ REDĂ TOATE\"}\r\n                    </button>\r\n                ) : (\r\n                    <button onClick={stop}>■ OPRIRE</button>\r\n                )}\r\n            </div>\r\n\r\n            <div\r\n                className=\"timeline-area\"\r\n                ref={timelineRef}\r\n                onClick={handleSeek}\r\n                title=\"Click pentru a reda\"\r\n            >\r\n                <div className=\"time-markers\">\r\n                    {Array.from({ length: 24 }, (_, i) => i).map(h => <div key={h} className=\"time-marker\">{h}</div>)}\r\n                </div>\r\n\r\n                <div className=\"segments-track\">\r\n                    {timelineSegments.map((s, i) => (\r\n                        <div key={i} className=\"segment\"\r\n                            style={{\r\n                                left: `${s.left * 100}%`,\r\n                                width: `${Math.max(s.width * 100, 0.2)}%`\r\n                            }}\r\n                        />\r\n                    ))}\r\n                </div>\r\n\r\n                <div ref={cursorRef} className=\"cursor\" style={{ left: '0%' }} />\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}