{"ast":null,"code":"var _jsxFileName = \"I:\\\\dispecerat\\\\github_release\\\\dss-edge\\\\local-ui\\\\src\\\\pages\\\\PlaybackModern.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef, useLayoutEffect } from \"react\";\nimport { useSearchParams, useNavigate } from \"react-router-dom\";\nimport API from \"../api\";\nimport PlaybackController, { PlayerStates } from \"../services/PlaybackController\";\n\n// --- ENTERPRISE THEME ---\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst THEME = {\n  bg: \"#1e1e1e\",\n  sidebar: \"#252526\",\n  header: \"#2d2d2d\",\n  text: \"#ffffff\",\n  accent: \"#2196f3\",\n  segment: \"#4caf50\",\n  segmentEvent: \"#2196f3\",\n  rulerBg: \"#252526\",\n  playhead: \"#ff9800\",\n  panelBorder: \"#3e3e42\",\n  selectedItem: \"#37373d\"\n};\nexport default function PlaybackModern() {\n  _s();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n  const camId = searchParams.get(\"camId\");\n\n  // --- STATE ---\n  const [cameras, setCameras] = useState([]);\n  const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0]);\n  const [playerState, setPlayerState] = useState(PlayerStates.IDLE);\n  const [playbackRate, setPlaybackRate] = useState(1.0);\n\n  // --- TIMELINE STATE ---\n  const [currentTimeMs, setCurrentTimeMs] = useState(Date.now());\n  const [viewportStartMs, setViewportStartMs] = useState(new Date().setHours(0, 0, 0, 0));\n  const [zoomPxPerSec, setZoomPxPerSec] = useState(1000 / 86400); // Fit Day Default\n  const [containerWidth, setContainerWidth] = useState(1000);\n  const [segments, setSegments] = useState([]);\n  const [isLoadingData, setIsLoadingData] = useState(false);\n  const videoRef = useRef(null);\n  const playerRef = useRef(null);\n  const timelineRef = useRef(null);\n  const dragRef = useRef({\n    isDragging: false,\n    startX: 0,\n    startViewTime: 0\n  });\n  const [recRange, setRecRange] = useState({\n    start: null,\n    end: null\n  });\n\n  // --- DATA SETUP ---\n  useEffect(() => {\n    // Fetch Camera List\n    API.get('/cameras').then(res => {\n      const list = Array.isArray(res.data) ? res.data : [];\n      setCameras(list);\n    }).catch(console.error);\n  }, []);\n\n  // Fetch Recording Range\n  useEffect(() => {\n    if (!camId) return;\n    API.get(`/api/playback/range/${camId}`).then(res => {\n      setRecRange(res.data);\n    }).catch(console.error);\n  }, [camId]);\n\n  // ... existing useEffects ...\n\n  useEffect(() => {\n    if (selectedDate) {\n      const start = new Date(selectedDate).setHours(0, 0, 0, 0);\n      setViewportStartMs(start);\n      // Set Current Time to middle of day or Start? Start (00:00) makes sense for review.\n      setCurrentTimeMs(start + 86400000 / 2); // Noon\n    }\n  }, [selectedDate]);\n  useLayoutEffect(() => {\n    if (!timelineRef.current) return;\n    // ResizeObserver for robust width detection\n    const ro = new ResizeObserver(entries => {\n      for (let entry of entries) {\n        if (entry.contentRect.width > 0) setContainerWidth(entry.contentRect.width);\n      }\n    });\n    ro.observe(timelineRef.current);\n    // Initial set\n    setContainerWidth(timelineRef.current.clientWidth || 1000);\n    return () => ro.disconnect();\n  }, []);\n  useEffect(() => {\n    if (videoRef.current && camId) {\n      playerRef.current = new PlaybackController(videoRef.current, camId, s => setPlayerState(s));\n      return () => {\n        var _playerRef$current;\n        return (_playerRef$current = playerRef.current) === null || _playerRef$current === void 0 ? void 0 : _playerRef$current.destroy();\n      };\n    }\n  }, [camId]);\n  useEffect(() => {\n    if (!camId || !selectedDate) return;\n    const fetchData = async () => {\n      setIsLoadingData(true);\n      setSegments([]);\n      try {\n        const res = await API.get(`/api/playback/timeline-day/${camId}/${selectedDate}`);\n        const data = res.data;\n        const serverDayStart = data.dayStart;\n        const localDayStart = new Date(selectedDate).setHours(0, 0, 0, 0);\n        let correction = 0;\n        if (serverDayStart > 0) {\n          correction = localDayStart - serverDayStart;\n        }\n        const segs = (data.segments || []).map(s => ({\n          start: Number(s.start_ts) + correction,\n          end: Number(s.end_ts) + correction,\n          type: 'normal'\n        })).sort((a, b) => a.start - b.start);\n        setSegments(segs);\n        if (playerRef.current) playerRef.current.loadSegments(segs);\n        setViewportStartMs(localDayStart);\n        if (containerWidth > 0) setZoomPxPerSec(containerWidth / 86400);\n      } catch (e) {\n        console.error(e);\n      } finally {\n        setIsLoadingData(false);\n      }\n    };\n    fetchData();\n  }, [camId, selectedDate, containerWidth]);\n\n  // --- SYNC LOOP ---\n  useEffect(() => {\n    const i = setInterval(() => {\n      if (playerState === PlayerStates.PLAYING && playerRef.current) {\n        const now = playerRef.current.getCurrentTime();\n        if (Math.abs(now - currentTimeMs) > 200) setCurrentTimeMs(now);\n\n        // Gap Skip\n        const currentSeg = segments.find(s => now >= s.start && now < s.end);\n        if (currentSeg && currentSeg.end - now < 500) {\n          const nextSeg = segments.find(s => s.start >= currentSeg.end);\n          if (nextSeg && nextSeg.start - currentSeg.end > 1000) {\n            playerRef.current.seekTo(nextSeg.start);\n          }\n        }\n      }\n    }, 100);\n    return () => clearInterval(i);\n  }, [playerState, currentTimeMs, segments]);\n\n  // --- ACTIONS ---\n  const handleCameraClick = id => {\n    navigate(`/playback?camId=${id}`);\n  };\n  const performSeek = ts => {\n    var _playerRef$current2;\n    setCurrentTimeMs(ts);\n    (_playerRef$current2 = playerRef.current) === null || _playerRef$current2 === void 0 ? void 0 : _playerRef$current2.seekTo(ts);\n  };\n  const fitDay = () => {\n    const start = new Date(selectedDate).setHours(0, 0, 0, 0);\n    setViewportStartMs(start);\n    setZoomPxPerSec(containerWidth / 86400);\n  };\n\n  // --- MOUSE HANDLERS (Constrained Pan) ---\n  const handleMouseDown = e => {\n    dragRef.current = {\n      isDragging: true,\n      startX: e.clientX,\n      startViewTime: viewportStartMs\n    };\n  };\n  const handleMouseMove = e => {\n    if (!dragRef.current.isDragging) return;\n    const dx = e.clientX - dragRef.current.startX;\n    const dt = -(dx / zoomPxPerSec) * 1000;\n    let newStart = dragRef.current.startViewTime + dt;\n\n    // CONSTRAIN TO DAY BOUNDARIES (User Request: \"Nu trece de la o zi la alta\")\n    const dayStart = new Date(selectedDate).setHours(0, 0, 0, 0);\n    const dayEnd = dayStart + 86400000;\n\n    // Allow zooming but keep view within day range roughly\n    // If zoomed in, we can pan. But don't pan past 00:00 or 24:00 relative to container?\n    // Actually, just clamp strictly.\n    if (newStart < dayStart) newStart = dayStart;\n    if (newStart > dayEnd - containerWidth / zoomPxPerSec * 1000) {\n      // newStart cannot ensure end > dayEnd completely if zoomed out?\n      // If zoomed out Max (fit day), newStart is dayStart.\n      // If zoomed in, restrict right edge.\n      // Let's just create a soft clamp for left side 00:00\n    }\n    setViewportStartMs(newStart);\n  };\n  const handleMouseUp = e => {\n    dragRef.current.isDragging = false;\n    if (Math.abs(e.clientX - dragRef.current.startX) < 5) {\n      const rect = timelineRef.current.getBoundingClientRect();\n      const clickX = e.clientX - rect.left;\n      const ts = viewportStartMs + clickX / zoomPxPerSec * 1000;\n      performSeek(ts);\n    }\n  };\n  const handleWheel = e => {\n    if (e.target.closest('.timeline-area')) {\n      e.preventDefault();\n      const rect = timelineRef.current.getBoundingClientRect();\n      const mouseX = e.clientX - rect.left;\n      const timeUnderMouse = viewportStartMs + mouseX / zoomPxPerSec * 1000;\n      const factor = e.deltaY > 0 ? 0.9 : 1.1;\n      const newZoom = Math.max(containerWidth / 86400, Math.min(5.0, zoomPxPerSec * factor));\n\n      // Calc new start to keep mouse time static\n      let newStart = timeUnderMouse - mouseX / newZoom * 1000;\n\n      // Constrain\n      const dayStart = new Date(selectedDate).setHours(0, 0, 0, 0);\n      if (newStart < dayStart) newStart = dayStart;\n      setZoomPxPerSec(newZoom);\n      setViewportStartMs(newStart);\n    }\n  };\n\n  // --- RENDER HELPERS ---\n  const timeToPx = t => (t - viewportStartMs) / 1000 * zoomPxPerSec;\n  const renderRuler = () => {\n    const ticks = [];\n    const stepMs = 3600 * 1000; // Fixed 1 Hour ticks for \"0-24\" stability\n    const dayStart = new Date(selectedDate).setHours(0, 0, 0, 0);\n    for (let i = 0; i <= 24; i++) {\n      const t = dayStart + i * stepMs;\n      const x = timeToPx(t);\n      if (x < -20 || x > containerWidth) continue;\n      ticks.push(/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'absolute',\n          left: x,\n          top: 0,\n          height: 25,\n          borderLeft: '1px solid #666'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: 'absolute',\n            top: 2,\n            left: 4,\n            fontSize: 11,\n            color: '#aaa'\n          },\n          children: [i, \":00\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 21\n        }, this)\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 17\n      }, this));\n    }\n    return ticks;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      position: 'fixed',\n      top: 0,\n      left: 0,\n      right: 0,\n      bottom: 0,\n      background: THEME.bg,\n      color: THEME.text\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: 250,\n        background: THEME.sidebar,\n        borderRight: `1px solid ${THEME.panelBorder}`,\n        display: 'flex',\n        flexDirection: 'column'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: 10,\n          fontWeight: 'bold',\n          borderBottom: `1px solid ${THEME.panelBorder}`\n        },\n        children: \"CHANNELS\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flex: 1,\n          overflowY: 'auto'\n        },\n        children: [cameras.map(cam => /*#__PURE__*/_jsxDEV(\"div\", {\n          onClick: () => handleCameraClick(cam.id),\n          style: {\n            padding: '8px 12px',\n            cursor: 'pointer',\n            fontSize: 13,\n            background: camId === cam.id ? THEME.selectedItem : 'transparent',\n            color: camId === cam.id ? '#fff' : '#ccc'\n          },\n          children: cam.name || cam.id\n        }, cam.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 25\n        }, this)), cameras.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: 10,\n            color: '#888'\n          },\n          children: \"No cameras found\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 46\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: 1,\n        display: 'flex',\n        flexDirection: 'column'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"header\", {\n        style: {\n          height: 40,\n          background: THEME.header,\n          display: 'flex',\n          alignItems: 'center',\n          padding: '0 10px',\n          borderBottom: `1px solid ${THEME.panelBorder}`\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            fontWeight: 'bold',\n            color: THEME.accent\n          },\n          children: \"PLAYBACK\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 21\n        }, this), recRange.start && /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            marginLeft: 20,\n            fontSize: 11,\n            color: '#aaa'\n          },\n          children: [\"Recordings: \", new Date(recRange.start).toLocaleDateString(), \" - \", new Date(recRange.end).toLocaleDateString()]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            flex: 1\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"date\",\n          value: selectedDate,\n          onChange: e => setSelectedDate(e.target.value),\n          style: {\n            background: '#333',\n            color: '#fff',\n            border: 'none',\n            borderRadius: 4,\n            padding: '4px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flex: 1,\n          position: 'relative',\n          background: '#000',\n          overflow: 'hidden',\n          minHeight: 0\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"video\", {\n          ref: videoRef,\n          style: {\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            width: '100%',\n            height: '100%',\n            objectFit: 'contain'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 21\n        }, this), !camId && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: 'absolute',\n            top: '50%',\n            left: '50%',\n            transform: 'translate(-50%, -50%)',\n            color: '#aaa'\n          },\n          children: \"Select a Camera\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 32\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          height: 48,\n          background: '#252526',\n          display: 'flex',\n          alignItems: 'center',\n          padding: '0 10px',\n          gap: 10\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          style: btnStyle,\n          onClick: () => performSeek(currentTimeMs - 5000),\n          children: \"\\u23EA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          style: btnStyle,\n          onClick: () => {\n            var _playerRef$current3, _playerRef$current4;\n            return playerState === PlayerStates.PLAYING ? (_playerRef$current3 = playerRef.current) === null || _playerRef$current3 === void 0 ? void 0 : _playerRef$current3.pause() : (_playerRef$current4 = playerRef.current) === null || _playerRef$current4 === void 0 ? void 0 : _playerRef$current4.play();\n          },\n          children: playerState === PlayerStates.PLAYING ? \"PAUSE\" : \"PLAY\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          style: btnStyle,\n          onClick: () => performSeek(currentTimeMs + 5000),\n          children: \"\\u23E9\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            flex: 1,\n            textAlign: 'center',\n            fontFamily: 'monospace'\n          },\n          children: new Date(currentTimeMs).toLocaleTimeString()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          style: btnStyle,\n          onClick: fitDay,\n          children: \"24H\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"timeline-area\",\n        ref: timelineRef,\n        style: {\n          height: 100,\n          background: THEME.rulerBg,\n          position: 'relative',\n          overflow: 'hidden'\n        },\n        onMouseUp: handleMouseUp,\n        onMouseLeave: handleMouseUp,\n        onMouseMove: handleMouseMove,\n        onMouseDown: handleMouseDown,\n        onWheel: handleWheel,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            height: 25,\n            borderBottom: '1px solid #444'\n          },\n          children: renderRuler()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: 'relative',\n            top: 5,\n            height: 40\n          },\n          children: segments.map((s, i) => {\n            const x = timeToPx(s.start);\n            const w = Math.max(2, (s.end - s.start) / 1000 * zoomPxPerSec);\n            if (x + w < 0 || x > containerWidth) return null;\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                position: 'absolute',\n                left: x,\n                width: w,\n                height: '100%',\n                background: THEME.segment\n              }\n            }, i, false, {\n              fileName: _jsxFileName,\n              lineNumber: 309,\n              columnNumber: 36\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: 'absolute',\n            left: timeToPx(currentTimeMs),\n            top: 0,\n            bottom: 0,\n            width: 2,\n            background: THEME.playhead,\n            zIndex: 10\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 247,\n    columnNumber: 9\n  }, this);\n}\n_s(PlaybackModern, \"9XQ1Au4U2hC6vgaHrcDVAJMxJ7M=\", false, function () {\n  return [useSearchParams, useNavigate];\n});\n_c = PlaybackModern;\nconst btnStyle = {\n  background: \"#444\",\n  color: \"#fff\",\n  border: \"none\",\n  padding: \"4px 8px\",\n  borderRadius: 3,\n  cursor: \"pointer\"\n};\nvar _c;\n$RefreshReg$(_c, \"PlaybackModern\");","map":{"version":3,"names":["React","useEffect","useState","useRef","useLayoutEffect","useSearchParams","useNavigate","API","PlaybackController","PlayerStates","jsxDEV","_jsxDEV","THEME","bg","sidebar","header","text","accent","segment","segmentEvent","rulerBg","playhead","panelBorder","selectedItem","PlaybackModern","_s","searchParams","navigate","camId","get","cameras","setCameras","selectedDate","setSelectedDate","Date","toISOString","split","playerState","setPlayerState","IDLE","playbackRate","setPlaybackRate","currentTimeMs","setCurrentTimeMs","now","viewportStartMs","setViewportStartMs","setHours","zoomPxPerSec","setZoomPxPerSec","containerWidth","setContainerWidth","segments","setSegments","isLoadingData","setIsLoadingData","videoRef","playerRef","timelineRef","dragRef","isDragging","startX","startViewTime","recRange","setRecRange","start","end","then","res","list","Array","isArray","data","catch","console","error","current","ro","ResizeObserver","entries","entry","contentRect","width","observe","clientWidth","disconnect","s","_playerRef$current","destroy","fetchData","serverDayStart","dayStart","localDayStart","correction","segs","map","Number","start_ts","end_ts","type","sort","a","b","loadSegments","e","i","setInterval","PLAYING","getCurrentTime","Math","abs","currentSeg","find","nextSeg","seekTo","clearInterval","handleCameraClick","id","performSeek","ts","_playerRef$current2","fitDay","handleMouseDown","clientX","handleMouseMove","dx","dt","newStart","dayEnd","handleMouseUp","rect","getBoundingClientRect","clickX","left","handleWheel","target","closest","preventDefault","mouseX","timeUnderMouse","factor","deltaY","newZoom","max","min","timeToPx","t","renderRuler","ticks","stepMs","x","push","style","position","top","height","borderLeft","children","fontSize","color","fileName","_jsxFileName","lineNumber","columnNumber","display","right","bottom","background","borderRight","flexDirection","padding","fontWeight","borderBottom","flex","overflowY","cam","onClick","cursor","name","length","alignItems","marginLeft","toLocaleDateString","value","onChange","border","borderRadius","overflow","minHeight","ref","objectFit","transform","gap","btnStyle","_playerRef$current3","_playerRef$current4","pause","play","textAlign","fontFamily","toLocaleTimeString","className","onMouseUp","onMouseLeave","onMouseMove","onMouseDown","onWheel","w","zIndex","_c","$RefreshReg$"],"sources":["I:/dispecerat/github_release/dss-edge/local-ui/src/pages/PlaybackModern.js"],"sourcesContent":["import React, { useEffect, useState, useRef, useLayoutEffect } from \"react\";\r\nimport { useSearchParams, useNavigate } from \"react-router-dom\";\r\nimport API from \"../api\";\r\nimport PlaybackController, { PlayerStates } from \"../services/PlaybackController\";\r\n\r\n// --- ENTERPRISE THEME ---\r\nconst THEME = {\r\n    bg: \"#1e1e1e\",\r\n    sidebar: \"#252526\",\r\n    header: \"#2d2d2d\",\r\n    text: \"#ffffff\",\r\n    accent: \"#2196f3\",\r\n    segment: \"#4caf50\",\r\n    segmentEvent: \"#2196f3\",\r\n    rulerBg: \"#252526\",\r\n    playhead: \"#ff9800\",\r\n    panelBorder: \"#3e3e42\",\r\n    selectedItem: \"#37373d\"\r\n};\r\n\r\nexport default function PlaybackModern() {\r\n    const [searchParams] = useSearchParams();\r\n    const navigate = useNavigate();\r\n    const camId = searchParams.get(\"camId\");\r\n\r\n    // --- STATE ---\r\n    const [cameras, setCameras] = useState([]);\r\n    const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0]);\r\n    const [playerState, setPlayerState] = useState(PlayerStates.IDLE);\r\n    const [playbackRate, setPlaybackRate] = useState(1.0);\r\n\r\n    // --- TIMELINE STATE ---\r\n    const [currentTimeMs, setCurrentTimeMs] = useState(Date.now());\r\n    const [viewportStartMs, setViewportStartMs] = useState(new Date().setHours(0, 0, 0, 0));\r\n    const [zoomPxPerSec, setZoomPxPerSec] = useState(1000 / 86400); // Fit Day Default\r\n    const [containerWidth, setContainerWidth] = useState(1000);\r\n    const [segments, setSegments] = useState([]);\r\n    const [isLoadingData, setIsLoadingData] = useState(false);\r\n\r\n    const videoRef = useRef(null);\r\n    const playerRef = useRef(null);\r\n    const timelineRef = useRef(null);\r\n    const dragRef = useRef({ isDragging: false, startX: 0, startViewTime: 0 });\r\n\r\n    const [recRange, setRecRange] = useState({ start: null, end: null });\r\n\r\n    // --- DATA SETUP ---\r\n    useEffect(() => {\r\n        // Fetch Camera List\r\n        API.get('/cameras').then(res => {\r\n            const list = Array.isArray(res.data) ? res.data : [];\r\n            setCameras(list);\r\n        }).catch(console.error);\r\n    }, []);\r\n\r\n    // Fetch Recording Range\r\n    useEffect(() => {\r\n        if (!camId) return;\r\n        API.get(`/api/playback/range/${camId}`).then(res => {\r\n            setRecRange(res.data);\r\n        }).catch(console.error);\r\n    }, [camId]);\r\n\r\n    // ... existing useEffects ...\r\n\r\n    useEffect(() => {\r\n        if (selectedDate) {\r\n            const start = new Date(selectedDate).setHours(0, 0, 0, 0);\r\n            setViewportStartMs(start);\r\n            // Set Current Time to middle of day or Start? Start (00:00) makes sense for review.\r\n            setCurrentTimeMs(start + 86400000 / 2); // Noon\r\n        }\r\n    }, [selectedDate]);\r\n\r\n    useLayoutEffect(() => {\r\n        if (!timelineRef.current) return;\r\n        // ResizeObserver for robust width detection\r\n        const ro = new ResizeObserver(entries => {\r\n            for (let entry of entries) {\r\n                if (entry.contentRect.width > 0) setContainerWidth(entry.contentRect.width);\r\n            }\r\n        });\r\n        ro.observe(timelineRef.current);\r\n        // Initial set\r\n        setContainerWidth(timelineRef.current.clientWidth || 1000);\r\n        return () => ro.disconnect();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (videoRef.current && camId) {\r\n            playerRef.current = new PlaybackController(videoRef.current, camId, (s) => setPlayerState(s));\r\n            return () => playerRef.current?.destroy();\r\n        }\r\n    }, [camId]);\r\n\r\n    useEffect(() => {\r\n        if (!camId || !selectedDate) return;\r\n        const fetchData = async () => {\r\n            setIsLoadingData(true);\r\n            setSegments([]);\r\n            try {\r\n                const res = await API.get(`/api/playback/timeline-day/${camId}/${selectedDate}`);\r\n                const data = res.data;\r\n                const serverDayStart = data.dayStart;\r\n\r\n                const localDayStart = new Date(selectedDate).setHours(0, 0, 0, 0);\r\n                let correction = 0;\r\n                if (serverDayStart > 0) {\r\n                    correction = localDayStart - serverDayStart;\r\n                }\r\n\r\n                const segs = (data.segments || []).map(s => ({\r\n                    start: Number(s.start_ts) + correction,\r\n                    end: Number(s.end_ts) + correction,\r\n                    type: 'normal'\r\n                })).sort((a, b) => a.start - b.start);\r\n\r\n                setSegments(segs);\r\n                if (playerRef.current) playerRef.current.loadSegments(segs);\r\n\r\n                setViewportStartMs(localDayStart);\r\n                if (containerWidth > 0) setZoomPxPerSec(containerWidth / 86400);\r\n\r\n            } catch (e) { console.error(e); } finally { setIsLoadingData(false); }\r\n        };\r\n        fetchData();\r\n    }, [camId, selectedDate, containerWidth]);\r\n\r\n    // --- SYNC LOOP ---\r\n    useEffect(() => {\r\n        const i = setInterval(() => {\r\n            if (playerState === PlayerStates.PLAYING && playerRef.current) {\r\n                const now = playerRef.current.getCurrentTime();\r\n                if (Math.abs(now - currentTimeMs) > 200) setCurrentTimeMs(now);\r\n\r\n                // Gap Skip\r\n                const currentSeg = segments.find(s => now >= s.start && now < s.end);\r\n                if (currentSeg && (currentSeg.end - now) < 500) {\r\n                    const nextSeg = segments.find(s => s.start >= currentSeg.end);\r\n                    if (nextSeg && nextSeg.start - currentSeg.end > 1000) {\r\n                        playerRef.current.seekTo(nextSeg.start);\r\n                    }\r\n                }\r\n            }\r\n        }, 100);\r\n        return () => clearInterval(i);\r\n    }, [playerState, currentTimeMs, segments]);\r\n\r\n    // --- ACTIONS ---\r\n    const handleCameraClick = (id) => {\r\n        navigate(`/playback?camId=${id}`);\r\n    };\r\n\r\n    const performSeek = (ts) => {\r\n        setCurrentTimeMs(ts);\r\n        playerRef.current?.seekTo(ts);\r\n    };\r\n\r\n    const fitDay = () => {\r\n        const start = new Date(selectedDate).setHours(0, 0, 0, 0);\r\n        setViewportStartMs(start);\r\n        setZoomPxPerSec(containerWidth / 86400);\r\n    };\r\n\r\n    // --- MOUSE HANDLERS (Constrained Pan) ---\r\n    const handleMouseDown = (e) => {\r\n        dragRef.current = { isDragging: true, startX: e.clientX, startViewTime: viewportStartMs };\r\n    };\r\n\r\n    const handleMouseMove = (e) => {\r\n        if (!dragRef.current.isDragging) return;\r\n        const dx = e.clientX - dragRef.current.startX;\r\n        const dt = -(dx / zoomPxPerSec) * 1000;\r\n\r\n        let newStart = dragRef.current.startViewTime + dt;\r\n\r\n        // CONSTRAIN TO DAY BOUNDARIES (User Request: \"Nu trece de la o zi la alta\")\r\n        const dayStart = new Date(selectedDate).setHours(0, 0, 0, 0);\r\n        const dayEnd = dayStart + 86400000;\r\n\r\n        // Allow zooming but keep view within day range roughly\r\n        // If zoomed in, we can pan. But don't pan past 00:00 or 24:00 relative to container?\r\n        // Actually, just clamp strictly.\r\n        if (newStart < dayStart) newStart = dayStart;\r\n        if (newStart > dayEnd - (containerWidth / zoomPxPerSec * 1000)) {\r\n            // newStart cannot ensure end > dayEnd completely if zoomed out?\r\n            // If zoomed out Max (fit day), newStart is dayStart.\r\n            // If zoomed in, restrict right edge.\r\n            // Let's just create a soft clamp for left side 00:00\r\n        }\r\n        setViewportStartMs(newStart);\r\n    };\r\n\r\n    const handleMouseUp = (e) => {\r\n        dragRef.current.isDragging = false;\r\n        if (Math.abs(e.clientX - dragRef.current.startX) < 5) {\r\n            const rect = timelineRef.current.getBoundingClientRect();\r\n            const clickX = e.clientX - rect.left;\r\n            const ts = viewportStartMs + (clickX / zoomPxPerSec) * 1000;\r\n            performSeek(ts);\r\n        }\r\n    };\r\n\r\n    const handleWheel = (e) => {\r\n        if (e.target.closest('.timeline-area')) {\r\n            e.preventDefault();\r\n            const rect = timelineRef.current.getBoundingClientRect();\r\n            const mouseX = e.clientX - rect.left;\r\n            const timeUnderMouse = viewportStartMs + (mouseX / zoomPxPerSec) * 1000;\r\n            const factor = e.deltaY > 0 ? 0.9 : 1.1;\r\n            const newZoom = Math.max(containerWidth / 86400, Math.min(5.0, zoomPxPerSec * factor));\r\n\r\n            // Calc new start to keep mouse time static\r\n            let newStart = timeUnderMouse - (mouseX / newZoom) * 1000;\r\n\r\n            // Constrain\r\n            const dayStart = new Date(selectedDate).setHours(0, 0, 0, 0);\r\n            if (newStart < dayStart) newStart = dayStart;\r\n\r\n            setZoomPxPerSec(newZoom);\r\n            setViewportStartMs(newStart);\r\n        }\r\n    };\r\n\r\n    // --- RENDER HELPERS ---\r\n    const timeToPx = (t) => (t - viewportStartMs) / 1000 * zoomPxPerSec;\r\n\r\n    const renderRuler = () => {\r\n        const ticks = [];\r\n        const stepMs = (3600 * 1000); // Fixed 1 Hour ticks for \"0-24\" stability\r\n        const dayStart = new Date(selectedDate).setHours(0, 0, 0, 0);\r\n\r\n        for (let i = 0; i <= 24; i++) {\r\n            const t = dayStart + i * stepMs;\r\n            const x = timeToPx(t);\r\n            if (x < -20 || x > containerWidth) continue;\r\n            ticks.push(\r\n                <div key={i} style={{ position: 'absolute', left: x, top: 0, height: 25, borderLeft: '1px solid #666' }}>\r\n                    <div style={{ position: 'absolute', top: 2, left: 4, fontSize: 11, color: '#aaa' }}>{i}:00</div>\r\n                </div>\r\n            );\r\n        }\r\n        return ticks;\r\n    };\r\n\r\n    return (\r\n        <div style={{ display: 'flex', position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, background: THEME.bg, color: THEME.text }}>\r\n\r\n            {/* SIDEBAR - CAMERA LIST */}\r\n            <div style={{ width: 250, background: THEME.sidebar, borderRight: `1px solid ${THEME.panelBorder}`, display: 'flex', flexDirection: 'column' }}>\r\n                <div style={{ padding: 10, fontWeight: 'bold', borderBottom: `1px solid ${THEME.panelBorder}` }}>CHANNELS</div>\r\n                <div style={{ flex: 1, overflowY: 'auto' }}>\r\n                    {cameras.map(cam => (\r\n                        <div key={cam.id}\r\n                            onClick={() => handleCameraClick(cam.id)}\r\n                            style={{\r\n                                padding: '8px 12px', cursor: 'pointer', fontSize: 13,\r\n                                background: camId === cam.id ? THEME.selectedItem : 'transparent',\r\n                                color: camId === cam.id ? '#fff' : '#ccc'\r\n                            }}>\r\n                            {cam.name || cam.id}\r\n                        </div>\r\n                    ))}\r\n                    {cameras.length === 0 && <div style={{ padding: 10, color: '#888' }}>No cameras found</div>}\r\n                </div>\r\n            </div>\r\n\r\n            {/* MAIN CONTENT */}\r\n            <div style={{ flex: 1, display: 'flex', flexDirection: 'column' }}>\r\n                <header style={{ height: 40, background: THEME.header, display: 'flex', alignItems: 'center', padding: '0 10px', borderBottom: `1px solid ${THEME.panelBorder}` }}>\r\n                    <span style={{ fontWeight: 'bold', color: THEME.accent }}>PLAYBACK</span>\r\n                    {recRange.start && (\r\n                        <span style={{ marginLeft: 20, fontSize: 11, color: '#aaa' }}>\r\n                            Recordings: {new Date(recRange.start).toLocaleDateString()} - {new Date(recRange.end).toLocaleDateString()}\r\n                        </span>\r\n                    )}\r\n                    <div style={{ flex: 1 }} />\r\n                    <input type=\"date\" value={selectedDate} onChange={e => setSelectedDate(e.target.value)}\r\n                        style={{ background: '#333', color: '#fff', border: 'none', borderRadius: 4, padding: '4px' }} />\r\n                </header>\r\n\r\n                <div style={{ flex: 1, position: 'relative', background: '#000', overflow: 'hidden', minHeight: 0 }}>\r\n                    <video ref={videoRef} style={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%', objectFit: 'contain' }} />\r\n                    {!camId && <div style={{ position: 'absolute', top: '50%', left: '50%', transform: 'translate(-50%, -50%)', color: '#aaa' }}>Select a Camera</div>}\r\n                </div>\r\n\r\n                <div style={{ height: 48, background: '#252526', display: 'flex', alignItems: 'center', padding: '0 10px', gap: 10 }}>\r\n                    <button style={btnStyle} onClick={() => performSeek(currentTimeMs - 5000)}>⏪</button>\r\n                    <button style={btnStyle} onClick={() => playerState === PlayerStates.PLAYING ? playerRef.current?.pause() : playerRef.current?.play()}>\r\n                        {playerState === PlayerStates.PLAYING ? \"PAUSE\" : \"PLAY\"}\r\n                    </button>\r\n                    <button style={btnStyle} onClick={() => performSeek(currentTimeMs + 5000)}>⏩</button>\r\n                    <span style={{ flex: 1, textAlign: 'center', fontFamily: 'monospace' }}>\r\n                        {new Date(currentTimeMs).toLocaleTimeString()}\r\n                    </span>\r\n                    <button style={btnStyle} onClick={fitDay}>24H</button>\r\n                </div>\r\n\r\n                <div className=\"timeline-area\" ref={timelineRef}\r\n                    style={{ height: 100, background: THEME.rulerBg, position: 'relative', overflow: 'hidden' }}\r\n                    onMouseUp={handleMouseUp} onMouseLeave={handleMouseUp} onMouseMove={handleMouseMove} onMouseDown={handleMouseDown} onWheel={handleWheel}\r\n                >\r\n                    <div style={{ height: 25, borderBottom: '1px solid #444' }}>{renderRuler()}</div>\r\n                    <div style={{ position: 'relative', top: 5, height: 40 }}>\r\n                        {segments.map((s, i) => {\r\n                            const x = timeToPx(s.start);\r\n                            const w = Math.max(2, (s.end - s.start) / 1000 * zoomPxPerSec);\r\n                            if (x + w < 0 || x > containerWidth) return null;\r\n                            return <div key={i} style={{ position: 'absolute', left: x, width: w, height: '100%', background: THEME.segment }} />\r\n                        })}\r\n                    </div>\r\n                    <div style={{ position: 'absolute', left: timeToPx(currentTimeMs), top: 0, bottom: 0, width: 2, background: THEME.playhead, zIndex: 10 }} />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nconst btnStyle = { background: \"#444\", color: \"#fff\", border: \"none\", padding: \"4px 8px\", borderRadius: 3, cursor: \"pointer\" };\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,EAAEC,MAAM,EAAEC,eAAe,QAAQ,OAAO;AAC3E,SAASC,eAAe,EAAEC,WAAW,QAAQ,kBAAkB;AAC/D,OAAOC,GAAG,MAAM,QAAQ;AACxB,OAAOC,kBAAkB,IAAIC,YAAY,QAAQ,gCAAgC;;AAEjF;AAAA,SAAAC,MAAA,IAAAC,OAAA;AACA,MAAMC,KAAK,GAAG;EACVC,EAAE,EAAE,SAAS;EACbC,OAAO,EAAE,SAAS;EAClBC,MAAM,EAAE,SAAS;EACjBC,IAAI,EAAE,SAAS;EACfC,MAAM,EAAE,SAAS;EACjBC,OAAO,EAAE,SAAS;EAClBC,YAAY,EAAE,SAAS;EACvBC,OAAO,EAAE,SAAS;EAClBC,QAAQ,EAAE,SAAS;EACnBC,WAAW,EAAE,SAAS;EACtBC,YAAY,EAAE;AAClB,CAAC;AAED,eAAe,SAASC,cAAcA,CAAA,EAAG;EAAAC,EAAA;EACrC,MAAM,CAACC,YAAY,CAAC,GAAGrB,eAAe,CAAC,CAAC;EACxC,MAAMsB,QAAQ,GAAGrB,WAAW,CAAC,CAAC;EAC9B,MAAMsB,KAAK,GAAGF,YAAY,CAACG,GAAG,CAAC,OAAO,CAAC;;EAEvC;EACA,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,GAAG7B,QAAQ,CAAC,EAAE,CAAC;EAC1C,MAAM,CAAC8B,YAAY,EAAEC,eAAe,CAAC,GAAG/B,QAAQ,CAAC,IAAIgC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;EACxF,MAAM,CAACC,WAAW,EAAEC,cAAc,CAAC,GAAGpC,QAAQ,CAACO,YAAY,CAAC8B,IAAI,CAAC;EACjE,MAAM,CAACC,YAAY,EAAEC,eAAe,CAAC,GAAGvC,QAAQ,CAAC,GAAG,CAAC;;EAErD;EACA,MAAM,CAACwC,aAAa,EAAEC,gBAAgB,CAAC,GAAGzC,QAAQ,CAACgC,IAAI,CAACU,GAAG,CAAC,CAAC,CAAC;EAC9D,MAAM,CAACC,eAAe,EAAEC,kBAAkB,CAAC,GAAG5C,QAAQ,CAAC,IAAIgC,IAAI,CAAC,CAAC,CAACa,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;EACvF,MAAM,CAACC,YAAY,EAAEC,eAAe,CAAC,GAAG/C,QAAQ,CAAC,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC;EAChE,MAAM,CAACgD,cAAc,EAAEC,iBAAiB,CAAC,GAAGjD,QAAQ,CAAC,IAAI,CAAC;EAC1D,MAAM,CAACkD,QAAQ,EAAEC,WAAW,CAAC,GAAGnD,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACoD,aAAa,EAAEC,gBAAgB,CAAC,GAAGrD,QAAQ,CAAC,KAAK,CAAC;EAEzD,MAAMsD,QAAQ,GAAGrD,MAAM,CAAC,IAAI,CAAC;EAC7B,MAAMsD,SAAS,GAAGtD,MAAM,CAAC,IAAI,CAAC;EAC9B,MAAMuD,WAAW,GAAGvD,MAAM,CAAC,IAAI,CAAC;EAChC,MAAMwD,OAAO,GAAGxD,MAAM,CAAC;IAAEyD,UAAU,EAAE,KAAK;IAAEC,MAAM,EAAE,CAAC;IAAEC,aAAa,EAAE;EAAE,CAAC,CAAC;EAE1E,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAG9D,QAAQ,CAAC;IAAE+D,KAAK,EAAE,IAAI;IAAEC,GAAG,EAAE;EAAK,CAAC,CAAC;;EAEpE;EACAjE,SAAS,CAAC,MAAM;IACZ;IACAM,GAAG,CAACsB,GAAG,CAAC,UAAU,CAAC,CAACsC,IAAI,CAACC,GAAG,IAAI;MAC5B,MAAMC,IAAI,GAAGC,KAAK,CAACC,OAAO,CAACH,GAAG,CAACI,IAAI,CAAC,GAAGJ,GAAG,CAACI,IAAI,GAAG,EAAE;MACpDzC,UAAU,CAACsC,IAAI,CAAC;IACpB,CAAC,CAAC,CAACI,KAAK,CAACC,OAAO,CAACC,KAAK,CAAC;EAC3B,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA1E,SAAS,CAAC,MAAM;IACZ,IAAI,CAAC2B,KAAK,EAAE;IACZrB,GAAG,CAACsB,GAAG,CAAC,uBAAuBD,KAAK,EAAE,CAAC,CAACuC,IAAI,CAACC,GAAG,IAAI;MAChDJ,WAAW,CAACI,GAAG,CAACI,IAAI,CAAC;IACzB,CAAC,CAAC,CAACC,KAAK,CAACC,OAAO,CAACC,KAAK,CAAC;EAC3B,CAAC,EAAE,CAAC/C,KAAK,CAAC,CAAC;;EAEX;;EAEA3B,SAAS,CAAC,MAAM;IACZ,IAAI+B,YAAY,EAAE;MACd,MAAMiC,KAAK,GAAG,IAAI/B,IAAI,CAACF,YAAY,CAAC,CAACe,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;MACzDD,kBAAkB,CAACmB,KAAK,CAAC;MACzB;MACAtB,gBAAgB,CAACsB,KAAK,GAAG,QAAQ,GAAG,CAAC,CAAC,CAAC,CAAC;IAC5C;EACJ,CAAC,EAAE,CAACjC,YAAY,CAAC,CAAC;EAElB5B,eAAe,CAAC,MAAM;IAClB,IAAI,CAACsD,WAAW,CAACkB,OAAO,EAAE;IAC1B;IACA,MAAMC,EAAE,GAAG,IAAIC,cAAc,CAACC,OAAO,IAAI;MACrC,KAAK,IAAIC,KAAK,IAAID,OAAO,EAAE;QACvB,IAAIC,KAAK,CAACC,WAAW,CAACC,KAAK,GAAG,CAAC,EAAE/B,iBAAiB,CAAC6B,KAAK,CAACC,WAAW,CAACC,KAAK,CAAC;MAC/E;IACJ,CAAC,CAAC;IACFL,EAAE,CAACM,OAAO,CAACzB,WAAW,CAACkB,OAAO,CAAC;IAC/B;IACAzB,iBAAiB,CAACO,WAAW,CAACkB,OAAO,CAACQ,WAAW,IAAI,IAAI,CAAC;IAC1D,OAAO,MAAMP,EAAE,CAACQ,UAAU,CAAC,CAAC;EAChC,CAAC,EAAE,EAAE,CAAC;EAENpF,SAAS,CAAC,MAAM;IACZ,IAAIuD,QAAQ,CAACoB,OAAO,IAAIhD,KAAK,EAAE;MAC3B6B,SAAS,CAACmB,OAAO,GAAG,IAAIpE,kBAAkB,CAACgD,QAAQ,CAACoB,OAAO,EAAEhD,KAAK,EAAG0D,CAAC,IAAKhD,cAAc,CAACgD,CAAC,CAAC,CAAC;MAC7F,OAAO;QAAA,IAAAC,kBAAA;QAAA,QAAAA,kBAAA,GAAM9B,SAAS,CAACmB,OAAO,cAAAW,kBAAA,uBAAjBA,kBAAA,CAAmBC,OAAO,CAAC,CAAC;MAAA;IAC7C;EACJ,CAAC,EAAE,CAAC5D,KAAK,CAAC,CAAC;EAEX3B,SAAS,CAAC,MAAM;IACZ,IAAI,CAAC2B,KAAK,IAAI,CAACI,YAAY,EAAE;IAC7B,MAAMyD,SAAS,GAAG,MAAAA,CAAA,KAAY;MAC1BlC,gBAAgB,CAAC,IAAI,CAAC;MACtBF,WAAW,CAAC,EAAE,CAAC;MACf,IAAI;QACA,MAAMe,GAAG,GAAG,MAAM7D,GAAG,CAACsB,GAAG,CAAC,8BAA8BD,KAAK,IAAII,YAAY,EAAE,CAAC;QAChF,MAAMwC,IAAI,GAAGJ,GAAG,CAACI,IAAI;QACrB,MAAMkB,cAAc,GAAGlB,IAAI,CAACmB,QAAQ;QAEpC,MAAMC,aAAa,GAAG,IAAI1D,IAAI,CAACF,YAAY,CAAC,CAACe,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACjE,IAAI8C,UAAU,GAAG,CAAC;QAClB,IAAIH,cAAc,GAAG,CAAC,EAAE;UACpBG,UAAU,GAAGD,aAAa,GAAGF,cAAc;QAC/C;QAEA,MAAMI,IAAI,GAAG,CAACtB,IAAI,CAACpB,QAAQ,IAAI,EAAE,EAAE2C,GAAG,CAACT,CAAC,KAAK;UACzCrB,KAAK,EAAE+B,MAAM,CAACV,CAAC,CAACW,QAAQ,CAAC,GAAGJ,UAAU;UACtC3B,GAAG,EAAE8B,MAAM,CAACV,CAAC,CAACY,MAAM,CAAC,GAAGL,UAAU;UAClCM,IAAI,EAAE;QACV,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKD,CAAC,CAACpC,KAAK,GAAGqC,CAAC,CAACrC,KAAK,CAAC;QAErCZ,WAAW,CAACyC,IAAI,CAAC;QACjB,IAAIrC,SAAS,CAACmB,OAAO,EAAEnB,SAAS,CAACmB,OAAO,CAAC2B,YAAY,CAACT,IAAI,CAAC;QAE3DhD,kBAAkB,CAAC8C,aAAa,CAAC;QACjC,IAAI1C,cAAc,GAAG,CAAC,EAAED,eAAe,CAACC,cAAc,GAAG,KAAK,CAAC;MAEnE,CAAC,CAAC,OAAOsD,CAAC,EAAE;QAAE9B,OAAO,CAACC,KAAK,CAAC6B,CAAC,CAAC;MAAE,CAAC,SAAS;QAAEjD,gBAAgB,CAAC,KAAK,CAAC;MAAE;IACzE,CAAC;IACDkC,SAAS,CAAC,CAAC;EACf,CAAC,EAAE,CAAC7D,KAAK,EAAEI,YAAY,EAAEkB,cAAc,CAAC,CAAC;;EAEzC;EACAjD,SAAS,CAAC,MAAM;IACZ,MAAMwG,CAAC,GAAGC,WAAW,CAAC,MAAM;MACxB,IAAIrE,WAAW,KAAK5B,YAAY,CAACkG,OAAO,IAAIlD,SAAS,CAACmB,OAAO,EAAE;QAC3D,MAAMhC,GAAG,GAAGa,SAAS,CAACmB,OAAO,CAACgC,cAAc,CAAC,CAAC;QAC9C,IAAIC,IAAI,CAACC,GAAG,CAAClE,GAAG,GAAGF,aAAa,CAAC,GAAG,GAAG,EAAEC,gBAAgB,CAACC,GAAG,CAAC;;QAE9D;QACA,MAAMmE,UAAU,GAAG3D,QAAQ,CAAC4D,IAAI,CAAC1B,CAAC,IAAI1C,GAAG,IAAI0C,CAAC,CAACrB,KAAK,IAAIrB,GAAG,GAAG0C,CAAC,CAACpB,GAAG,CAAC;QACpE,IAAI6C,UAAU,IAAKA,UAAU,CAAC7C,GAAG,GAAGtB,GAAG,GAAI,GAAG,EAAE;UAC5C,MAAMqE,OAAO,GAAG7D,QAAQ,CAAC4D,IAAI,CAAC1B,CAAC,IAAIA,CAAC,CAACrB,KAAK,IAAI8C,UAAU,CAAC7C,GAAG,CAAC;UAC7D,IAAI+C,OAAO,IAAIA,OAAO,CAAChD,KAAK,GAAG8C,UAAU,CAAC7C,GAAG,GAAG,IAAI,EAAE;YAClDT,SAAS,CAACmB,OAAO,CAACsC,MAAM,CAACD,OAAO,CAAChD,KAAK,CAAC;UAC3C;QACJ;MACJ;IACJ,CAAC,EAAE,GAAG,CAAC;IACP,OAAO,MAAMkD,aAAa,CAACV,CAAC,CAAC;EACjC,CAAC,EAAE,CAACpE,WAAW,EAAEK,aAAa,EAAEU,QAAQ,CAAC,CAAC;;EAE1C;EACA,MAAMgE,iBAAiB,GAAIC,EAAE,IAAK;IAC9B1F,QAAQ,CAAC,mBAAmB0F,EAAE,EAAE,CAAC;EACrC,CAAC;EAED,MAAMC,WAAW,GAAIC,EAAE,IAAK;IAAA,IAAAC,mBAAA;IACxB7E,gBAAgB,CAAC4E,EAAE,CAAC;IACpB,CAAAC,mBAAA,GAAA/D,SAAS,CAACmB,OAAO,cAAA4C,mBAAA,uBAAjBA,mBAAA,CAAmBN,MAAM,CAACK,EAAE,CAAC;EACjC,CAAC;EAED,MAAME,MAAM,GAAGA,CAAA,KAAM;IACjB,MAAMxD,KAAK,GAAG,IAAI/B,IAAI,CAACF,YAAY,CAAC,CAACe,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACzDD,kBAAkB,CAACmB,KAAK,CAAC;IACzBhB,eAAe,CAACC,cAAc,GAAG,KAAK,CAAC;EAC3C,CAAC;;EAED;EACA,MAAMwE,eAAe,GAAIlB,CAAC,IAAK;IAC3B7C,OAAO,CAACiB,OAAO,GAAG;MAAEhB,UAAU,EAAE,IAAI;MAAEC,MAAM,EAAE2C,CAAC,CAACmB,OAAO;MAAE7D,aAAa,EAAEjB;IAAgB,CAAC;EAC7F,CAAC;EAED,MAAM+E,eAAe,GAAIpB,CAAC,IAAK;IAC3B,IAAI,CAAC7C,OAAO,CAACiB,OAAO,CAAChB,UAAU,EAAE;IACjC,MAAMiE,EAAE,GAAGrB,CAAC,CAACmB,OAAO,GAAGhE,OAAO,CAACiB,OAAO,CAACf,MAAM;IAC7C,MAAMiE,EAAE,GAAG,EAAED,EAAE,GAAG7E,YAAY,CAAC,GAAG,IAAI;IAEtC,IAAI+E,QAAQ,GAAGpE,OAAO,CAACiB,OAAO,CAACd,aAAa,GAAGgE,EAAE;;IAEjD;IACA,MAAMnC,QAAQ,GAAG,IAAIzD,IAAI,CAACF,YAAY,CAAC,CAACe,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IAC5D,MAAMiF,MAAM,GAAGrC,QAAQ,GAAG,QAAQ;;IAElC;IACA;IACA;IACA,IAAIoC,QAAQ,GAAGpC,QAAQ,EAAEoC,QAAQ,GAAGpC,QAAQ;IAC5C,IAAIoC,QAAQ,GAAGC,MAAM,GAAI9E,cAAc,GAAGF,YAAY,GAAG,IAAK,EAAE;MAC5D;MACA;MACA;MACA;IAAA;IAEJF,kBAAkB,CAACiF,QAAQ,CAAC;EAChC,CAAC;EAED,MAAME,aAAa,GAAIzB,CAAC,IAAK;IACzB7C,OAAO,CAACiB,OAAO,CAAChB,UAAU,GAAG,KAAK;IAClC,IAAIiD,IAAI,CAACC,GAAG,CAACN,CAAC,CAACmB,OAAO,GAAGhE,OAAO,CAACiB,OAAO,CAACf,MAAM,CAAC,GAAG,CAAC,EAAE;MAClD,MAAMqE,IAAI,GAAGxE,WAAW,CAACkB,OAAO,CAACuD,qBAAqB,CAAC,CAAC;MACxD,MAAMC,MAAM,GAAG5B,CAAC,CAACmB,OAAO,GAAGO,IAAI,CAACG,IAAI;MACpC,MAAMd,EAAE,GAAG1E,eAAe,GAAIuF,MAAM,GAAGpF,YAAY,GAAI,IAAI;MAC3DsE,WAAW,CAACC,EAAE,CAAC;IACnB;EACJ,CAAC;EAED,MAAMe,WAAW,GAAI9B,CAAC,IAAK;IACvB,IAAIA,CAAC,CAAC+B,MAAM,CAACC,OAAO,CAAC,gBAAgB,CAAC,EAAE;MACpChC,CAAC,CAACiC,cAAc,CAAC,CAAC;MAClB,MAAMP,IAAI,GAAGxE,WAAW,CAACkB,OAAO,CAACuD,qBAAqB,CAAC,CAAC;MACxD,MAAMO,MAAM,GAAGlC,CAAC,CAACmB,OAAO,GAAGO,IAAI,CAACG,IAAI;MACpC,MAAMM,cAAc,GAAG9F,eAAe,GAAI6F,MAAM,GAAG1F,YAAY,GAAI,IAAI;MACvE,MAAM4F,MAAM,GAAGpC,CAAC,CAACqC,MAAM,GAAG,CAAC,GAAG,GAAG,GAAG,GAAG;MACvC,MAAMC,OAAO,GAAGjC,IAAI,CAACkC,GAAG,CAAC7F,cAAc,GAAG,KAAK,EAAE2D,IAAI,CAACmC,GAAG,CAAC,GAAG,EAAEhG,YAAY,GAAG4F,MAAM,CAAC,CAAC;;MAEtF;MACA,IAAIb,QAAQ,GAAGY,cAAc,GAAID,MAAM,GAAGI,OAAO,GAAI,IAAI;;MAEzD;MACA,MAAMnD,QAAQ,GAAG,IAAIzD,IAAI,CAACF,YAAY,CAAC,CAACe,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;MAC5D,IAAIgF,QAAQ,GAAGpC,QAAQ,EAAEoC,QAAQ,GAAGpC,QAAQ;MAE5C1C,eAAe,CAAC6F,OAAO,CAAC;MACxBhG,kBAAkB,CAACiF,QAAQ,CAAC;IAChC;EACJ,CAAC;;EAED;EACA,MAAMkB,QAAQ,GAAIC,CAAC,IAAK,CAACA,CAAC,GAAGrG,eAAe,IAAI,IAAI,GAAGG,YAAY;EAEnE,MAAMmG,WAAW,GAAGA,CAAA,KAAM;IACtB,MAAMC,KAAK,GAAG,EAAE;IAChB,MAAMC,MAAM,GAAI,IAAI,GAAG,IAAK,CAAC,CAAC;IAC9B,MAAM1D,QAAQ,GAAG,IAAIzD,IAAI,CAACF,YAAY,CAAC,CAACe,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IAE5D,KAAK,IAAI0D,CAAC,GAAG,CAAC,EAAEA,CAAC,IAAI,EAAE,EAAEA,CAAC,EAAE,EAAE;MAC1B,MAAMyC,CAAC,GAAGvD,QAAQ,GAAGc,CAAC,GAAG4C,MAAM;MAC/B,MAAMC,CAAC,GAAGL,QAAQ,CAACC,CAAC,CAAC;MACrB,IAAII,CAAC,GAAG,CAAC,EAAE,IAAIA,CAAC,GAAGpG,cAAc,EAAE;MACnCkG,KAAK,CAACG,IAAI,cACN5I,OAAA;QAAa6I,KAAK,EAAE;UAAEC,QAAQ,EAAE,UAAU;UAAEpB,IAAI,EAAEiB,CAAC;UAAEI,GAAG,EAAE,CAAC;UAAEC,MAAM,EAAE,EAAE;UAAEC,UAAU,EAAE;QAAiB,CAAE;QAAAC,QAAA,eACpGlJ,OAAA;UAAK6I,KAAK,EAAE;YAAEC,QAAQ,EAAE,UAAU;YAAEC,GAAG,EAAE,CAAC;YAAErB,IAAI,EAAE,CAAC;YAAEyB,QAAQ,EAAE,EAAE;YAAEC,KAAK,EAAE;UAAO,CAAE;UAAAF,QAAA,GAAEpD,CAAC,EAAC,KAAG;QAAA;UAAAuD,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK;MAAC,GAD1F1D,CAAC;QAAAuD,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAEN,CACT,CAAC;IACL;IACA,OAAOf,KAAK;EAChB,CAAC;EAED,oBACIzI,OAAA;IAAK6I,KAAK,EAAE;MAAEY,OAAO,EAAE,MAAM;MAAEX,QAAQ,EAAE,OAAO;MAAEC,GAAG,EAAE,CAAC;MAAErB,IAAI,EAAE,CAAC;MAAEgC,KAAK,EAAE,CAAC;MAAEC,MAAM,EAAE,CAAC;MAAEC,UAAU,EAAE3J,KAAK,CAACC,EAAE;MAAEkJ,KAAK,EAAEnJ,KAAK,CAACI;IAAK,CAAE;IAAA6I,QAAA,gBAG9HlJ,OAAA;MAAK6I,KAAK,EAAE;QAAEtE,KAAK,EAAE,GAAG;QAAEqF,UAAU,EAAE3J,KAAK,CAACE,OAAO;QAAE0J,WAAW,EAAE,aAAa5J,KAAK,CAACU,WAAW,EAAE;QAAE8I,OAAO,EAAE,MAAM;QAAEK,aAAa,EAAE;MAAS,CAAE;MAAAZ,QAAA,gBAC3IlJ,OAAA;QAAK6I,KAAK,EAAE;UAAEkB,OAAO,EAAE,EAAE;UAAEC,UAAU,EAAE,MAAM;UAAEC,YAAY,EAAE,aAAahK,KAAK,CAACU,WAAW;QAAG,CAAE;QAAAuI,QAAA,EAAC;MAAQ;QAAAG,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eAC/GxJ,OAAA;QAAK6I,KAAK,EAAE;UAAEqB,IAAI,EAAE,CAAC;UAAEC,SAAS,EAAE;QAAO,CAAE;QAAAjB,QAAA,GACtC/H,OAAO,CAACiE,GAAG,CAACgF,GAAG,iBACZpK,OAAA;UACIqK,OAAO,EAAEA,CAAA,KAAM5D,iBAAiB,CAAC2D,GAAG,CAAC1D,EAAE,CAAE;UACzCmC,KAAK,EAAE;YACHkB,OAAO,EAAE,UAAU;YAAEO,MAAM,EAAE,SAAS;YAAEnB,QAAQ,EAAE,EAAE;YACpDS,UAAU,EAAE3I,KAAK,KAAKmJ,GAAG,CAAC1D,EAAE,GAAGzG,KAAK,CAACW,YAAY,GAAG,aAAa;YACjEwI,KAAK,EAAEnI,KAAK,KAAKmJ,GAAG,CAAC1D,EAAE,GAAG,MAAM,GAAG;UACvC,CAAE;UAAAwC,QAAA,EACDkB,GAAG,CAACG,IAAI,IAAIH,GAAG,CAAC1D;QAAE,GAPb0D,GAAG,CAAC1D,EAAE;UAAA2C,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAQX,CACR,CAAC,EACDrI,OAAO,CAACqJ,MAAM,KAAK,CAAC,iBAAIxK,OAAA;UAAK6I,KAAK,EAAE;YAAEkB,OAAO,EAAE,EAAE;YAAEX,KAAK,EAAE;UAAO,CAAE;UAAAF,QAAA,EAAC;QAAgB;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC1F,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL,CAAC,eAGNxJ,OAAA;MAAK6I,KAAK,EAAE;QAAEqB,IAAI,EAAE,CAAC;QAAET,OAAO,EAAE,MAAM;QAAEK,aAAa,EAAE;MAAS,CAAE;MAAAZ,QAAA,gBAC9DlJ,OAAA;QAAQ6I,KAAK,EAAE;UAAEG,MAAM,EAAE,EAAE;UAAEY,UAAU,EAAE3J,KAAK,CAACG,MAAM;UAAEqJ,OAAO,EAAE,MAAM;UAAEgB,UAAU,EAAE,QAAQ;UAAEV,OAAO,EAAE,QAAQ;UAAEE,YAAY,EAAE,aAAahK,KAAK,CAACU,WAAW;QAAG,CAAE;QAAAuI,QAAA,gBAC9JlJ,OAAA;UAAM6I,KAAK,EAAE;YAAEmB,UAAU,EAAE,MAAM;YAAEZ,KAAK,EAAEnJ,KAAK,CAACK;UAAO,CAAE;UAAA4I,QAAA,EAAC;QAAQ;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,EACxEpG,QAAQ,CAACE,KAAK,iBACXtD,OAAA;UAAM6I,KAAK,EAAE;YAAE6B,UAAU,EAAE,EAAE;YAAEvB,QAAQ,EAAE,EAAE;YAAEC,KAAK,EAAE;UAAO,CAAE;UAAAF,QAAA,GAAC,cAC9C,EAAC,IAAI3H,IAAI,CAAC6B,QAAQ,CAACE,KAAK,CAAC,CAACqH,kBAAkB,CAAC,CAAC,EAAC,KAAG,EAAC,IAAIpJ,IAAI,CAAC6B,QAAQ,CAACG,GAAG,CAAC,CAACoH,kBAAkB,CAAC,CAAC;QAAA;UAAAtB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACxG,CACT,eACDxJ,OAAA;UAAK6I,KAAK,EAAE;YAAEqB,IAAI,EAAE;UAAE;QAAE;UAAAb,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,eAC3BxJ,OAAA;UAAOwF,IAAI,EAAC,MAAM;UAACoF,KAAK,EAAEvJ,YAAa;UAACwJ,QAAQ,EAAEhF,CAAC,IAAIvE,eAAe,CAACuE,CAAC,CAAC+B,MAAM,CAACgD,KAAK,CAAE;UACnF/B,KAAK,EAAE;YAAEe,UAAU,EAAE,MAAM;YAAER,KAAK,EAAE,MAAM;YAAE0B,MAAM,EAAE,MAAM;YAAEC,YAAY,EAAE,CAAC;YAAEhB,OAAO,EAAE;UAAM;QAAE;UAAAV,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACjG,CAAC,eAETxJ,OAAA;QAAK6I,KAAK,EAAE;UAAEqB,IAAI,EAAE,CAAC;UAAEpB,QAAQ,EAAE,UAAU;UAAEc,UAAU,EAAE,MAAM;UAAEoB,QAAQ,EAAE,QAAQ;UAAEC,SAAS,EAAE;QAAE,CAAE;QAAA/B,QAAA,gBAChGlJ,OAAA;UAAOkL,GAAG,EAAErI,QAAS;UAACgG,KAAK,EAAE;YAAEC,QAAQ,EAAE,UAAU;YAAEC,GAAG,EAAE,CAAC;YAAErB,IAAI,EAAE,CAAC;YAAEnD,KAAK,EAAE,MAAM;YAAEyE,MAAM,EAAE,MAAM;YAAEmC,SAAS,EAAE;UAAU;QAAE;UAAA9B,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,EAC9H,CAACvI,KAAK,iBAAIjB,OAAA;UAAK6I,KAAK,EAAE;YAAEC,QAAQ,EAAE,UAAU;YAAEC,GAAG,EAAE,KAAK;YAAErB,IAAI,EAAE,KAAK;YAAE0D,SAAS,EAAE,uBAAuB;YAAEhC,KAAK,EAAE;UAAO,CAAE;UAAAF,QAAA,EAAC;QAAe;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACjJ,CAAC,eAENxJ,OAAA;QAAK6I,KAAK,EAAE;UAAEG,MAAM,EAAE,EAAE;UAAEY,UAAU,EAAE,SAAS;UAAEH,OAAO,EAAE,MAAM;UAAEgB,UAAU,EAAE,QAAQ;UAAEV,OAAO,EAAE,QAAQ;UAAEsB,GAAG,EAAE;QAAG,CAAE;QAAAnC,QAAA,gBACjHlJ,OAAA;UAAQ6I,KAAK,EAAEyC,QAAS;UAACjB,OAAO,EAAEA,CAAA,KAAM1D,WAAW,CAAC5E,aAAa,GAAG,IAAI,CAAE;UAAAmH,QAAA,EAAC;QAAC;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eACrFxJ,OAAA;UAAQ6I,KAAK,EAAEyC,QAAS;UAACjB,OAAO,EAAEA,CAAA;YAAA,IAAAkB,mBAAA,EAAAC,mBAAA;YAAA,OAAM9J,WAAW,KAAK5B,YAAY,CAACkG,OAAO,IAAAuF,mBAAA,GAAGzI,SAAS,CAACmB,OAAO,cAAAsH,mBAAA,uBAAjBA,mBAAA,CAAmBE,KAAK,CAAC,CAAC,IAAAD,mBAAA,GAAG1I,SAAS,CAACmB,OAAO,cAAAuH,mBAAA,uBAAjBA,mBAAA,CAAmBE,IAAI,CAAC,CAAC;UAAA,CAAC;UAAAxC,QAAA,EACjIxH,WAAW,KAAK5B,YAAY,CAACkG,OAAO,GAAG,OAAO,GAAG;QAAM;UAAAqD,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACpD,CAAC,eACTxJ,OAAA;UAAQ6I,KAAK,EAAEyC,QAAS;UAACjB,OAAO,EAAEA,CAAA,KAAM1D,WAAW,CAAC5E,aAAa,GAAG,IAAI,CAAE;UAAAmH,QAAA,EAAC;QAAC;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eACrFxJ,OAAA;UAAM6I,KAAK,EAAE;YAAEqB,IAAI,EAAE,CAAC;YAAEyB,SAAS,EAAE,QAAQ;YAAEC,UAAU,EAAE;UAAY,CAAE;UAAA1C,QAAA,EAClE,IAAI3H,IAAI,CAACQ,aAAa,CAAC,CAAC8J,kBAAkB,CAAC;QAAC;UAAAxC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC3C,CAAC,eACPxJ,OAAA;UAAQ6I,KAAK,EAAEyC,QAAS;UAACjB,OAAO,EAAEvD,MAAO;UAAAoC,QAAA,EAAC;QAAG;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACrD,CAAC,eAENxJ,OAAA;QAAK8L,SAAS,EAAC,eAAe;QAACZ,GAAG,EAAEnI,WAAY;QAC5C8F,KAAK,EAAE;UAAEG,MAAM,EAAE,GAAG;UAAEY,UAAU,EAAE3J,KAAK,CAACQ,OAAO;UAAEqI,QAAQ,EAAE,UAAU;UAAEkC,QAAQ,EAAE;QAAS,CAAE;QAC5Fe,SAAS,EAAEzE,aAAc;QAAC0E,YAAY,EAAE1E,aAAc;QAAC2E,WAAW,EAAEhF,eAAgB;QAACiF,WAAW,EAAEnF,eAAgB;QAACoF,OAAO,EAAExE,WAAY;QAAAuB,QAAA,gBAExIlJ,OAAA;UAAK6I,KAAK,EAAE;YAAEG,MAAM,EAAE,EAAE;YAAEiB,YAAY,EAAE;UAAiB,CAAE;UAAAf,QAAA,EAAEV,WAAW,CAAC;QAAC;UAAAa,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eACjFxJ,OAAA;UAAK6I,KAAK,EAAE;YAAEC,QAAQ,EAAE,UAAU;YAAEC,GAAG,EAAE,CAAC;YAAEC,MAAM,EAAE;UAAG,CAAE;UAAAE,QAAA,EACpDzG,QAAQ,CAAC2C,GAAG,CAAC,CAACT,CAAC,EAAEmB,CAAC,KAAK;YACpB,MAAM6C,CAAC,GAAGL,QAAQ,CAAC3D,CAAC,CAACrB,KAAK,CAAC;YAC3B,MAAM8I,CAAC,GAAGlG,IAAI,CAACkC,GAAG,CAAC,CAAC,EAAE,CAACzD,CAAC,CAACpB,GAAG,GAAGoB,CAAC,CAACrB,KAAK,IAAI,IAAI,GAAGjB,YAAY,CAAC;YAC9D,IAAIsG,CAAC,GAAGyD,CAAC,GAAG,CAAC,IAAIzD,CAAC,GAAGpG,cAAc,EAAE,OAAO,IAAI;YAChD,oBAAOvC,OAAA;cAAa6I,KAAK,EAAE;gBAAEC,QAAQ,EAAE,UAAU;gBAAEpB,IAAI,EAAEiB,CAAC;gBAAEpE,KAAK,EAAE6H,CAAC;gBAAEpD,MAAM,EAAE,MAAM;gBAAEY,UAAU,EAAE3J,KAAK,CAACM;cAAQ;YAAE,GAAjGuF,CAAC;cAAAuD,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAkG,CAAC;UACzH,CAAC;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACD,CAAC,eACNxJ,OAAA;UAAK6I,KAAK,EAAE;YAAEC,QAAQ,EAAE,UAAU;YAAEpB,IAAI,EAAEY,QAAQ,CAACvG,aAAa,CAAC;YAAEgH,GAAG,EAAE,CAAC;YAAEY,MAAM,EAAE,CAAC;YAAEpF,KAAK,EAAE,CAAC;YAAEqF,UAAU,EAAE3J,KAAK,CAACS,QAAQ;YAAE2L,MAAM,EAAE;UAAG;QAAE;UAAAhD,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC3I,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACL,CAAC;AAEd;AAAC1I,EAAA,CAxSuBD,cAAc;EAAA,QACXnB,eAAe,EACrBC,WAAW;AAAA;AAAA2M,EAAA,GAFRzL,cAAc;AA0StC,MAAMyK,QAAQ,GAAG;EAAE1B,UAAU,EAAE,MAAM;EAAER,KAAK,EAAE,MAAM;EAAE0B,MAAM,EAAE,MAAM;EAAEf,OAAO,EAAE,SAAS;EAAEgB,YAAY,EAAE,CAAC;EAAET,MAAM,EAAE;AAAU,CAAC;AAAC,IAAAgC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}