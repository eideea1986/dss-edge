{"ast":null,"code":"import React,{useEffect,useState,useRef}from\"react\";import{useSearchParams}from\"react-router-dom\";import API from\"../api\";import Hls from'hls.js';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const styles=\"\\n* { box-sizing: border-box; margin: 0; padding: 0; }\\nbody { background: #cfd2d6; }\\n.playback-page { height: 100vh; display: flex; flex-direction: column; background: #cfd2d6; font-family: Arial, sans-serif; }\\n.playback-header { height: 40px; background: #d9d9d9; display: flex; align-items: center; padding: 0 10px; gap: 8px; border-bottom: 1px solid #999; }\\n.video-viewport { height: calc(100vh - 140px); background: #000; display: flex; align-items: center; justify-content: center; position: relative; }\\nvideo { width: 100%; height: 100%; object-fit: contain; background: #000; }\\n.controls { height: 60px; background: #d9d9d9; display: flex; align-items: center; gap: 6px; padding: 0 8px; border-bottom: 1px solid #999; }\\n.timeline-area { height: 80px; background: #e6e6e6; border-top: 1px solid #999; position: relative; overflow: hidden; cursor: pointer; user-select: none; }\\n.time-markers { position: absolute; top: 0; left: 0; width: 100%; height: 20px; display: flex; pointer-events: none; border-bottom: 1px solid #ccc; }\\n.time-marker { flex: 1; border-left: 1px solid #999; font-size: 10px; color: #555; padding-left: 2px; height: 100%; }\\n.segments-track { position: absolute; top: 25px; height: 30px; left: 0; right: 0; background: rgba(0,0,0,0.05); }\\n.segment { position: absolute; height: 100%; background: #2ecc71; min-width: 2px; opacity: 0.8; }\\n.cursor { position: absolute; top: 0; height: 100%; width: 2px; background: red; z-index: 10; pointer-events: none; }\\nbutton { padding: 4px 10px; border: 1px solid #555; background: #f0f0f0; cursor: pointer; font-size: 13px; }\\nbutton:hover { background: #fff; }\\nbutton:disabled { color: #aaa; cursor: not-allowed; }\\n.info-text { font-size: 11px; color: #555; margin-left: 10px; }\\n\";export default function Playback(){const[params]=useSearchParams();const camId=params.get(\"camId\");// ----------------------------------------------------\n// 1. TIMELINE STATE (Global Day Overview)\n// ----------------------------------------------------\nconst[segments,setSegments]=useState([]);const[dayStart,setDayStart]=useState(0);const[selectedDate,setSelectedDate]=useState(()=>{// Default: Today's date YYYY-MM-DD\nconst d=new Date();const y=d.getFullYear();const m=String(d.getMonth()+1).padStart(2,'0');const day=String(d.getDate()).padStart(2,'0');return\"\".concat(y,\"-\").concat(m,\"-\").concat(day);});// ----------------------------------------------------\n// 2. PLAYBACK STATE (Streaming)\n// ----------------------------------------------------\nconst[isPlaying,setIsPlaying]=useState(false);const[isLoading,setIsLoading]=useState(false);const videoRef=useRef(null);const hlsRef=useRef(null);const cursorRef=useRef(null);const timelineRef=useRef(null);// FETCH TIMELINE (Strictly separated from playback)\nuseEffect(()=>{if(!camId||!selectedDate)return;console.log(\"[Timeline] Fetching FULL DAY: \".concat(selectedDate));API.get(\"/playback/timeline-day/\".concat(camId,\"/\").concat(selectedDate)).then(res=>{const{segments:raw,dayStart:ds}=res.data;setDayStart(ds);// Normalize to 0-1 for the 24h day\nconst daySpan=86400000;const norm=raw.filter(s=>s.start_ts>0).map(s=>({left:Math.max(0,(s.start_ts-ds)/daySpan),width:(s.end_ts-s.start_ts)/daySpan,// Keep original TS for seek\nts:s.start_ts}));setSegments(norm);console.log(\"[Timeline] Loaded \".concat(norm.length,\" segments\"));}).catch(e=>console.error(e));},[camId,selectedDate]);// HLS Helper\nconst waitForHls=async function(url){let retries=arguments.length>1&&arguments[1]!==undefined?arguments[1]:30;for(let i=0;i<retries;i++){try{const res=await fetch(url,{method:'HEAD'});if(res.ok)return true;}catch(_unused){/* ignore */}await new Promise(r=>setTimeout(r,500));}return false;};// START PLAYBACK (Does NOT touch timeline state)\nconst play=async startTime=>{if(!startTime&&segments.length>0)startTime=segments[0].ts;if(!startTime)return alert(\"Nimic de redat azi\");setIsLoading(true);try{await stop();// Stop current\nconsole.log(\"[Playback] Req: \".concat(new Date(startTime).toLocaleTimeString()));const res=await API.post('/playback/start',{camId,from:startTime,to:Date.now(),// Play until NOW\nspeed:1});const hlsUrl=\"http://192.168.120.208:8080\".concat(res.data.hlsUrl);if(!(await waitForHls(hlsUrl)))throw new Error(\"HLS Timeout\");if(Hls.isSupported()){const hls=new Hls();hls.loadSource(hlsUrl);hls.attachMedia(videoRef.current);hls.on(Hls.Events.MANIFEST_PARSED,()=>videoRef.current.play().catch(console.error));hlsRef.current=hls;}else if(videoRef.current.canPlayType('application/vnd.apple.mpegurl')){videoRef.current.src=hlsUrl;videoRef.current.play();}setIsPlaying(true);}catch(e){alert(e.message);}finally{setIsLoading(false);}};const stop=async()=>{try{API.post('/playback/stop',{camId});if(hlsRef.current){hlsRef.current.destroy();hlsRef.current=null;}if(videoRef.current){videoRef.current.pause();videoRef.current.removeAttribute('src');videoRef.current.load();}setIsPlaying(false);}catch(e){console.error(e);}};// TIMELINE CLICK (Seek)\nconst handleSeek=e=>{const rect=timelineRef.current.getBoundingClientRect();const ratio=(e.clientX-rect.left)/rect.width;if(cursorRef.current)cursorRef.current.style.left=ratio*100+\"%\";// Map ratio (0-1) to Day Timestamp\nconst seekTs=Math.floor(dayStart+ratio*86400000);console.log(\"[Seek] \".concat(new Date(seekTs).toLocaleTimeString()));play(seekTs);};return/*#__PURE__*/_jsxs(\"div\",{className:\"playback-page\",children:[/*#__PURE__*/_jsx(\"style\",{children:styles}),/*#__PURE__*/_jsxs(\"div\",{className:\"playback-header\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.location.href='/',children:\"\\u2190 \\xCEnapoi\"}),/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:600},children:camId}),/*#__PURE__*/_jsxs(\"span\",{className:\"info-text\",children:[\"Data: \",selectedDate,\" | Segmente: \",segments.length]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"video-viewport\",children:/*#__PURE__*/_jsx(\"video\",{ref:videoRef,controls:true,autoPlay:true,muted:true,playsInline:true})}),/*#__PURE__*/_jsx(\"div\",{className:\"controls\",children:!isPlaying?/*#__PURE__*/_jsx(\"button\",{onClick:()=>play(),disabled:isLoading,children:isLoading?\"Încărcare...\":\"▶ REDĂ\"}):/*#__PURE__*/_jsx(\"button\",{onClick:stop,children:\"\\u25A0 OPRIRE\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"timeline-area\",ref:timelineRef,onClick:handleSeek,children:[/*#__PURE__*/_jsx(\"div\",{className:\"time-markers\",children:Array.from({length:24},(_,i)=>i).map(h=>/*#__PURE__*/_jsx(\"div\",{className:\"time-marker\",children:h},h))}),/*#__PURE__*/_jsx(\"div\",{className:\"segments-track\",children:segments.map((s,i)=>/*#__PURE__*/_jsx(\"div\",{className:\"segment\",style:{left:\"\".concat(s.left*100,\"%\"),width:\"\".concat(Math.max(s.width*100,0.2),\"%\")// min 0.2% width\n}},i))}),/*#__PURE__*/_jsx(\"div\",{ref:cursorRef,className:\"cursor\",style:{left:'0%'}})]})]});}","map":{"version":3,"names":["React","useEffect","useState","useRef","useSearchParams","API","Hls","jsx","_jsx","jsxs","_jsxs","styles","Playback","params","camId","get","segments","setSegments","dayStart","setDayStart","selectedDate","setSelectedDate","d","Date","y","getFullYear","m","String","getMonth","padStart","day","getDate","concat","isPlaying","setIsPlaying","isLoading","setIsLoading","videoRef","hlsRef","cursorRef","timelineRef","console","log","then","res","raw","ds","data","daySpan","norm","filter","s","start_ts","map","left","Math","max","width","end_ts","ts","length","catch","e","error","waitForHls","url","retries","arguments","undefined","i","fetch","method","ok","_unused","Promise","r","setTimeout","play","startTime","alert","stop","toLocaleTimeString","post","from","to","now","speed","hlsUrl","Error","isSupported","hls","loadSource","attachMedia","current","on","Events","MANIFEST_PARSED","canPlayType","src","message","destroy","pause","removeAttribute","load","handleSeek","rect","getBoundingClientRect","ratio","clientX","style","seekTs","floor","className","children","onClick","window","location","href","fontWeight","ref","controls","autoPlay","muted","playsInline","disabled","Array","_","h"],"sources":["I:/dispecerat/github_release/dss-edge/local-ui/src/pages/Playback.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\r\nimport { useSearchParams } from \"react-router-dom\";\r\nimport API from \"../api\";\r\nimport Hls from 'hls.js';\r\n\r\nconst styles = `\r\n* { box-sizing: border-box; margin: 0; padding: 0; }\r\nbody { background: #cfd2d6; }\r\n.playback-page { height: 100vh; display: flex; flex-direction: column; background: #cfd2d6; font-family: Arial, sans-serif; }\r\n.playback-header { height: 40px; background: #d9d9d9; display: flex; align-items: center; padding: 0 10px; gap: 8px; border-bottom: 1px solid #999; }\r\n.video-viewport { height: calc(100vh - 140px); background: #000; display: flex; align-items: center; justify-content: center; position: relative; }\r\nvideo { width: 100%; height: 100%; object-fit: contain; background: #000; }\r\n.controls { height: 60px; background: #d9d9d9; display: flex; align-items: center; gap: 6px; padding: 0 8px; border-bottom: 1px solid #999; }\r\n.timeline-area { height: 80px; background: #e6e6e6; border-top: 1px solid #999; position: relative; overflow: hidden; cursor: pointer; user-select: none; }\r\n.time-markers { position: absolute; top: 0; left: 0; width: 100%; height: 20px; display: flex; pointer-events: none; border-bottom: 1px solid #ccc; }\r\n.time-marker { flex: 1; border-left: 1px solid #999; font-size: 10px; color: #555; padding-left: 2px; height: 100%; }\r\n.segments-track { position: absolute; top: 25px; height: 30px; left: 0; right: 0; background: rgba(0,0,0,0.05); }\r\n.segment { position: absolute; height: 100%; background: #2ecc71; min-width: 2px; opacity: 0.8; }\r\n.cursor { position: absolute; top: 0; height: 100%; width: 2px; background: red; z-index: 10; pointer-events: none; }\r\nbutton { padding: 4px 10px; border: 1px solid #555; background: #f0f0f0; cursor: pointer; font-size: 13px; }\r\nbutton:hover { background: #fff; }\r\nbutton:disabled { color: #aaa; cursor: not-allowed; }\r\n.info-text { font-size: 11px; color: #555; margin-left: 10px; }\r\n`;\r\n\r\nexport default function Playback() {\r\n    const [params] = useSearchParams();\r\n    const camId = params.get(\"camId\");\r\n\r\n    // ----------------------------------------------------\r\n    // 1. TIMELINE STATE (Global Day Overview)\r\n    // ----------------------------------------------------\r\n    const [segments, setSegments] = useState([]);\r\n    const [dayStart, setDayStart] = useState(0);\r\n    const [selectedDate, setSelectedDate] = useState(() => {\r\n        // Default: Today's date YYYY-MM-DD\r\n        const d = new Date();\r\n        const y = d.getFullYear();\r\n        const m = String(d.getMonth() + 1).padStart(2, '0');\r\n        const day = String(d.getDate()).padStart(2, '0');\r\n        return `${y}-${m}-${day}`;\r\n    });\r\n\r\n    // ----------------------------------------------------\r\n    // 2. PLAYBACK STATE (Streaming)\r\n    // ----------------------------------------------------\r\n    const [isPlaying, setIsPlaying] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n\r\n    const videoRef = useRef(null);\r\n    const hlsRef = useRef(null);\r\n    const cursorRef = useRef(null);\r\n    const timelineRef = useRef(null);\r\n\r\n    // FETCH TIMELINE (Strictly separated from playback)\r\n    useEffect(() => {\r\n        if (!camId || !selectedDate) return;\r\n\r\n        console.log(`[Timeline] Fetching FULL DAY: ${selectedDate}`);\r\n\r\n        API.get(`/playback/timeline-day/${camId}/${selectedDate}`)\r\n            .then(res => {\r\n                const { segments: raw, dayStart: ds } = res.data;\r\n                setDayStart(ds);\r\n\r\n                // Normalize to 0-1 for the 24h day\r\n                const daySpan = 86400000;\r\n\r\n                const norm = raw\r\n                    .filter(s => s.start_ts > 0)\r\n                    .map(s => ({\r\n                        left: Math.max(0, (s.start_ts - ds) / daySpan),\r\n                        width: (s.end_ts - s.start_ts) / daySpan,\r\n                        // Keep original TS for seek\r\n                        ts: s.start_ts\r\n                    }));\r\n\r\n                setSegments(norm);\r\n                console.log(`[Timeline] Loaded ${norm.length} segments`);\r\n            })\r\n            .catch(e => console.error(e));\r\n    }, [camId, selectedDate]);\r\n\r\n    // HLS Helper\r\n    const waitForHls = async (url, retries = 30) => {\r\n        for (let i = 0; i < retries; i++) {\r\n            try {\r\n                const res = await fetch(url, { method: 'HEAD' });\r\n                if (res.ok) return true;\r\n            } catch { /* ignore */ }\r\n            await new Promise(r => setTimeout(r, 500));\r\n        }\r\n        return false;\r\n    };\r\n\r\n    // START PLAYBACK (Does NOT touch timeline state)\r\n    const play = async (startTime) => {\r\n        if (!startTime && segments.length > 0) startTime = segments[0].ts;\r\n        if (!startTime) return alert(\"Nimic de redat azi\");\r\n\r\n        setIsLoading(true);\r\n        try {\r\n            await stop(); // Stop current\r\n\r\n            console.log(`[Playback] Req: ${new Date(startTime).toLocaleTimeString()}`);\r\n            const res = await API.post('/playback/start', {\r\n                camId,\r\n                from: startTime,\r\n                to: Date.now(), // Play until NOW\r\n                speed: 1\r\n            });\r\n\r\n            const hlsUrl = `http://192.168.120.208:8080${res.data.hlsUrl}`;\r\n            if (!await waitForHls(hlsUrl)) throw new Error(\"HLS Timeout\");\r\n\r\n            if (Hls.isSupported()) {\r\n                const hls = new Hls();\r\n                hls.loadSource(hlsUrl);\r\n                hls.attachMedia(videoRef.current);\r\n                hls.on(Hls.Events.MANIFEST_PARSED, () => videoRef.current.play().catch(console.error));\r\n                hlsRef.current = hls;\r\n            } else if (videoRef.current.canPlayType('application/vnd.apple.mpegurl')) {\r\n                videoRef.current.src = hlsUrl;\r\n                videoRef.current.play();\r\n            }\r\n\r\n            setIsPlaying(true);\r\n        } catch (e) {\r\n            alert(e.message);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const stop = async () => {\r\n        try {\r\n            API.post('/playback/stop', { camId });\r\n            if (hlsRef.current) { hlsRef.current.destroy(); hlsRef.current = null; }\r\n            if (videoRef.current) {\r\n                videoRef.current.pause();\r\n                videoRef.current.removeAttribute('src');\r\n                videoRef.current.load();\r\n            }\r\n            setIsPlaying(false);\r\n        } catch (e) { console.error(e); }\r\n    };\r\n\r\n    // TIMELINE CLICK (Seek)\r\n    const handleSeek = (e) => {\r\n        const rect = timelineRef.current.getBoundingClientRect();\r\n        const ratio = (e.clientX - rect.left) / rect.width;\r\n\r\n        if (cursorRef.current) cursorRef.current.style.left = (ratio * 100) + \"%\";\r\n\r\n        // Map ratio (0-1) to Day Timestamp\r\n        const seekTs = Math.floor(dayStart + ratio * 86400000);\r\n        console.log(`[Seek] ${new Date(seekTs).toLocaleTimeString()}`);\r\n        play(seekTs);\r\n    };\r\n\r\n    return (\r\n        <div className=\"playback-page\">\r\n            <style>{styles}</style>\r\n            <div className=\"playback-header\">\r\n                <button onClick={() => window.location.href = '/'}>← Înapoi</button>\r\n                <span style={{ fontWeight: 600 }}>{camId}</span>\r\n                <span className=\"info-text\">Data: {selectedDate} | Segmente: {segments.length}</span>\r\n            </div>\r\n\r\n            <div className=\"video-viewport\">\r\n                <video ref={videoRef} controls autoPlay muted playsInline />\r\n            </div>\r\n\r\n            <div className=\"controls\">\r\n                {!isPlaying ? (\r\n                    <button onClick={() => play()} disabled={isLoading}>\r\n                        {isLoading ? \"Încărcare...\" : \"▶ REDĂ\"}\r\n                    </button>\r\n                ) : (\r\n                    <button onClick={stop}>■ OPRIRE</button>\r\n                )}\r\n            </div>\r\n\r\n            <div className=\"timeline-area\" ref={timelineRef} onClick={handleSeek}>\r\n                {/* Fixed 0-24h Markers */}\r\n                <div className=\"time-markers\">\r\n                    {Array.from({ length: 24 }, (_, i) => i).map(h => <div key={h} className=\"time-marker\">{h}</div>)}\r\n                </div>\r\n\r\n                {/* Segments Overlay */}\r\n                <div className=\"segments-track\">\r\n                    {segments.map((s, i) => (\r\n                        <div key={i} className=\"segment\"\r\n                            style={{\r\n                                left: `${s.left * 100}%`,\r\n                                width: `${Math.max(s.width * 100, 0.2)}%` // min 0.2% width\r\n                            }}\r\n                        />\r\n                    ))}\r\n                </div>\r\n\r\n                <div ref={cursorRef} className=\"cursor\" style={{ left: '0%' }} />\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}