{"ast":null,"code":"import _objectSpread from\"I:/dispecerat/github_release/dss-edge/local-ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useMemo,useRef}from\"react\";import{API}from\"../../api\";import{colors}from\"../../theme\";import{Trash,Edit,SettingsIcon,Lock,AlertTriangle,Save,Camera,Video,Archive,ChevronRight,RefreshCw,Shield}from\"../../components/Icons\";import Go2RTCPlayer from\"../../components/Go2RTCPlayer\";// Import optimized player\nimport RecorderPlayer from\"../../components/RecorderPlayer\";// Still used for Channel Setup Large View\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const videoStyle={width:\"100%\",height:\"100%\"};// Sub-component for auto-refreshing preview (Snapshot Mode for Performance)\nexport function LivePreview(_ref){let{camId,active=true}=_ref;if(!active)return/*#__PURE__*/_jsx(\"div\",{style:{width:\"100%\",height:\"100%\",background:\"#000\"}});return/*#__PURE__*/_jsx(\"div\",{style:{width:\"100%\",height:\"100%\",background:\"#000\",overflow:\"hidden\"},children:/*#__PURE__*/_jsx(Go2RTCPlayer,{camId:camId,streamType:\"sub\"})});}// --- REWRITTEN ROI COMPONENT ---\n// Uses normalized coordinates (0-1) for storage, mapped to dynamic pixel size for display.\nexport function CanvasROI(_ref2){let{points=[],onChange,readOnly=false,otherZones=[]}=_ref2;const containerRef=useRef(null);const canvasRef=useRef(null);const[dims,setDims]=useState({w:0,h:0});// Container dimensions\nconst[draggingIdx,setDraggingIdx]=useState(-1);// 1. Measure Container Size\nuseEffect(()=>{const obs=new ResizeObserver(entries=>{for(const entry of entries){const{width,height}=entry.contentRect;setDims({w:Math.round(width),h:Math.round(height)});}});if(containerRef.current)obs.observe(containerRef.current);return()=>obs.disconnect();},[]);// 2. Draw Loop\nuseEffect(()=>{const canvas=canvasRef.current;if(!canvas||dims.w===0||dims.h===0)return;const ctx=canvas.getContext(\"2d\");// Clear (using the set Dims)\nctx.clearRect(0,0,dims.w,dims.h);// Drawing Helper\nconst drawZone=(pts,stroke,fill)=>{if(!pts||pts.length===0)return;ctx.beginPath();// Move to first\nctx.moveTo(pts[0][0]*dims.w,pts[0][1]*dims.h);// Lines to rest\nfor(let i=1;i<pts.length;i++){ctx.lineTo(pts[i][0]*dims.w,pts[i][1]*dims.h);}ctx.closePath();ctx.strokeStyle=stroke;ctx.fillStyle=fill;ctx.lineWidth=2;ctx.fill();ctx.stroke();// Handles (only for active, editable)\nif(!readOnly&&stroke===\"#00ff00\"){ctx.fillStyle=\"#fff\";pts.forEach(p=>{ctx.beginPath();ctx.arc(p[0]*dims.w,p[1]*dims.h,4,0,Math.PI*2);ctx.fill();});}};// Draw Inactive Zones\notherZones.forEach(z=>{if(z.points)drawZone(z.points,\"rgba(0,122,204,0.5)\",\"rgba(0,122,204,0.2)\");});// Draw Active Zone\n// Ensure points are normalized (0-1). If > 1, convert on fly to support legacy.\nconst safePoints=points.map(p=>[p[0]>1?p[0]/dims.w:p[0],p[1]>1?p[1]/dims.h:p[1]]);drawZone(safePoints,readOnly?\"#ff9800\":\"#00ff00\",readOnly?\"rgba(255,152,0,0.25)\":\"rgba(0,255,0,0.15)\");},[points,dims,readOnly,otherZones]);// 3. Interactions\nconst handleMouseDown=e=>{if(readOnly)return;// Use native Offset - much faster and accurate relative to element\nconst x=e.nativeEvent.offsetX;const y=e.nativeEvent.offsetY;// Normalize\nconst nx=Math.max(0,Math.min(1,x/dims.w));const ny=Math.max(0,Math.min(1,y/dims.h));// Check hit (distance in pixels)\n// Convert existing points to pixels for check\nconst hitIdx=points.findIndex(p=>{const px=p[0]>1?p[0]:p[0]*dims.w;const py=p[1]>1?p[1]:p[1]*dims.h;return Math.sqrt((px-x)**2+(py-y)**2)<10;});if(hitIdx!==-1){setDraggingIdx(hitIdx);}else{// Add new point (Normalized)\nonChange([...points,[nx,ny]]);}};const handleMouseMove=e=>{if(draggingIdx===-1||readOnly)return;const x=e.nativeEvent.offsetX;const y=e.nativeEvent.offsetY;const nx=Math.max(0,Math.min(1,x/dims.w));const ny=Math.max(0,Math.min(1,y/dims.h));const newPoints=[...points];newPoints[draggingIdx]=[nx,ny];onChange(newPoints);};const handleMouseUp=()=>setDraggingIdx(-1);return/*#__PURE__*/_jsx(\"div\",{ref:containerRef,style:{position:\"absolute\",top:0,left:0,width:\"100%\",height:\"100%\",zIndex:10},children:/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,width:dims.w// Lock resolution to physical pixels\n,height:dims.h,style:{width:\"100%\",height:\"100%\",display:\"block\",cursor:readOnly?\"default\":\"crosshair\",background:\"transparent\"},onMouseDown:handleMouseDown,onMouseMove:handleMouseMove,onMouseUp:handleMouseUp,onMouseLeave:handleMouseUp})});}const styles={inputTable:{background:\"#444\",border:\"1px solid #555\",color:\"#fff\",width:\"100%\",padding:2},btnPrimary:{marginRight:10,padding:\"6px 20px\",background:\"#007acc\",color:\"white\",border:\"none\",borderRadius:2,fontSize:13,cursor:\"pointer\",fontWeight:\"bold\"},btnToolbar:{marginRight:10,padding:\"6px 15px\",background:\"#333\",color:\"#ddd\",border:\"1px solid #444\",borderRadius:2,fontSize:12,cursor:\"pointer\"},settingRow:{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\",marginBottom:12,paddingBottom:8,borderBottom:\"1px solid #2a2a2a\"},inputNum:{background:\"#222\",border:\"1px solid #444\",color:\"#fff\",padding:4,borderRadius:4,width:60,textAlign:\"center\"}};export function IPDevicesRootSection(_ref3){let{cams,statusData={},onEditCam,onSelectCam,onDeleteCam}=_ref3;return/*#__PURE__*/_jsxs(\"div\",{style:{padding:20},children:[/*#__PURE__*/_jsx(\"h2\",{style:{fontSize:18,marginBottom:20,color:\"#fff\"},children:\"Gestionare Dispozitive IP\"}),/*#__PURE__*/_jsx(\"div\",{style:{display:\"grid\",gridTemplateColumns:\"repeat(auto-fill, minmax(300px, 1fr))\",gap:20},children:cams.map(c=>{var _statusData$c$id,_statusData$c$id2,_statusData$c$id3;return/*#__PURE__*/_jsxs(\"div\",{style:{background:\"#252526\",border:\"1px solid #444\",borderRadius:4,overflow:\"hidden\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{height:150,background:\"#000\",position:\"relative\"},children:[/*#__PURE__*/_jsx(Go2RTCPlayer,{camId:c.id,streamType:\"sub\",style:{width:\"100%\",height:\"100%\",objectFit:\"fill\"}}),/*#__PURE__*/_jsx(\"div\",{style:{position:\"absolute\",bottom:0,left:0,right:0,padding:10,background:\"rgba(0,0,0,0.7)\",color:\"#fff\",fontSize:14},children:c.name||c.ip})]}),/*#__PURE__*/_jsxs(\"div\",{style:{padding:15},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\",marginBottom:10},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:13,fontWeight:\"bold\",color:\"#fff\"},children:c.ip}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexDirection:\"column\",alignItems:\"flex-end\"},children:[(_statusData$c$id=statusData[c.id])!==null&&_statusData$c$id!==void 0&&_statusData$c$id.connected||((_statusData$c$id2=statusData[c.id])===null||_statusData$c$id2===void 0?void 0:_statusData$c$id2.status)===\"ONLINE\"?/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:11,color:\"#4caf50\",background:\"rgba(76,175,80,0.1)\",padding:\"2px 6px\",borderRadius:4},children:[\"Active (\",((_statusData$c$id3=statusData[c.id])===null||_statusData$c$id3===void 0?void 0:_statusData$c$id3.fps)||0,\" FPS)\"]}):/*#__PURE__*/_jsx(\"div\",{style:{fontSize:11,color:\"#f44336\",background:\"rgba(244,67,54,0.1)\",padding:\"2px 6px\",borderRadius:4},children:\"Offline\"}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:9,color:\"#888\",marginTop:3},children:[\"Check: \",new Date().toLocaleTimeString()]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:12,color:\"#aaa\",marginBottom:10},children:[\"Model: \",c.model||\"Generic\",\" | \",c.manufacturer]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:10,marginBottom:10},children:[/*#__PURE__*/_jsxs(\"button\",{style:_objectSpread(_objectSpread({},styles.btnToolbar),{},{flex:1}),onClick:()=>onEditCam(c),children:[/*#__PURE__*/_jsx(Edit,{size:12}),\" Edit\"]}),/*#__PURE__*/_jsxs(\"button\",{style:_objectSpread(_objectSpread({},styles.btnToolbar),{},{flex:1}),onClick:()=>onSelectCam(c.id),children:[/*#__PURE__*/_jsx(SettingsIcon,{size:12}),\" Config\"]})]}),/*#__PURE__*/_jsxs(\"button\",{style:{width:\"100%\",padding:\"6px 0\",background:\"rgba(244, 67, 54, 0.1)\",border:\"1px solid #d32f2f\",color:\"#e57373\",borderRadius:2,fontSize:12,cursor:\"pointer\",display:\"flex\",justifyContent:\"center\",alignItems:\"center\",gap:5},onClick:()=>onDeleteCam(c.id),children:[/*#__PURE__*/_jsx(Trash,{size:12}),\" Delete Device\"]})]})]},c.id);})})]});}export function CameraSettingsSection(_ref4){var _statusData$cam$id,_statusData$cam$id2,_statusData$cam$id3,_caps$codecs,_caps$resolutions,_caps$gopRange,_caps$gopRange2,_caps$fps;let{cam,statusData,updateCam,saveAll,deleteCam,openEditModal,setSelection}=_ref4;const[syncing,setSyncing]=useState(false);const[caps,setCaps]=useState(null);// Store dynamic device capabilities\nconst fetchDeviceConfig=async()=>{if(!cam||!cam.id)return;try{const res=await API.get(\"/device-config/\".concat(cam.id));const{current,capabilities}=res.data;if(current){// Update local storage state with real device values\nif(current.codec)updateCam(cam.id,\"codec\",current.codec);if(current.fps)updateCam(cam.id,\"fps\",current.fps);if(current.gop)updateCam(cam.id,\"gop\",current.gop);if(current.resolution)updateCam(cam.id,\"resolution\",current.resolution);}if(capabilities){setCaps(capabilities);}}catch(e){console.warn(\"[CamSync] Polling failed for \".concat(cam.ip,\":\"),e.message);}};// Initial load and periodic polling (every 10s)\nuseEffect(()=>{fetchDeviceConfig();const timer=setInterval(fetchDeviceConfig,10000);return()=>clearInterval(timer);},[cam===null||cam===void 0?void 0:cam.id]);const handleRemoteChange=async(key,val)=>{// 1. Optimistic Update (UI)\nupdateCam(cam.id,key,val);// 2. Send to Device\nsetSyncing(true);try{console.log(\"[CamSync] Updating \".concat(key,\" to \").concat(val,\" for \").concat(cam.ip,\"...\"));await API.post(\"/device-config/\".concat(cam.id),{[key]:val});// Backend now handles saving to cameras.json, so we don't need saveAll() here.\n// This avoids race conditions with stale frontend state.\n// Confirm with a fresh fetch\nsetTimeout(fetchDeviceConfig,1500);}catch(e){var _e$response,_e$response$data;console.error(\"[CamSync] Update failed:\",e);alert(\"Failed to update camera: \".concat(((_e$response=e.response)===null||_e$response===void 0?void 0:(_e$response$data=_e$response.data)===null||_e$response$data===void 0?void 0:_e$response$data.error)||e.message));// Revert or sync back on error\nfetchDeviceConfig();}finally{setSyncing(false);}};if(!cam)return/*#__PURE__*/_jsx(\"div\",{children:\"Camera not found\"});return/*#__PURE__*/_jsx(\"div\",{style:{padding:20,display:\"flex\",flexDirection:\"column\",height:\"100%\"},children:/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:20},children:[/*#__PURE__*/_jsxs(\"h2\",{style:{fontSize:18,marginBottom:15,color:\"#fff\"},children:[\"Camera \",cam.ip]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"grid\",gridTemplateColumns:\"100px 1fr\",gap:10,maxWidth:600,marginBottom:15},children:[/*#__PURE__*/_jsx(\"label\",{children:\"Model:\"}),\" \",/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:\"bold\"},children:cam.model||\"Autodetect\"}),/*#__PURE__*/_jsx(\"label\",{children:\"Device Name:\"}),/*#__PURE__*/_jsx(\"input\",{style:{background:\"#333\",border:\"1px solid #555\",color:\"#ddd\",padding:4},value:cam.name||\"Camera \".concat(cam.ip),onChange:e=>updateCam(cam.id,\"name\",e.target.value),onBlur:()=>saveAll()})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:10,display:\"flex\",alignItems:\"center\",gap:15},children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"IP Address: \",/*#__PURE__*/_jsx(\"b\",{style:{color:\"#fff\"},children:cam.ip})]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Port: \",/*#__PURE__*/_jsx(\"b\",{style:{color:\"#fff\"},children:cam.port})]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"User: \",/*#__PURE__*/_jsx(\"b\",{style:{color:\"#fff\"},children:cam.user})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>openEditModal(cam),style:{color:\"rgb(66, 165, 245)\",background:\"none\",border:\"none\",cursor:\"pointer\",textDecoration:\"underline\",padding:0},children:\"Setup connection\"})]}),cam.storagePath&&/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:20,fontSize:13,color:\"#ccc\",display:\"flex\",alignItems:\"center\",gap:5},children:[\"Storage Path:\",/*#__PURE__*/_jsxs(\"span\",{title:\"Click to view recordings\",onClick:()=>window.location.href=\"/playback?camId=\".concat(cam.id),style:{fontFamily:\"monospace\",color:\"#81d4fa\",cursor:\"pointer\",textDecoration:\"underline\",background:\"rgba(33, 150, 243, 0.1)\",padding:\"2px 6px\",borderRadius:4},children:[cam.storagePath,\" [->]\"]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"grid\",gridTemplateColumns:\"repeat(6, auto)\",gap:10,marginBottom:20,alignItems:\"center\",justifyContent:\"start\"},children:[/*#__PURE__*/_jsx(\"button\",{style:_objectSpread(_objectSpread({},styles.btnToolbar),{},{width:120,background:cam.enabled!==false?\"#333\":\"#4caf50\",color:cam.enabled!==false?\"#ddd\":\"#fff\"}),onClick:()=>{const next=cam.enabled!==false?false:true;updateCam(cam.id,\"enabled\",!!next);saveAll();},children:cam.enabled!==false?\"Disable\":\"Enable\"}),/*#__PURE__*/_jsxs(\"button\",{style:_objectSpread(_objectSpread({},styles.btnToolbar),{},{width:120}),onClick:()=>deleteCam(cam.id),children:[/*#__PURE__*/_jsx(Trash,{size:12,style:{marginRight:5}}),\" Delete...\"]}),/*#__PURE__*/_jsxs(\"button\",{style:_objectSpread(_objectSpread({},styles.btnToolbar),{},{background:\"rgba(0,122,204,0.1)\",border:\"1px solid #007acc\",color:\"#81d4fa\",width:160}),onClick:()=>setSelection({type:\"CHANNEL\",id:cam.id}),children:[/*#__PURE__*/_jsx(SettingsIcon,{size:12,style:{marginRight:5}}),\" AI / Channel Setup\"]}),/*#__PURE__*/_jsx(\"a\",{href:\"http://\".concat(cam.ip),target:\"_blank\",rel:\"noreferrer\",style:{color:\"rgb(66, 165, 245)\",textDecoration:\"none\",alignSelf:\"center\",margin:\"0 10px\"},children:\"Web Interface\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:30,display:\"flex\",alignItems:\"center\",gap:20},children:[(_statusData$cam$id=statusData[cam.id])!==null&&_statusData$cam$id!==void 0&&_statusData$cam$id.connected||((_statusData$cam$id2=statusData[cam.id])===null||_statusData$cam$id2===void 0?void 0:_statusData$cam$id2.status)===\"ONLINE\"?/*#__PURE__*/_jsxs(\"div\",{children:[\"State: \",/*#__PURE__*/_jsx(\"span\",{style:{color:\"rgb(76, 175, 80)\",fontWeight:\"bold\"},children:\"Connected\"})]}):/*#__PURE__*/_jsxs(\"div\",{children:[\"State: \",/*#__PURE__*/_jsx(\"span\",{style:{color:\"#f44336\",fontWeight:\"bold\"},children:\"Disconnected production\"}),\" \",/*#__PURE__*/_jsx(\"span\",{style:{fontSize:11,color:\"#ffa726\",marginLeft:10},children:(_statusData$cam$id3=statusData[cam.id])!==null&&_statusData$cam$id3!==void 0&&_statusData$cam$id3.lastError?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(AlertTriangle,{size:10}),\" \",statusData[cam.id].lastError]}):\"(Retry in 5s...)\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:fetchDeviceConfig,style:{background:\"rgba(255,255,255,0.05)\",border:\"1px solid #444\",color:\"#fff\",padding:\"4px 10px\",borderRadius:4,cursor:\"pointer\",fontSize:12,display:\"flex\",alignItems:\"center\",gap:5},disabled:syncing,children:syncing?\"Syncing...\":\"ðŸ”„ Refresh State\"}),/*#__PURE__*/_jsx(\"span\",{style:{color:\"#666\",fontSize:11},children:\"Auto-sync active (10s)\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:20},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:160,height:90,background:\"#000\",border:\"1px solid #444\",position:\"relative\"},children:/*#__PURE__*/_jsx(LivePreview,{camId:cam.id,active:true})}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1,position:\"relative\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"grid\",gridTemplateColumns:\"100px 100px 120px 80px 80px\",gap:10,fontSize:12,fontWeight:\"bold\",marginBottom:5,color:\"#aaa\"},children:[/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsx(\"div\",{children:\"Codec\"}),/*#__PURE__*/_jsx(\"div\",{children:\"Resolution\"}),/*#__PURE__*/_jsx(\"div\",{children:\"GOP\"}),/*#__PURE__*/_jsx(\"div\",{children:\"FPS\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"grid\",gridTemplateColumns:\"100px 100px 120px 80px 80px\",gap:10,marginBottom:10,alignItems:\"center\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{color:cam.codec===\"H.265\"?\"#ffa726\":\"#4caf50\"},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:true,readOnly:true,style:{marginRight:5}}),\" Video\",cam.codec===\"H.265\"&&/*#__PURE__*/_jsx(\"span\",{title:\"WebRTC doesn't support H.265 natively\",children:\" \\u26A0\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"select\",{style:styles.inputTable,value:cam.codec||\"H.264\",onChange:e=>handleRemoteChange(\"codec\",e.target.value),children:(caps===null||caps===void 0?void 0:(_caps$codecs=caps.codecs)===null||_caps$codecs===void 0?void 0:_caps$codecs.map(c=>/*#__PURE__*/_jsx(\"option\",{value:c,children:c},c)))||/*#__PURE__*/_jsx(\"option\",{children:\"H.264\"})}),/*#__PURE__*/_jsx(\"select\",{style:styles.inputTable,value:cam.resolution,onChange:e=>handleRemoteChange(\"resolution\",e.target.value),children:(caps===null||caps===void 0?void 0:(_caps$resolutions=caps.resolutions)===null||_caps$resolutions===void 0?void 0:_caps$resolutions.map(r=>/*#__PURE__*/_jsx(\"option\",{value:\"\".concat(r.width,\"x\").concat(r.height),children:r.label},\"\".concat(r.width,\"x\").concat(r.height))))||/*#__PURE__*/_jsx(\"option\",{children:cam.resolution})}),/*#__PURE__*/_jsx(\"input\",{style:styles.inputTable,type:\"number\",value:cam.gop||20,min:(caps===null||caps===void 0?void 0:(_caps$gopRange=caps.gopRange)===null||_caps$gopRange===void 0?void 0:_caps$gopRange.min)||1,max:(caps===null||caps===void 0?void 0:(_caps$gopRange2=caps.gopRange)===null||_caps$gopRange2===void 0?void 0:_caps$gopRange2.max)||400,onChange:e=>updateCam(cam.id,\"gop\",e.target.value),onBlur:e=>handleRemoteChange(\"gop\",e.target.value)}),/*#__PURE__*/_jsx(\"select\",{style:styles.inputTable,value:cam.fps||25,onChange:e=>handleRemoteChange(\"fps\",e.target.value),children:(caps===null||caps===void 0?void 0:(_caps$fps=caps.fps)===null||_caps$fps===void 0?void 0:_caps$fps.map(f=>/*#__PURE__*/_jsxs(\"option\",{value:f,children:[f,\" fps\"]},f)))||/*#__PURE__*/_jsxs(\"option\",{children:[cam.fps,\" fps\"]})})]}),cam.codec===\"H.265\"&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"#ffa726\",fontSize:11,marginTop:5},children:[/*#__PURE__*/_jsx(AlertTriangle,{size:10}),\" Camera is in H.265 mode. Switch to H.264 for better grid performance and browser compatibility.\"]})]})]})]})});}function AdvancedAISettings(_ref5){var _config$false_detecti,_config$false_detecti2,_config$false_detecti3,_config$false_detecti4,_config$false_detecti5,_config$false_detecti6,_config$event_manager,_config$false_detecti7;let{camId}=_ref5;const[config,setConfig]=useState(null);const[saving,setSaving]=useState(false);useEffect(()=>{if(!camId)return;API.get(\"/ai-intelligence/api/config/\".concat(camId)).then(res=>{var _res$data;return setConfig(((_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.config)||res.data);}).catch(e=>console.error(e));},[camId]);const updateFilter=(key,val)=>{setConfig(prev=>_objectSpread(_objectSpread({},prev),{},{false_detection_filter:_objectSpread(_objectSpread({},prev.false_detection_filter),{},{[key]:val})}));};const updateEvent=(key,val)=>{setConfig(prev=>_objectSpread(_objectSpread({},prev),{},{event_manager:_objectSpread(_objectSpread({},prev.event_manager),{},{[key]:val})}));};const handleSave=async()=>{setSaving(true);try{await API.post(\"/ai-intelligence/api/config/\".concat(camId),config);alert(\"Settings saved!\");}catch(e){alert(\"Error: \"+e.message);}setSaving(false);};if(!config)return/*#__PURE__*/_jsx(\"div\",{style:{padding:20,color:\"#ccc\"},children:\"Loading AI Config...\"});return/*#__PURE__*/_jsxs(\"div\",{style:{padding:20,maxWidth:800},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:\"#252526\",padding:20,borderRadius:8,border:\"1px solid #444\",marginBottom:20},children:[/*#__PURE__*/_jsxs(\"h4\",{style:{margin:\"0 0 15px 0\",color:\"#4caf50\",display:\"flex\",alignItems:\"center\",gap:8},children:[/*#__PURE__*/_jsx(Shield,{size:18}),\" False Detection Filter\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",marginBottom:15},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:((_config$false_detecti=config.false_detection_filter)===null||_config$false_detecti===void 0?void 0:_config$false_detecti.enabled)||false,onChange:e=>updateFilter(\"enabled\",e.target.checked),style:{width:18,height:18}}),/*#__PURE__*/_jsx(\"label\",{style:{marginLeft:10,fontWeight:\"bold\",color:\"#fff\"},children:\"Enable Filter\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:styles.settingRow,children:[/*#__PURE__*/_jsx(\"label\",{style:{color:\"#ccc\"},children:\"Detect objects only on motion\"}),/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:((_config$false_detecti2=config.false_detection_filter)===null||_config$false_detecti2===void 0?void 0:_config$false_detecti2.motion_only)||false,onChange:e=>updateFilter(\"motion_only\",e.target.checked)})]}),/*#__PURE__*/_jsxs(\"div\",{style:styles.settingRow,children:[/*#__PURE__*/_jsx(\"label\",{style:{color:\"#ccc\"},children:\"Ignore repeated detections (Anti-Wind/Rain)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:((_config$false_detecti3=config.false_detection_filter)===null||_config$false_detecti3===void 0?void 0:_config$false_detecti3.detection_count_before_ignore)||5,onChange:e=>updateFilter(\"detection_count_before_ignore\",parseInt(e.target.value)),style:styles.inputNum})]}),/*#__PURE__*/_jsxs(\"div\",{style:styles.settingRow,children:[/*#__PURE__*/_jsx(\"label\",{style:{color:\"#ccc\"},children:\"Stability Frames (Confirmation)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:((_config$false_detecti4=config.false_detection_filter)===null||_config$false_detecti4===void 0?void 0:_config$false_detecti4.stability_frames)||3,onChange:e=>updateFilter(\"stability_frames\",parseInt(e.target.value)),style:styles.inputNum})]}),/*#__PURE__*/_jsxs(\"div\",{style:_objectSpread(_objectSpread({},styles.settingRow),{},{borderTop:\"1px dashed #444\",paddingTop:10}),children:[/*#__PURE__*/_jsx(\"label\",{style:{color:\"#4caf50\"},children:\"AI Sensitivity (Threshold)\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:10},children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.05\",min:\"0.1\",max:\"1.0\",value:(_config$false_detecti5=(_config$false_detecti6=config.false_detection_filter)===null||_config$false_detecti6===void 0?void 0:_config$false_detecti6.threshold)!==null&&_config$false_detecti5!==void 0?_config$false_detecti5:0.3,onChange:e=>updateFilter(\"threshold\",parseFloat(e.target.value)),style:_objectSpread(_objectSpread({},styles.inputNum),{},{borderColor:'#4caf50'})}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:10,color:\"#888\"},children:\"0.3 Default\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:\"#252526\",padding:20,borderRadius:8,border:\"1px solid #444\"},children:[/*#__PURE__*/_jsxs(\"h4\",{style:{margin:\"0 0 15px 0\",color:\"#2196f3\",display:\"flex\",alignItems:\"center\",gap:8},children:[/*#__PURE__*/_jsx(AlertTriangle,{size:18}),\" Anti-Spam & Events\"]}),/*#__PURE__*/_jsxs(\"div\",{style:styles.settingRow,children:[/*#__PURE__*/_jsx(\"label\",{style:{color:\"#ccc\"},children:\"Event Cooldown (seconds)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:((_config$event_manager=config.event_manager)===null||_config$event_manager===void 0?void 0:_config$event_manager.cooldown_seconds)||30,onChange:e=>updateEvent(\"cooldown_seconds\",parseInt(e.target.value)),style:styles.inputNum})]}),/*#__PURE__*/_jsxs(\"div\",{style:styles.settingRow,children:[/*#__PURE__*/_jsx(\"label\",{style:{color:\"#ccc\"},children:\"Min Displacement (Pixels)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:((_config$false_detecti7=config.false_detection_filter)===null||_config$false_detecti7===void 0?void 0:_config$false_detecti7.min_displacement_pixels)||50,onChange:e=>updateFilter(\"min_displacement_pixels\",parseInt(e.target.value)),style:styles.inputNum})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:20,display:\"flex\",justifyContent:\"flex-end\"},children:/*#__PURE__*/_jsx(\"button\",{onClick:handleSave,disabled:saving,style:_objectSpread(_objectSpread({},styles.btnPrimary),{},{background:\"#2196f3\"}),children:saving?\"Saving...\":\"Save Configuration\"})})]});}export function ChannelSettingsSection(_ref6){var _cam$ai_server,_cam$ai_server2;let{cam,cams,setCams,setSelection,availableModules,updateCam,saveAll}=_ref6;const[activeTab,setActiveTab]=useState('zones');const[activeZoneIdx,setActiveZoneIdx]=useState(0);const[isDrawing,setIsDrawing]=useState(false);const[roiPoints,setRoiPoints]=useState([]);const camAI=cam.ai_server||{};let zones=camAI.zones||[];if(zones.length===0&&camAI.roi&&camAI.roi.length>0){zones=[{name:\"Default Zone\",points:camAI.roi,objects:camAI.objects||{}}];}const safeIdx=activeZoneIdx>=zones.length?0:activeZoneIdx;const activeZone=zones[safeIdx]||null;const pointsToShow=isDrawing?roiPoints:(activeZone===null||activeZone===void 0?void 0:activeZone.points)||[];const silentSave=async updatedCams=>{try{await API.post(\"/cameras/config\",updatedCams);}catch(e){console.error(\"Silent save failed\",e);alert(\"Error saving settings: \"+e.message);}};const handleSaveZonePoints=()=>{setIsDrawing(false);const newZones=[...zones];if(!newZones[safeIdx])return;newZones[safeIdx]=_objectSpread(_objectSpread({},newZones[safeIdx]),{},{points:roiPoints});const newConf=_objectSpread(_objectSpread({},camAI),{},{zones:newZones,enabled:true});const updatedCams=cams.map(c=>c.id===cam.id?_objectSpread(_objectSpread({},c),{},{ai_server:newConf}):c);setCams(updatedCams);silentSave(updatedCams);};const handleAddZone=()=>{const newName=\"Zone \".concat(zones.length+1);const newZones=[...zones,{name:newName,points:[],objects:{}}];const newConf=_objectSpread(_objectSpread({},camAI),{},{zones:newZones});const updatedCams=cams.map(c=>c.id===cam.id?_objectSpread(_objectSpread({},c),{},{ai_server:newConf}):c);setCams(updatedCams);setActiveZoneIdx(newZones.length-1);silentSave(updatedCams);};const handleDeleteZone=()=>{if(!activeZone)return;if(!window.confirm(\"Delete \".concat(activeZone.name,\"?\")))return;const newZones=zones.filter((_,i)=>i!==safeIdx);const newConf=_objectSpread(_objectSpread({},camAI),{},{zones:newZones});const updatedCams=cams.map(c=>c.id===cam.id?_objectSpread(_objectSpread({},c),{},{ai_server:newConf}):c);setCams(updatedCams);setActiveZoneIdx(0);silentSave(updatedCams);};const handleObjectToggle=objKey=>{var _activeZone$objects;if(!activeZone)return;const newObjs=_objectSpread(_objectSpread({},activeZone.objects||{}),{},{[objKey]:!((_activeZone$objects=activeZone.objects)!==null&&_activeZone$objects!==void 0&&_activeZone$objects[objKey])});const newZones=[...zones];newZones[safeIdx]=_objectSpread(_objectSpread({},newZones[safeIdx]),{},{objects:newObjs});const newConf=_objectSpread(_objectSpread({},camAI),{},{zones:newZones});const updatedCams=cams.map(c=>c.id===cam.id?_objectSpread(_objectSpread({},c),{},{ai_server:newConf}):c);setCams(updatedCams);silentSave(updatedCams);};return/*#__PURE__*/_jsxs(\"div\",{style:{padding:20},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\",alignItems:\"baseline\",marginBottom:15},children:[/*#__PURE__*/_jsxs(\"h2\",{style:{fontSize:18,margin:0,color:\"#fff\"},children:[\"AI Zones: \",cam.name||cam.ip]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelection({type:\"CAMERA\",id:cam.id}),style:{color:\"rgb(66, 165, 245)\",background:\"none\",border:\"none\",cursor:\"pointer\",fontSize:13},children:\"[Back] Back to Hardware Settings\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:5,marginBottom:15,borderBottom:\"1px solid #333\"},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('zones'),style:{padding:\"10px 20px\",background:activeTab==='zones'?\"#2196f3\":\"transparent\",color:activeTab==='zones'?\"#fff\":\"#888\",border:\"none\",cursor:\"pointer\",fontWeight:\"bold\"},children:\"Zones & Detection\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('advanced'),style:{padding:\"10px 20px\",background:activeTab==='advanced'?\"#2196f3\":\"transparent\",color:activeTab==='advanced'?\"#fff\":\"#888\",border:\"none\",cursor:\"pointer\",fontWeight:\"bold\"},children:\"Advanced AI\"})]}),activeTab==='zones'&&/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:20,flex:1,minHeight:0},children:[/*#__PURE__*/_jsxs(\"div\",{style:{flex:3,display:\"flex\",flexDirection:\"column\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{width:\"100%\",aspectRatio:\"16/9\",border:\"2px solid #444\",borderRadius:4,overflow:\"hidden\",background:\"#000\",position:\"relative\"},children:[/*#__PURE__*/_jsx(\"video\",{autoPlay:true,muted:true,playsInline:true,src:\"/rtc/api/stream.mp4?src=\".concat(cam.id,\"_hd\"),style:{position:\"absolute\",top:0,left:0,width:\"100%\",height:\"100%\",objectFit:\"fill\",display:\"block\",zIndex:1}}),/*#__PURE__*/_jsx(\"div\",{style:{position:\"absolute\",top:0,left:0,right:0,bottom:0,zIndex:10},children:activeZone?/*#__PURE__*/_jsx(CanvasROI,{points:pointsToShow,onChange:isDrawing?setRoiPoints:undefined,readOnly:!isDrawing,otherZones:zones.filter((_,i)=>i!==safeIdx)}):/*#__PURE__*/_jsx(\"div\",{style:{color:\"#fff\",position:\"absolute\",top:\"50%\",left:\"50%\",transform:\"translate(-50%,-50%)\",pointerEvents:\"none\"},children:\"Select or Add a Zone\"})})]}),activeZone&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:10,display:\"flex\",gap:10,padding:8,background:\"#252526\",borderRadius:4,border:\"1px solid #333\",alignItems:\"center\"},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:12,color:\"#aaa\",fontWeight:\"bold\",marginRight:10},children:\"Zone Actions:\"}),isDrawing?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{style:_objectSpread(_objectSpread({},styles.btnPrimary),{},{background:\"#4caf50\"}),onClick:handleSaveZonePoints,children:\"[SAVE] Save Area\"}),/*#__PURE__*/_jsx(\"button\",{style:styles.btnToolbar,onClick:()=>{setIsDrawing(false);setRoiPoints([]);},children:\"Cancel\"})]}):/*#__PURE__*/_jsx(\"button\",{style:_objectSpread(_objectSpread({},styles.btnPrimary),{},{background:\"#2196f3\"}),onClick:()=>{setRoiPoints(activeZone.points||[]);setIsDrawing(true);},children:\"[EDIT] Edit Area\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1,background:\"#1e1e1e\",border:\"1px solid #444\",padding:15,display:\"flex\",flexDirection:\"column\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:20,flex:1,overflowY:\"auto\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{borderBottom:\"1px solid #444\",marginBottom:15,paddingBottom:15},children:[/*#__PURE__*/_jsx(\"h4\",{style:{margin:\"0 0 10px 0\",color:colors.accent,fontSize:13},children:\"AI Configuration\"}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:15},children:[/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\",marginBottom:5},children:/*#__PURE__*/_jsxs(\"label\",{style:{fontSize:12,color:\"#aaa\"},children:[\"Sensitivity: \",(((_cam$ai_server=cam.ai_server)===null||_cam$ai_server===void 0?void 0:_cam$ai_server.sensitivity)*100||50).toFixed(0),\"%\"]})}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",min:\"0\",max:\"1\",step:\"0.05\",value:((_cam$ai_server2=cam.ai_server)===null||_cam$ai_server2===void 0?void 0:_cam$ai_server2.sensitivity)||0.5,onChange:e=>{const next=_objectSpread(_objectSpread({},cam.ai_server),{},{sensitivity:parseFloat(e.target.value)});const updated=cams.map(c=>c.id===cam.id?_objectSpread(_objectSpread({},c),{},{ai_server:next}):c);setCams(updated);silentSave(updated);},style:{width:\"100%\",cursor:\"pointer\"}}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\",fontSize:10,color:\"#666\",marginTop:4},children:[/*#__PURE__*/_jsx(\"span\",{children:\"0% (Filtrare Maxim\\u0103)\"}),/*#__PURE__*/_jsx(\"span\",{children:\"100% (Alert\\u0103 Maxim\\u0103)\"})]}),/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:11,color:\"#888\",marginTop:8,lineHeight:\"1.4\"},children:[/*#__PURE__*/_jsx(\"b\",{children:\"0%:\"}),\" Doar obiecte foarte clare. Reduce alarmele false (umbre, insecte).\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"b\",{children:\"100%:\"}),\" Detecteaz\\u0103 orice mi\\u0219care suspect\\u0103. Risc ridicat de alarme false.\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\",marginBottom:10},children:[/*#__PURE__*/_jsx(\"h4\",{style:{margin:0,color:\"#ddd\"},children:\"Detection Zones\"}),/*#__PURE__*/_jsx(\"button\",{style:{background:\"#4caf50\",color:\"#fff\",border:\"none\",borderRadius:2,cursor:\"pointer\",padding:\"2px 8px\",fontSize:16},onClick:handleAddZone,children:\"+\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",flexDirection:\"column\",gap:5},children:zones.map((z,idx)=>/*#__PURE__*/_jsxs(\"div\",{onClick:()=>{setActiveZoneIdx(idx);setIsDrawing(false);},style:{padding:\"8px 10px\",background:idx===safeIdx?\"#2196f3\":\"#333\",color:\"#fff\",borderRadius:3,cursor:\"pointer\",fontSize:13,display:\"flex\",justifyContent:\"space-between\"},children:[/*#__PURE__*/_jsx(\"span\",{children:z.name}),idx===safeIdx&&/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();handleDeleteZone();},style:{background:\"transparent\",border:\"none\",color:\"#fff\",cursor:\"pointer\"},children:\"\\xD7\"})]},idx))})]}),activeZone&&/*#__PURE__*/_jsxs(\"div\",{style:{borderTop:\"1px solid #444\",paddingTop:15},children:[/*#__PURE__*/_jsxs(\"h4\",{style:{marginTop:0,color:\"#ddd\",fontSize:13},children:[\"Search Objects (\",activeZone.name,\")\"]}),/*#__PURE__*/_jsx(\"div\",{style:{display:\"grid\",gridTemplateColumns:\"1fr 1fr\",gap:8,marginTop:10},children:((_cam$ai_server3,_currentMod$classes)=>{const currentModName=((_cam$ai_server3=cam.ai_server)===null||_cam$ai_server3===void 0?void 0:_cam$ai_server3.module)||\"ai_small\";const modulesList=Array.isArray(availableModules)?availableModules:[];const currentMod=modulesList.find(m=>m.name===currentModName);const displayClasses=(currentMod===null||currentMod===void 0?void 0:(_currentMod$classes=currentMod.classes)===null||_currentMod$classes===void 0?void 0:_currentMod$classes.length)>0?currentMod.classes:[\"person\",\"car\",\"truck\"];return displayClasses.map(obj=>{var _activeZone$objects2;return/*#__PURE__*/_jsxs(\"label\",{style:{display:\"flex\",alignItems:\"center\",color:\"#ccc\",fontSize:13,cursor:\"pointer\"},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:((_activeZone$objects2=activeZone.objects)===null||_activeZone$objects2===void 0?void 0:_activeZone$objects2[obj])||false,onChange:()=>handleObjectToggle(obj),style:{marginRight:8}}),obj]},obj);});})()})]}),/*#__PURE__*/_jsxs(\"div\",{style:{borderTop:\"1px solid #444\",marginTop:15,paddingTop:15},children:[/*#__PURE__*/_jsx(\"h4\",{style:{margin:\"0 0 10px 0\",color:\"#ddd\",fontSize:13},children:\"Recording Setup\"}),/*#__PURE__*/_jsxs(\"label\",{style:{display:\"flex\",alignItems:\"center\",marginBottom:10,cursor:\"pointer\",color:\"#ccc\",fontSize:13},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:cam.record!==false,onChange:e=>{const updatedCams=cams.map(c=>c.id===cam.id?_objectSpread(_objectSpread({},c),{},{record:e.target.checked}):c);setCams(updatedCams);silentSave(updatedCams);},style:{marginRight:8}}),\"Enable Recording\"]})]})]})]}),activeTab==='advanced'&&/*#__PURE__*/_jsx(AdvancedAISettings,{camId:cam.id})]});}","map":{"version":3,"names":["React","useState","useEffect","useMemo","useRef","API","colors","Trash","Edit","SettingsIcon","Lock","AlertTriangle","Save","Camera","Video","Archive","ChevronRight","RefreshCw","Shield","Go2RTCPlayer","RecorderPlayer","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","videoStyle","width","height","LivePreview","_ref","camId","active","style","background","overflow","children","streamType","CanvasROI","_ref2","points","onChange","readOnly","otherZones","containerRef","canvasRef","dims","setDims","w","h","draggingIdx","setDraggingIdx","obs","ResizeObserver","entries","entry","contentRect","Math","round","current","observe","disconnect","canvas","ctx","getContext","clearRect","drawZone","pts","stroke","fill","length","beginPath","moveTo","i","lineTo","closePath","strokeStyle","fillStyle","lineWidth","forEach","p","arc","PI","z","safePoints","map","handleMouseDown","e","x","nativeEvent","offsetX","y","offsetY","nx","max","min","ny","hitIdx","findIndex","px","py","sqrt","handleMouseMove","newPoints","handleMouseUp","ref","position","top","left","zIndex","display","cursor","onMouseDown","onMouseMove","onMouseUp","onMouseLeave","styles","inputTable","border","color","padding","btnPrimary","marginRight","borderRadius","fontSize","fontWeight","btnToolbar","settingRow","justifyContent","alignItems","marginBottom","paddingBottom","borderBottom","inputNum","textAlign","IPDevicesRootSection","_ref3","cams","statusData","onEditCam","onSelectCam","onDeleteCam","gridTemplateColumns","gap","c","_statusData$c$id","_statusData$c$id2","_statusData$c$id3","id","objectFit","bottom","right","name","ip","flexDirection","connected","status","fps","marginTop","Date","toLocaleTimeString","model","manufacturer","_objectSpread","flex","onClick","size","CameraSettingsSection","_ref4","_statusData$cam$id","_statusData$cam$id2","_statusData$cam$id3","_caps$codecs","_caps$resolutions","_caps$gopRange","_caps$gopRange2","_caps$fps","cam","updateCam","saveAll","deleteCam","openEditModal","setSelection","syncing","setSyncing","caps","setCaps","fetchDeviceConfig","res","get","concat","capabilities","data","codec","gop","resolution","console","warn","message","timer","setInterval","clearInterval","handleRemoteChange","key","val","log","post","setTimeout","_e$response","_e$response$data","error","alert","response","maxWidth","value","target","onBlur","port","user","textDecoration","storagePath","title","window","location","href","fontFamily","enabled","next","type","rel","alignSelf","margin","marginLeft","lastError","disabled","checked","codecs","resolutions","r","label","gopRange","f","AdvancedAISettings","_ref5","_config$false_detecti","_config$false_detecti2","_config$false_detecti3","_config$false_detecti4","_config$false_detecti5","_config$false_detecti6","_config$event_manager","_config$false_detecti7","config","setConfig","saving","setSaving","then","_res$data","catch","updateFilter","prev","false_detection_filter","updateEvent","event_manager","handleSave","motion_only","detection_count_before_ignore","parseInt","stability_frames","borderTop","paddingTop","step","threshold","parseFloat","borderColor","cooldown_seconds","min_displacement_pixels","ChannelSettingsSection","_ref6","_cam$ai_server","_cam$ai_server2","setCams","availableModules","activeTab","setActiveTab","activeZoneIdx","setActiveZoneIdx","isDrawing","setIsDrawing","roiPoints","setRoiPoints","camAI","ai_server","zones","roi","objects","safeIdx","activeZone","pointsToShow","silentSave","updatedCams","handleSaveZonePoints","newZones","newConf","handleAddZone","newName","handleDeleteZone","confirm","filter","_","handleObjectToggle","objKey","_activeZone$objects","newObjs","minHeight","aspectRatio","autoPlay","muted","playsInline","src","undefined","transform","pointerEvents","overflowY","accent","sensitivity","toFixed","updated","lineHeight","idx","stopPropagation","_cam$ai_server3","_currentMod$classes","currentModName","module","modulesList","Array","isArray","currentMod","find","m","displayClasses","classes","obj","_activeZone$objects2","record"],"sources":["I:/dispecerat/github_release/dss-edge/local-ui/src/sections/settings/HardwareSection.js"],"sourcesContent":["import React, { useState, useEffect, useMemo, useRef } from \"react\";\r\nimport { API } from \"../../api\";\r\nimport { colors } from \"../../theme\";\r\nimport { Trash, Edit, SettingsIcon, Lock, AlertTriangle, Save, Camera, Video, Archive, ChevronRight, RefreshCw, Shield } from \"../../components/Icons\";\r\nimport Go2RTCPlayer from \"../../components/Go2RTCPlayer\"; // Import optimized player\r\nimport RecorderPlayer from \"../../components/RecorderPlayer\"; // Still used for Channel Setup Large View\r\n\r\nconst videoStyle = { width: \"100%\", height: \"100%\" };\r\n\r\n// Sub-component for auto-refreshing preview (Snapshot Mode for Performance)\r\nexport function LivePreview({ camId, active = true }) {\r\n    if (!active) return <div style={{ width: \"100%\", height: \"100%\", background: \"#000\" }} />;\r\n    return (\r\n        <div style={{ width: \"100%\", height: \"100%\", background: \"#000\", overflow: \"hidden\" }}>\r\n            <Go2RTCPlayer camId={camId} streamType=\"sub\" />\r\n        </div>\r\n    );\r\n}\r\n\r\n// --- REWRITTEN ROI COMPONENT ---\r\n// Uses normalized coordinates (0-1) for storage, mapped to dynamic pixel size for display.\r\nexport function CanvasROI({ points = [], onChange, readOnly = false, otherZones = [] }) {\r\n    const containerRef = useRef(null);\r\n    const canvasRef = useRef(null);\r\n    const [dims, setDims] = useState({ w: 0, h: 0 }); // Container dimensions\r\n    const [draggingIdx, setDraggingIdx] = useState(-1);\r\n\r\n    // 1. Measure Container Size\r\n    useEffect(() => {\r\n        const obs = new ResizeObserver(entries => {\r\n            for (const entry of entries) {\r\n                const { width, height } = entry.contentRect;\r\n                setDims({ w: Math.round(width), h: Math.round(height) });\r\n            }\r\n        });\r\n        if (containerRef.current) obs.observe(containerRef.current);\r\n        return () => obs.disconnect();\r\n    }, []);\r\n\r\n    // 2. Draw Loop\r\n    useEffect(() => {\r\n        const canvas = canvasRef.current;\r\n        if (!canvas || dims.w === 0 || dims.h === 0) return;\r\n        const ctx = canvas.getContext(\"2d\");\r\n\r\n        // Clear (using the set Dims)\r\n        ctx.clearRect(0, 0, dims.w, dims.h);\r\n\r\n        // Drawing Helper\r\n        const drawZone = (pts, stroke, fill) => {\r\n            if (!pts || pts.length === 0) return;\r\n            ctx.beginPath();\r\n            // Move to first\r\n            ctx.moveTo(pts[0][0] * dims.w, pts[0][1] * dims.h);\r\n            // Lines to rest\r\n            for (let i = 1; i < pts.length; i++) {\r\n                ctx.lineTo(pts[i][0] * dims.w, pts[i][1] * dims.h);\r\n            }\r\n            ctx.closePath();\r\n            ctx.strokeStyle = stroke;\r\n            ctx.fillStyle = fill;\r\n            ctx.lineWidth = 2;\r\n            ctx.fill();\r\n            ctx.stroke();\r\n\r\n            // Handles (only for active, editable)\r\n            if (!readOnly && stroke === \"#00ff00\") {\r\n                ctx.fillStyle = \"#fff\";\r\n                pts.forEach(p => {\r\n                    ctx.beginPath();\r\n                    ctx.arc(p[0] * dims.w, p[1] * dims.h, 4, 0, Math.PI * 2);\r\n                    ctx.fill();\r\n                });\r\n            }\r\n        };\r\n\r\n        // Draw Inactive Zones\r\n        otherZones.forEach(z => {\r\n            if (z.points) drawZone(z.points, \"rgba(0,122,204,0.5)\", \"rgba(0,122,204,0.2)\");\r\n        });\r\n\r\n        // Draw Active Zone\r\n        // Ensure points are normalized (0-1). If > 1, convert on fly to support legacy.\r\n        const safePoints = points.map(p => [\r\n            p[0] > 1 ? p[0] / dims.w : p[0],\r\n            p[1] > 1 ? p[1] / dims.h : p[1]\r\n        ]);\r\n\r\n        drawZone(safePoints, readOnly ? \"#ff9800\" : \"#00ff00\", readOnly ? \"rgba(255,152,0,0.25)\" : \"rgba(0,255,0,0.15)\");\r\n\r\n    }, [points, dims, readOnly, otherZones]);\r\n\r\n    // 3. Interactions\r\n    const handleMouseDown = (e) => {\r\n        if (readOnly) return;\r\n\r\n        // Use native Offset - much faster and accurate relative to element\r\n        const x = e.nativeEvent.offsetX;\r\n        const y = e.nativeEvent.offsetY;\r\n\r\n        // Normalize\r\n        const nx = Math.max(0, Math.min(1, x / dims.w));\r\n        const ny = Math.max(0, Math.min(1, y / dims.h));\r\n\r\n        // Check hit (distance in pixels)\r\n        // Convert existing points to pixels for check\r\n        const hitIdx = points.findIndex(p => {\r\n            const px = p[0] > 1 ? p[0] : p[0] * dims.w;\r\n            const py = p[1] > 1 ? p[1] : p[1] * dims.h;\r\n            return Math.sqrt((px - x) ** 2 + (py - y) ** 2) < 10;\r\n        });\r\n\r\n        if (hitIdx !== -1) {\r\n            setDraggingIdx(hitIdx);\r\n        } else {\r\n            // Add new point (Normalized)\r\n            onChange([...points, [nx, ny]]);\r\n        }\r\n    };\r\n\r\n    const handleMouseMove = (e) => {\r\n        if (draggingIdx === -1 || readOnly) return;\r\n\r\n        const x = e.nativeEvent.offsetX;\r\n        const y = e.nativeEvent.offsetY;\r\n\r\n        const nx = Math.max(0, Math.min(1, x / dims.w));\r\n        const ny = Math.max(0, Math.min(1, y / dims.h));\r\n\r\n        const newPoints = [...points];\r\n        newPoints[draggingIdx] = [nx, ny];\r\n        onChange(newPoints);\r\n    };\r\n\r\n    const handleMouseUp = () => setDraggingIdx(-1);\r\n\r\n    return (\r\n        <div ref={containerRef} style={{ position: \"absolute\", top: 0, left: 0, width: \"100%\", height: \"100%\", zIndex: 10 }}>\r\n            <canvas\r\n                ref={canvasRef}\r\n                width={dims.w} // Lock resolution to physical pixels\r\n                height={dims.h}\r\n                style={{ width: \"100%\", height: \"100%\", display: \"block\", cursor: readOnly ? \"default\" : \"crosshair\", background: \"transparent\" }}\r\n                onMouseDown={handleMouseDown}\r\n                onMouseMove={handleMouseMove}\r\n                onMouseUp={handleMouseUp}\r\n                onMouseLeave={handleMouseUp}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\nconst styles = {\r\n    inputTable: { background: \"#444\", border: \"1px solid #555\", color: \"#fff\", width: \"100%\", padding: 2 },\r\n    btnPrimary: { marginRight: 10, padding: \"6px 20px\", background: \"#007acc\", color: \"white\", border: \"none\", borderRadius: 2, fontSize: 13, cursor: \"pointer\", fontWeight: \"bold\" },\r\n    btnToolbar: { marginRight: 10, padding: \"6px 15px\", background: \"#333\", color: \"#ddd\", border: \"1px solid #444\", borderRadius: 2, fontSize: 12, cursor: \"pointer\" },\r\n    settingRow: { display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\", marginBottom: 12, paddingBottom: 8, borderBottom: \"1px solid #2a2a2a\" },\r\n    inputNum: { background: \"#222\", border: \"1px solid #444\", color: \"#fff\", padding: 4, borderRadius: 4, width: 60, textAlign: \"center\" }\r\n};\r\n\r\nexport function IPDevicesRootSection({ cams, statusData = {}, onEditCam, onSelectCam, onDeleteCam }) {\r\n    return (\r\n        <div style={{ padding: 20 }}>\r\n            <h2 style={{ fontSize: 18, marginBottom: 20, color: \"#fff\" }}>Gestionare Dispozitive IP</h2>\r\n            <div style={{ display: \"grid\", gridTemplateColumns: \"repeat(auto-fill, minmax(300px, 1fr))\", gap: 20 }}>\r\n                {cams.map(c => (\r\n                    <div key={c.id} style={{ background: \"#252526\", border: \"1px solid #444\", borderRadius: 4, overflow: \"hidden\" }}>\r\n                        <div style={{ height: 150, background: \"#000\", position: \"relative\" }}>\r\n                            <Go2RTCPlayer camId={c.id} streamType=\"sub\" style={{ width: \"100%\", height: \"100%\", objectFit: \"fill\" }} />\r\n                            <div style={{ position: \"absolute\", bottom: 0, left: 0, right: 0, padding: 10, background: \"rgba(0,0,0,0.7)\", color: \"#fff\", fontSize: 14 }}>\r\n                                {c.name || c.ip}\r\n                            </div>\r\n                        </div>\r\n                        <div style={{ padding: 15 }}>\r\n                            <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\", marginBottom: 10 }}>\r\n                                <div style={{ fontSize: 13, fontWeight: \"bold\", color: \"#fff\" }}>{c.ip}</div>\r\n                                <div style={{ display: \"flex\", flexDirection: \"column\", alignItems: \"flex-end\" }}>\r\n                                    {(statusData[c.id]?.connected || statusData[c.id]?.status === \"ONLINE\") ?\r\n                                        <div style={{ fontSize: 11, color: \"#4caf50\", background: \"rgba(76,175,80,0.1)\", padding: \"2px 6px\", borderRadius: 4 }}>Active ({statusData[c.id]?.fps || 0} FPS)</div> :\r\n                                        <div style={{ fontSize: 11, color: \"#f44336\", background: \"rgba(244,67,54,0.1)\", padding: \"2px 6px\", borderRadius: 4 }}>Offline</div>\r\n                                    }\r\n                                    <div style={{ fontSize: 9, color: \"#888\", marginTop: 3 }}>\r\n                                        Check: {new Date().toLocaleTimeString()}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                            <div style={{ fontSize: 12, color: \"#aaa\", marginBottom: 10 }}>Model: {c.model || \"Generic\"} | {c.manufacturer}</div>\r\n                            <div style={{ display: \"flex\", gap: 10, marginBottom: 10 }}>\r\n                                <button style={{ ...styles.btnToolbar, flex: 1 }} onClick={() => onEditCam(c)}><Edit size={12} /> Edit</button>\r\n                                <button style={{ ...styles.btnToolbar, flex: 1 }} onClick={() => onSelectCam(c.id)}><SettingsIcon size={12} /> Config</button>\r\n                            </div>\r\n                            <button\r\n                                style={{\r\n                                    width: \"100%\", padding: \"6px 0\", background: \"rgba(244, 67, 54, 0.1)\",\r\n                                    border: \"1px solid #d32f2f\", color: \"#e57373\", borderRadius: 2,\r\n                                    fontSize: 12, cursor: \"pointer\", display: \"flex\", justifyContent: \"center\", alignItems: \"center\", gap: 5\r\n                                }}\r\n                                onClick={() => onDeleteCam(c.id)}\r\n                            >\r\n                                <Trash size={12} /> Delete Device\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport function CameraSettingsSection({\r\n    cam, statusData, updateCam, saveAll, deleteCam, openEditModal, setSelection\r\n}) {\r\n    const [syncing, setSyncing] = useState(false);\r\n    const [caps, setCaps] = useState(null); // Store dynamic device capabilities\r\n\r\n    const fetchDeviceConfig = async () => {\r\n        if (!cam || !cam.id) return;\r\n        try {\r\n            const res = await API.get(`/device-config/${cam.id}`);\r\n            const { current, capabilities } = res.data;\r\n            if (current) {\r\n                // Update local storage state with real device values\r\n                if (current.codec) updateCam(cam.id, \"codec\", current.codec);\r\n                if (current.fps) updateCam(cam.id, \"fps\", current.fps);\r\n                if (current.gop) updateCam(cam.id, \"gop\", current.gop);\r\n                if (current.resolution) updateCam(cam.id, \"resolution\", current.resolution);\r\n            }\r\n            if (capabilities) {\r\n                setCaps(capabilities);\r\n            }\r\n        } catch (e) {\r\n            console.warn(`[CamSync] Polling failed for ${cam.ip}:`, e.message);\r\n        }\r\n    };\r\n\r\n    // Initial load and periodic polling (every 10s)\r\n    useEffect(() => {\r\n        fetchDeviceConfig();\r\n        const timer = setInterval(fetchDeviceConfig, 10000);\r\n        return () => clearInterval(timer);\r\n    }, [cam?.id]);\r\n\r\n    const handleRemoteChange = async (key, val) => {\r\n        // 1. Optimistic Update (UI)\r\n        updateCam(cam.id, key, val);\r\n\r\n        // 2. Send to Device\r\n        setSyncing(true);\r\n        try {\r\n            console.log(`[CamSync] Updating ${key} to ${val} for ${cam.ip}...`);\r\n            await API.post(`/device-config/${cam.id}`, { [key]: val });\r\n\r\n            // Backend now handles saving to cameras.json, so we don't need saveAll() here.\r\n            // This avoids race conditions with stale frontend state.\r\n\r\n            // Confirm with a fresh fetch\r\n            setTimeout(fetchDeviceConfig, 1500);\r\n        } catch (e) {\r\n            console.error(`[CamSync] Update failed:`, e);\r\n            alert(`Failed to update camera: ${e.response?.data?.error || e.message}`);\r\n            // Revert or sync back on error\r\n            fetchDeviceConfig();\r\n        } finally {\r\n            setSyncing(false);\r\n        }\r\n    };\r\n\r\n    if (!cam) return <div>Camera not found</div>;\r\n    return (\r\n        <div style={{ padding: 20, display: \"flex\", flexDirection: \"column\", height: \"100%\" }}>\r\n            <div style={{ marginBottom: 20 }}>\r\n                <h2 style={{ fontSize: 18, marginBottom: 15, color: \"#fff\" }}>Camera {cam.ip}</h2>\r\n                <div style={{ display: \"grid\", gridTemplateColumns: \"100px 1fr\", gap: 10, maxWidth: 600, marginBottom: 15 }}>\r\n                    <label>Model:</label> <div style={{ fontWeight: \"bold\" }}>{cam.model || \"Autodetect\"}</div>\r\n                    <label>Device Name:</label>\r\n                    <input style={{ background: \"#333\", border: \"1px solid #555\", color: \"#ddd\", padding: 4 }}\r\n                        value={cam.name || `Camera ${cam.ip}`}\r\n                        onChange={e => updateCam(cam.id, \"name\", e.target.value)}\r\n                        onBlur={() => saveAll()}\r\n                    />\r\n                </div>\r\n                <div style={{ marginBottom: 10, display: \"flex\", alignItems: \"center\", gap: 15 }}>\r\n                    <span>IP Address: <b style={{ color: \"#fff\" }}>{cam.ip}</b></span>\r\n                    <span>Port: <b style={{ color: \"#fff\" }}>{cam.port}</b></span>\r\n                    <span>User: <b style={{ color: \"#fff\" }}>{cam.user}</b></span>\r\n                    <button onClick={() => openEditModal(cam)} style={{ color: \"rgb(66, 165, 245)\", background: \"none\", border: \"none\", cursor: \"pointer\", textDecoration: \"underline\", padding: 0 }}>Setup connection</button>\r\n                </div>\r\n                {cam.storagePath && (\r\n                    <div style={{ marginBottom: 20, fontSize: 13, color: \"#ccc\", display: \"flex\", alignItems: \"center\", gap: 5 }}>\r\n                        Storage Path:\r\n                        <span\r\n                            title=\"Click to view recordings\"\r\n                            onClick={() => window.location.href = `/playback?camId=${cam.id}`}\r\n                            style={{ fontFamily: \"monospace\", color: \"#81d4fa\", cursor: \"pointer\", textDecoration: \"underline\", background: \"rgba(33, 150, 243, 0.1)\", padding: \"2px 6px\", borderRadius: 4 }}\r\n                        >\r\n                            {cam.storagePath} [->]\r\n                        </span>\r\n                    </div>\r\n                )}\r\n                <div style={{ display: \"grid\", gridTemplateColumns: \"repeat(6, auto)\", gap: 10, marginBottom: 20, alignItems: \"center\", justifyContent: \"start\" }}>\r\n                    <button style={{ ...styles.btnToolbar, width: 120, background: (cam.enabled !== false) ? \"#333\" : \"#4caf50\", color: (cam.enabled !== false) ? \"#ddd\" : \"#fff\" }} onClick={() => { const next = (cam.enabled !== false) ? false : true; updateCam(cam.id, \"enabled\", !!next); saveAll(); }}>{(cam.enabled !== false) ? \"Disable\" : \"Enable\"}</button>\r\n                    <button style={{ ...styles.btnToolbar, width: 120 }} onClick={() => deleteCam(cam.id)}><Trash size={12} style={{ marginRight: 5 }} /> Delete...</button>\r\n                    <button\r\n                        style={{ ...styles.btnToolbar, background: \"rgba(0,122,204,0.1)\", border: \"1px solid #007acc\", color: \"#81d4fa\", width: 160 }}\r\n                        onClick={() => setSelection({ type: \"CHANNEL\", id: cam.id })}\r\n                    >\r\n                        <SettingsIcon size={12} style={{ marginRight: 5 }} /> AI / Channel Setup\r\n                    </button>\r\n                    <a href={`http://${cam.ip}`} target=\"_blank\" rel=\"noreferrer\" style={{ color: \"rgb(66, 165, 245)\", textDecoration: \"none\", alignSelf: \"center\", margin: \"0 10px\" }}>Web Interface</a>\r\n                </div>\r\n\r\n                <div style={{ marginBottom: 30, display: \"flex\", alignItems: \"center\", gap: 20 }}>\r\n                    {(statusData[cam.id]?.connected || statusData[cam.id]?.status === \"ONLINE\") ?\r\n                        <div>State: <span style={{ color: \"rgb(76, 175, 80)\", fontWeight: \"bold\" }}>Connected</span></div> :\r\n                        <div>State: <span style={{ color: \"#f44336\", fontWeight: \"bold\" }}>Disconnected production</span> <span style={{ fontSize: 11, color: \"#ffa726\", marginLeft: 10 }}>{statusData[cam.id]?.lastError ? <><AlertTriangle size={10} /> {statusData[cam.id].lastError}</> : \"(Retry in 5s...)\"}</span></div>\r\n                    }\r\n\r\n                    <button\r\n                        onClick={fetchDeviceConfig}\r\n                        style={{\r\n                            background: \"rgba(255,255,255,0.05)\",\r\n                            border: \"1px solid #444\",\r\n                            color: \"#fff\",\r\n                            padding: \"4px 10px\",\r\n                            borderRadius: 4,\r\n                            cursor: \"pointer\",\r\n                            fontSize: 12,\r\n                            display: \"flex\",\r\n                            alignItems: \"center\",\r\n                            gap: 5\r\n                        }}\r\n                        disabled={syncing}\r\n                    >\r\n                        {syncing ? \"Syncing...\" : \"ðŸ”„ Refresh State\"}\r\n                    </button>\r\n                    <span style={{ color: \"#666\", fontSize: 11 }}>Auto-sync active (10s)</span>\r\n                </div>\r\n\r\n                <div style={{ display: \"flex\", gap: 20 }}>\r\n                    <div style={{ width: 160, height: 90, background: \"#000\", border: \"1px solid #444\", position: \"relative\" }}>\r\n                        <LivePreview camId={cam.id} active={true} />\r\n                    </div>\r\n                    <div style={{ flex: 1, position: \"relative\" }}>\r\n                        <div style={{ display: \"grid\", gridTemplateColumns: \"100px 100px 120px 80px 80px\", gap: 10, fontSize: 12, fontWeight: \"bold\", marginBottom: 5, color: \"#aaa\" }}>\r\n                            <div></div><div>Codec</div><div>Resolution</div><div>GOP</div><div>FPS</div>\r\n                        </div>\r\n                        <div style={{ display: \"grid\", gridTemplateColumns: \"100px 100px 120px 80px 80px\", gap: 10, marginBottom: 10, alignItems: \"center\" }}>\r\n                            <div style={{ color: cam.codec === \"H.265\" ? \"#ffa726\" : \"#4caf50\" }}>\r\n                                <input type=\"checkbox\" checked readOnly style={{ marginRight: 5 }} /> Video\r\n                                {cam.codec === \"H.265\" && <span title=\"WebRTC doesn't support H.265 natively\"> âš ï¸</span>}\r\n                            </div>\r\n\r\n                            <select style={styles.inputTable} value={cam.codec || \"H.264\"} onChange={e => handleRemoteChange(\"codec\", e.target.value)}>\r\n                                {caps?.codecs?.map(c => <option key={c} value={c}>{c}</option>) || <option>H.264</option>}\r\n                            </select>\r\n\r\n                            <select style={styles.inputTable} value={cam.resolution} onChange={e => handleRemoteChange(\"resolution\", e.target.value)}>\r\n                                {caps?.resolutions?.map(r => (\r\n                                    <option key={`${r.width}x${r.height}`} value={`${r.width}x${r.height}`}>\r\n                                        {r.label}\r\n                                    </option>\r\n                                )) || <option>{cam.resolution}</option>}\r\n                            </select>\r\n\r\n                            <input style={styles.inputTable}\r\n                                type=\"number\"\r\n                                value={cam.gop || 20}\r\n                                min={caps?.gopRange?.min || 1}\r\n                                max={caps?.gopRange?.max || 400}\r\n                                onChange={e => updateCam(cam.id, \"gop\", e.target.value)}\r\n                                onBlur={e => handleRemoteChange(\"gop\", e.target.value)}\r\n                            />\r\n\r\n                            <select style={styles.inputTable} value={cam.fps || 25} onChange={e => handleRemoteChange(\"fps\", e.target.value)}>\r\n                                {caps?.fps?.map(f => <option key={f} value={f}>{f} fps</option>) || <option>{cam.fps} fps</option>}\r\n                            </select>\r\n                        </div>\r\n                        {cam.codec === \"H.265\" && (\r\n                            <div style={{ color: \"#ffa726\", fontSize: 11, marginTop: 5 }}>\r\n                                <AlertTriangle size={10} /> Camera is in H.265 mode. Switch to H.264 for better grid performance and browser compatibility.\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\n\r\nfunction AdvancedAISettings({ camId }) {\r\n    const [config, setConfig] = useState(null);\r\n    const [saving, setSaving] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (!camId) return;\r\n        API.get(`/ai-intelligence/api/config/${camId}`)\r\n            .then(res => setConfig(res.data?.config || res.data))\r\n            .catch(e => console.error(e));\r\n    }, [camId]);\r\n\r\n    const updateFilter = (key, val) => {\r\n        setConfig(prev => ({\r\n            ...prev,\r\n            false_detection_filter: { ...prev.false_detection_filter, [key]: val }\r\n        }));\r\n    };\r\n\r\n    const updateEvent = (key, val) => {\r\n        setConfig(prev => ({\r\n            ...prev,\r\n            event_manager: { ...prev.event_manager, [key]: val }\r\n        }));\r\n    };\r\n\r\n    const handleSave = async () => {\r\n        setSaving(true);\r\n        try {\r\n            await API.post(`/ai-intelligence/api/config/${camId}`, config);\r\n            alert(\"Settings saved!\");\r\n        } catch (e) { alert(\"Error: \" + e.message); }\r\n        setSaving(false);\r\n    };\r\n\r\n    if (!config) return <div style={{ padding: 20, color: \"#ccc\" }}>Loading AI Config...</div>;\r\n\r\n    return (\r\n        <div style={{ padding: 20, maxWidth: 800 }}>\r\n            <div style={{ background: \"#252526\", padding: 20, borderRadius: 8, border: \"1px solid #444\", marginBottom: 20 }}>\r\n                <h4 style={{ margin: \"0 0 15px 0\", color: \"#4caf50\", display: \"flex\", alignItems: \"center\", gap: 8 }}>\r\n                    <Shield size={18} /> False Detection Filter\r\n                </h4>\r\n\r\n                <div style={{ display: \"flex\", alignItems: \"center\", marginBottom: 15 }}>\r\n                    <input type=\"checkbox\" checked={config.false_detection_filter?.enabled || false} onChange={e => updateFilter(\"enabled\", e.target.checked)} style={{ width: 18, height: 18 }} />\r\n                    <label style={{ marginLeft: 10, fontWeight: \"bold\", color: \"#fff\" }}>Enable Filter</label>\r\n                </div>\r\n\r\n                <div style={styles.settingRow}>\r\n                    <label style={{ color: \"#ccc\" }}>Detect objects only on motion</label>\r\n                    <input type=\"checkbox\" checked={config.false_detection_filter?.motion_only || false} onChange={e => updateFilter(\"motion_only\", e.target.checked)} />\r\n                </div>\r\n\r\n                <div style={styles.settingRow}>\r\n                    <label style={{ color: \"#ccc\" }}>Ignore repeated detections (Anti-Wind/Rain)</label>\r\n                    <input type=\"number\" value={config.false_detection_filter?.detection_count_before_ignore || 5} onChange={e => updateFilter(\"detection_count_before_ignore\", parseInt(e.target.value))} style={styles.inputNum} />\r\n                </div>\r\n\r\n                <div style={styles.settingRow}>\r\n                    <label style={{ color: \"#ccc\" }}>Stability Frames (Confirmation)</label>\r\n                    <input type=\"number\" value={config.false_detection_filter?.stability_frames || 3} onChange={e => updateFilter(\"stability_frames\", parseInt(e.target.value))} style={styles.inputNum} />\r\n                </div>\r\n\r\n                <div style={{ ...styles.settingRow, borderTop: \"1px dashed #444\", paddingTop: 10 }}>\r\n                    <label style={{ color: \"#4caf50\" }}>AI Sensitivity (Threshold)</label>\r\n                    <div style={{ display: 'flex', alignItems: 'center', gap: 10 }}>\r\n                        <input type=\"number\" step=\"0.05\" min=\"0.1\" max=\"1.0\"\r\n                            value={config.false_detection_filter?.threshold ?? 0.3}\r\n                            onChange={e => updateFilter(\"threshold\", parseFloat(e.target.value))}\r\n                            style={{ ...styles.inputNum, borderColor: '#4caf50' }} />\r\n                        <span style={{ fontSize: 10, color: \"#888\" }}>0.3 Default</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div style={{ background: \"#252526\", padding: 20, borderRadius: 8, border: \"1px solid #444\" }}>\r\n                <h4 style={{ margin: \"0 0 15px 0\", color: \"#2196f3\", display: \"flex\", alignItems: \"center\", gap: 8 }}>\r\n                    <AlertTriangle size={18} /> Anti-Spam & Events\r\n                </h4>\r\n                <div style={styles.settingRow}>\r\n                    <label style={{ color: \"#ccc\" }}>Event Cooldown (seconds)</label>\r\n                    <input type=\"number\" value={config.event_manager?.cooldown_seconds || 30} onChange={e => updateEvent(\"cooldown_seconds\", parseInt(e.target.value))} style={styles.inputNum} />\r\n                </div>\r\n                <div style={styles.settingRow}>\r\n                    <label style={{ color: \"#ccc\" }}>Min Displacement (Pixels)</label>\r\n                    <input type=\"number\" value={config.false_detection_filter?.min_displacement_pixels || 50} onChange={e => updateFilter(\"min_displacement_pixels\", parseInt(e.target.value))} style={styles.inputNum} />\r\n                </div>\r\n            </div>\r\n\r\n            <div style={{ marginTop: 20, display: \"flex\", justifyContent: \"flex-end\" }}>\r\n                <button onClick={handleSave} disabled={saving} style={{ ...styles.btnPrimary, background: \"#2196f3\" }}>\r\n                    {saving ? \"Saving...\" : \"Save Configuration\"}\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport function ChannelSettingsSection({\r\n    cam, cams, setCams, setSelection, availableModules, updateCam, saveAll\r\n}) {\r\n    const [activeTab, setActiveTab] = useState('zones');\r\n    const [activeZoneIdx, setActiveZoneIdx] = useState(0);\r\n    const [isDrawing, setIsDrawing] = useState(false);\r\n    const [roiPoints, setRoiPoints] = useState([]);\r\n\r\n    const camAI = cam.ai_server || {};\r\n    let zones = camAI.zones || [];\r\n    if (zones.length === 0 && camAI.roi && camAI.roi.length > 0) {\r\n        zones = [{ name: \"Default Zone\", points: camAI.roi, objects: camAI.objects || {} }];\r\n    }\r\n\r\n    const safeIdx = (activeZoneIdx >= zones.length) ? 0 : activeZoneIdx;\r\n    const activeZone = zones[safeIdx] || null;\r\n    const pointsToShow = isDrawing ? roiPoints : (activeZone?.points || []);\r\n\r\n    const silentSave = async (updatedCams) => {\r\n        try {\r\n            await API.post(\"/cameras/config\", updatedCams);\r\n        } catch (e) {\r\n            console.error(\"Silent save failed\", e);\r\n            alert(\"Error saving settings: \" + e.message);\r\n        }\r\n    };\r\n\r\n    const handleSaveZonePoints = () => {\r\n        setIsDrawing(false);\r\n        const newZones = [...zones];\r\n        if (!newZones[safeIdx]) return;\r\n        newZones[safeIdx] = { ...newZones[safeIdx], points: roiPoints };\r\n        const newConf = { ...camAI, zones: newZones, enabled: true };\r\n        const updatedCams = cams.map(c => c.id === cam.id ? { ...c, ai_server: newConf } : c);\r\n        setCams(updatedCams);\r\n        silentSave(updatedCams);\r\n    };\r\n\r\n    const handleAddZone = () => {\r\n        const newName = `Zone ${zones.length + 1}`;\r\n        const newZones = [...zones, { name: newName, points: [], objects: {} }];\r\n        const newConf = { ...camAI, zones: newZones };\r\n        const updatedCams = cams.map(c => c.id === cam.id ? { ...c, ai_server: newConf } : c);\r\n        setCams(updatedCams);\r\n        setActiveZoneIdx(newZones.length - 1);\r\n        silentSave(updatedCams);\r\n    };\r\n\r\n    const handleDeleteZone = () => {\r\n        if (!activeZone) return;\r\n        if (!window.confirm(`Delete ${activeZone.name}?`)) return;\r\n        const newZones = zones.filter((_, i) => i !== safeIdx);\r\n        const newConf = { ...camAI, zones: newZones };\r\n        const updatedCams = cams.map(c => c.id === cam.id ? { ...c, ai_server: newConf } : c);\r\n        setCams(updatedCams);\r\n        setActiveZoneIdx(0);\r\n        silentSave(updatedCams);\r\n    };\r\n\r\n    const handleObjectToggle = (objKey) => {\r\n        if (!activeZone) return;\r\n        const newObjs = { ...(activeZone.objects || {}), [objKey]: !activeZone.objects?.[objKey] };\r\n        const newZones = [...zones];\r\n        newZones[safeIdx] = { ...newZones[safeIdx], objects: newObjs };\r\n        const newConf = { ...camAI, zones: newZones };\r\n        const updatedCams = cams.map(c => c.id === cam.id ? { ...c, ai_server: newConf } : c);\r\n        setCams(updatedCams);\r\n        silentSave(updatedCams);\r\n    };\r\n\r\n    return (\r\n        <div style={{ padding: 20 }}>\r\n            <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"baseline\", marginBottom: 15 }}>\r\n                <h2 style={{ fontSize: 18, margin: 0, color: \"#fff\" }}>AI Zones: {cam.name || cam.ip}</h2>\r\n                <button onClick={() => setSelection({ type: \"CAMERA\", id: cam.id })} style={{ color: \"rgb(66, 165, 245)\", background: \"none\", border: \"none\", cursor: \"pointer\", fontSize: 13 }}>[Back] Back to Hardware Settings</button>\r\n            </div>\r\n\r\n            <div style={{ display: \"flex\", gap: 5, marginBottom: 15, borderBottom: \"1px solid #333\" }}>\r\n                <button\r\n                    onClick={() => setActiveTab('zones')}\r\n                    style={{ padding: \"10px 20px\", background: activeTab === 'zones' ? \"#2196f3\" : \"transparent\", color: activeTab === 'zones' ? \"#fff\" : \"#888\", border: \"none\", cursor: \"pointer\", fontWeight: \"bold\" }}\r\n                >\r\n                    Zones & Detection\r\n                </button>\r\n                <button\r\n                    onClick={() => setActiveTab('advanced')}\r\n                    style={{ padding: \"10px 20px\", background: activeTab === 'advanced' ? \"#2196f3\" : \"transparent\", color: activeTab === 'advanced' ? \"#fff\" : \"#888\", border: \"none\", cursor: \"pointer\", fontWeight: \"bold\" }}\r\n                >\r\n                    Advanced AI\r\n                </button>\r\n            </div>\r\n\r\n            {activeTab === 'zones' && (\r\n                <div style={{ display: \"flex\", gap: 20, flex: 1, minHeight: 0 }}>\r\n                    <div style={{ flex: 3, display: \"flex\", flexDirection: \"column\" }}>\r\n                        {/* FIXED ASPECT RATIO 16:9 container */}\r\n                        <div style={{ width: \"100%\", aspectRatio: \"16/9\", border: \"2px solid #444\", borderRadius: 4, overflow: \"hidden\", background: \"#000\", position: \"relative\" }}>\r\n                            {/* THE VIDEO - Native MP4 for stability and perfect fill */}\r\n                            <video\r\n                                autoPlay\r\n                                muted\r\n                                playsInline\r\n                                src={`/rtc/api/stream.mp4?src=${cam.id}_hd`}\r\n                                style={{\r\n                                    position: \"absolute\",\r\n                                    top: 0,\r\n                                    left: 0,\r\n                                    width: \"100%\",\r\n                                    height: \"100%\",\r\n                                    objectFit: \"fill\",\r\n                                    display: \"block\",\r\n                                    zIndex: 1\r\n                                }}\r\n                            />\r\n\r\n                            {/* THE DRAWING LAYER - Exact same size as video */}\r\n                            <div style={{ position: \"absolute\", top: 0, left: 0, right: 0, bottom: 0, zIndex: 10 }}>\r\n                                {activeZone ? (\r\n                                    <CanvasROI\r\n                                        points={pointsToShow}\r\n                                        onChange={isDrawing ? setRoiPoints : undefined}\r\n                                        readOnly={!isDrawing}\r\n                                        otherZones={zones.filter((_, i) => i !== safeIdx)}\r\n                                    />\r\n                                ) : (\r\n                                    <div style={{ color: \"#fff\", position: \"absolute\", top: \"50%\", left: \"50%\", transform: \"translate(-50%,-50%)\", pointerEvents: \"none\" }}>\r\n                                        Select or Add a Zone\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n\r\n                        {activeZone && (\r\n                            <div style={{ marginTop: 10, display: \"flex\", gap: 10, padding: 8, background: \"#252526\", borderRadius: 4, border: \"1px solid #333\", alignItems: \"center\" }}>\r\n                                <span style={{ fontSize: 12, color: \"#aaa\", fontWeight: \"bold\", marginRight: 10 }}>Zone Actions:</span>\r\n                                {isDrawing ? (\r\n                                    <>\r\n                                        <button style={{ ...styles.btnPrimary, background: \"#4caf50\" }} onClick={handleSaveZonePoints}>[SAVE] Save Area</button>\r\n                                        <button style={styles.btnToolbar} onClick={() => { setIsDrawing(false); setRoiPoints([]); }}>Cancel</button>\r\n                                    </>\r\n                                ) : (\r\n                                    <button style={{ ...styles.btnPrimary, background: \"#2196f3\" }} onClick={() => { setRoiPoints(activeZone.points || []); setIsDrawing(true); }}>[EDIT] Edit Area</button>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div style={{ flex: 1, background: \"#1e1e1e\", border: \"1px solid #444\", padding: 15, display: \"flex\", flexDirection: \"column\" }}>\r\n                        <div style={{ marginBottom: 20, flex: 1, overflowY: \"auto\" }}>\r\n                            <div style={{ borderBottom: \"1px solid #444\", marginBottom: 15, paddingBottom: 15 }}>\r\n                                <h4 style={{ margin: \"0 0 10px 0\", color: colors.accent, fontSize: 13 }}>AI Configuration</h4>\r\n                                <div style={{ marginBottom: 15 }}>\r\n                                    <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\", marginBottom: 5 }}>\r\n                                        <label style={{ fontSize: 12, color: \"#aaa\" }}>Sensitivity: {(cam.ai_server?.sensitivity * 100 || 50).toFixed(0)}%</label>\r\n                                    </div>\r\n                                    <input\r\n                                        type=\"range\" min=\"0\" max=\"1\" step=\"0.05\"\r\n                                        value={cam.ai_server?.sensitivity || 0.5}\r\n                                        onChange={e => {\r\n                                            const next = { ...cam.ai_server, sensitivity: parseFloat(e.target.value) };\r\n                                            const updated = cams.map(c => c.id === cam.id ? { ...c, ai_server: next } : c);\r\n                                            setCams(updated); silentSave(updated);\r\n                                        }}\r\n                                        style={{ width: \"100%\", cursor: \"pointer\" }}\r\n                                    />\r\n                                    <div style={{ display: \"flex\", justifyContent: \"space-between\", fontSize: 10, color: \"#666\", marginTop: 4 }}>\r\n                                        <span>0% (Filtrare MaximÄƒ)</span>\r\n                                        <span>100% (AlertÄƒ MaximÄƒ)</span>\r\n                                    </div>\r\n                                    <p style={{ fontSize: 11, color: \"#888\", marginTop: 8, lineHeight: \"1.4\" }}>\r\n                                        <b>0%:</b> Doar obiecte foarte clare. Reduce alarmele false (umbre, insecte).<br />\r\n                                        <b>100%:</b> DetecteazÄƒ orice miÈ™care suspectÄƒ. Risc ridicat de alarme false.\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\", marginBottom: 10 }}>\r\n                                <h4 style={{ margin: 0, color: \"#ddd\" }}>Detection Zones</h4>\r\n                                <button style={{ background: \"#4caf50\", color: \"#fff\", border: \"none\", borderRadius: 2, cursor: \"pointer\", padding: \"2px 8px\", fontSize: 16 }} onClick={handleAddZone}>+</button>\r\n                            </div>\r\n                            <div style={{ display: \"flex\", flexDirection: \"column\", gap: 5 }}>\r\n                                {zones.map((z, idx) => (\r\n                                    <div key={idx} onClick={() => { setActiveZoneIdx(idx); setIsDrawing(false); }}\r\n                                        style={{ padding: \"8px 10px\", background: idx === safeIdx ? \"#2196f3\" : \"#333\", color: \"#fff\", borderRadius: 3, cursor: \"pointer\", fontSize: 13, display: \"flex\", justifyContent: \"space-between\" }}>\r\n                                        <span>{z.name}</span>\r\n                                        {idx === safeIdx && <button onClick={(e) => { e.stopPropagation(); handleDeleteZone(); }} style={{ background: \"transparent\", border: \"none\", color: \"#fff\", cursor: \"pointer\" }}>Ã—</button>}\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n\r\n                        {activeZone && (\r\n                            <div style={{ borderTop: \"1px solid #444\", paddingTop: 15 }}>\r\n                                <h4 style={{ marginTop: 0, color: \"#ddd\", fontSize: 13 }}>Search Objects ({activeZone.name})</h4>\r\n                                <div style={{ display: \"grid\", gridTemplateColumns: \"1fr 1fr\", gap: 8, marginTop: 10 }}>\r\n                                    {(() => {\r\n                                        const currentModName = cam.ai_server?.module || \"ai_small\";\r\n                                        const modulesList = Array.isArray(availableModules) ? availableModules : [];\r\n                                        const currentMod = modulesList.find(m => m.name === currentModName);\r\n                                        const displayClasses = currentMod?.classes?.length > 0 ? currentMod.classes : [\"person\", \"car\", \"truck\"];\r\n                                        return displayClasses.map(obj => (\r\n                                            <label key={obj} style={{ display: \"flex\", alignItems: \"center\", color: \"#ccc\", fontSize: 13, cursor: \"pointer\" }}>\r\n                                                <input type=\"checkbox\" checked={activeZone.objects?.[obj] || false} onChange={() => handleObjectToggle(obj)} style={{ marginRight: 8 }} />\r\n                                                {obj}\r\n                                            </label>\r\n                                        ));\r\n                                    })()}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        <div style={{ borderTop: \"1px solid #444\", marginTop: 15, paddingTop: 15 }}>\r\n                            <h4 style={{ margin: \"0 0 10px 0\", color: \"#ddd\", fontSize: 13 }}>Recording Setup</h4>\r\n                            <label style={{ display: \"flex\", alignItems: \"center\", marginBottom: 10, cursor: \"pointer\", color: \"#ccc\", fontSize: 13 }}>\r\n                                <input type=\"checkbox\" checked={cam.record !== false} onChange={e => {\r\n                                    const updatedCams = cams.map(c => c.id === cam.id ? { ...c, record: e.target.checked } : c);\r\n                                    setCams(updatedCams); silentSave(updatedCams);\r\n                                }} style={{ marginRight: 8 }} />\r\n                                Enable Recording\r\n                            </label>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {activeTab === 'advanced' && <AdvancedAISettings camId={cam.id} />}\r\n        </div>\r\n    );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}